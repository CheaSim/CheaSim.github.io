<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>CheaSim Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="cheasim&#039;s blog"><meta name="msapplication-TileImage" content="/img/1.gif"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="cheasim&#039;s blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description="ACM chicken"><meta property="og:type" content="blog"><meta property="og:title" content="CheaSim Blog"><meta property="og:url" content="https://www.cheasim.com/"><meta property="og:site_name" content="CheaSim Blog"><meta property="og:description" content="ACM chicken"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.cheasim.com/img/og_image.png"><meta property="article:author" content="CheaSim"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.cheasim.com"},"headline":"CheaSim Blog","image":["https://www.cheasim.com/img/og_image.png"],"author":{"@type":"Person","name":"CheaSim"},"description":"ACM chicken"}</script><link rel="icon" href="/img/1.gif"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-R7VVCLV2ZB" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-R7VVCLV2ZB');</script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.2.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/1.gif" alt="CheaSim Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-09-06T14:38:31.000Z" title="2018-09-06T14:38:31.000Z">2018-09-06</time>发表</span><span class="level-item"><time dateTime="2018-09-25T09:54:12.568Z" title="2018-09-25T09:54:12.568Z">2018-09-25</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/acm/">acm</a></span><span class="level-item">36 分钟读完 (大约5447个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/acm/2018/09/06/kuangbin%E5%B8%A6%E4%BD%A0%E9%A3%9E7-%E7%BA%BF%E6%AE%B5%E6%A0%91.html">[kuangbin带你飞7]线段树</a></h1><div class="content"><h1 id="kuangbin带你飞7"><a href="#kuangbin带你飞7" class="headerlink" title="kuangbin带你飞7"></a><a target="_blank" rel="noopener" href="https://cn.vjudge.net/contest/66989">kuangbin带你飞7</a></h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>作为一名acm选手，不能连线段树都不会，练就完事了。而且我越发觉得在赛场上不能卡机，中档题才是区分牌子的题目。只有慢慢思索的题目才能真正地提高自己，立下一个flag，每十天完成一个kuangbin专题。现在时间9/6。必须在9/16完成这个线段树专题，就算是困死也得完成。</p>
<h2 id="感想"><a href="#感想" class="headerlink" title="感想"></a>感想</h2><ol>
<li><p>左右区间还是注意一下，保不准出题人恶趣味。</p>
</li>
<li><p>初始化不能想当然$n$多大树多大，有可能他是一个范围，$n$只是代表着式子的个数罢了。</p>
</li>
<li><p>数组居然还是又一次忘记开4倍。</p>
</li>
<li><p>lazy数组忘记初始化，或者lazy可以为0但是还是初始化为0了。</p>
</li>
</ol>
<h1 id="A-敌兵布阵"><a href="#A-敌兵布阵" class="headerlink" title="A.敌兵布阵"></a>A.敌兵布阵</h1><h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>这如果我没有记错，应该是人生中第一个线段树题目，很是经典。单点修改，区间查询。</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>线段树。</p>
<h2 id="AC代码"><a href="#AC代码" class="headerlink" title="AC代码"></a>AC代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,mid,rt&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson mid+1,r,rt&lt;&lt;1|1</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> T,n;</span><br><span class="line"><span class="keyword">int</span> sum[maxn&lt;&lt;<span class="number">2</span>],lazy[maxn&lt;&lt;<span class="number">2</span>],a[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    sum[rt] = sum[rt&lt;&lt;<span class="number">1</span>] + sum[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(lazy[rt])&#123;</span><br><span class="line">        lazy[rt&lt;&lt;<span class="number">1</span>] += lazy[rt];</span><br><span class="line">        lazy[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += lazy[rt];</span><br><span class="line">        sum[rt&lt;&lt;<span class="number">1</span>] += lazy[rt]*(len/<span class="number">2</span>);</span><br><span class="line">        sum[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += lazy[rt]*(len-len/<span class="number">2</span>);</span><br><span class="line">        lazy[rt] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    lazy[rt] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        sum[rt] = a[l];</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    build(lson);build(rson);</span><br><span class="line">    pushup(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> val,<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=l &amp;&amp; r&lt;=R)&#123;</span><br><span class="line">        lazy[rt] += val;</span><br><span class="line">        sum[rt] += val*(r-l+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    pushdown(rt,r-l+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) update(val,L,R,lson);</span><br><span class="line">    <span class="keyword">if</span>(mid &lt; R) update(val,L,R,rson);</span><br><span class="line">    pushup(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=l &amp;&amp; r&lt;=R) <span class="keyword">return</span> sum[rt];</span><br><span class="line">    pushdown(rt,r-l+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) ans += query(L,R,lson);</span><br><span class="line">    <span class="keyword">if</span>(mid &lt; R) ans += query(L,R,rson);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;a.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line">    rep(test_case,<span class="number">1</span>,T+<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">        rep(i,<span class="number">1</span>,n+<span class="number">1</span>) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,a+i);</span><br><span class="line">        build(<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">char</span> op[<span class="number">20</span>];</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case %d:\n&quot;</span>,test_case);</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,op) &amp;&amp; op[<span class="number">0</span>]!=<span class="string">&#x27;E&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;A&#x27;</span> || op[<span class="number">0</span>] ==<span class="string">&#x27;S&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> l,val;<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;l,&amp;val);</span><br><span class="line">                <span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">&#x27;A&#x27;</span>) update(val,l,l,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">else</span> update(-val,l,l,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">int</span> l,r;<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;l,&amp;r);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,query(l,r,<span class="number">1</span>,n,<span class="number">1</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="B-I-Hate-It"><a href="#B-I-Hate-It" class="headerlink" title="B.I Hate It"></a>B.I Hate It</h1><h2 id="题意-1"><a href="#题意-1" class="headerlink" title="题意"></a>题意</h2><p>单点修改，区间最值。</p>
<h2 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h2><p>线段树。</p>
<h2 id="AC代码-1"><a href="#AC代码-1" class="headerlink" title="AC代码"></a>AC代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,mid,rt&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson mid+1,r,rt&lt;&lt;1|1</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">int</span> mmax[maxn&lt;&lt;<span class="number">2</span>],a[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    mmax[rt] = max(mmax[rt&lt;&lt;<span class="number">1</span>],mmax[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        mmax[rt] = a[l];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    build(lson);build(rson);</span><br><span class="line">    pushup(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> val,<span class="keyword">int</span> p,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r &amp;&amp; l==p)&#123;</span><br><span class="line">        mmax[rt] = val;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(p &lt;= mid) update(val,p,lson);</span><br><span class="line">    <span class="keyword">if</span>(mid &lt; p) update(val,p,rson);</span><br><span class="line">    pushup(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=l &amp;&amp; r&lt;=R) <span class="keyword">return</span> mmax[rt];</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) ans = max(ans,query(L,R,lson));</span><br><span class="line">    <span class="keyword">if</span>(mid &lt; R) ans = max(ans,query(L,R,rson));</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;b.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m))&#123;</span><br><span class="line">        rep(i,<span class="number">1</span>,n+<span class="number">1</span>) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,a+i);</span><br><span class="line">        build(<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">        rep(i,<span class="number">0</span>,m)&#123;</span><br><span class="line">            <span class="keyword">char</span> op[<span class="number">20</span>];<span class="keyword">int</span> x,y;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s%d%d&quot;</span>,op,&amp;x,&amp;y);</span><br><span class="line">            <span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">&#x27;Q&#x27;</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,query(x,y,<span class="number">1</span>,n,<span class="number">1</span>));</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                update(y,x,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="C-A-Simple-Problem-with-Integers"><a href="#C-A-Simple-Problem-with-Integers" class="headerlink" title="C - A Simple Problem with Integers"></a>C - A Simple Problem with Integers</h1><h2 id="题意-2"><a href="#题意-2" class="headerlink" title="题意"></a>题意</h2><p>区间查询，区间修改。</p>
<h2 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h2><p>线段树</p>
<p>lazy需也要开两倍</p>
<h2 id="AC代码-2"><a href="#AC代码-2" class="headerlink" title="AC代码"></a>AC代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,mid,rt&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson mid+1,r,rt&lt;&lt;1|1</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line">ll sum[maxn&lt;&lt;<span class="number">2</span>],a[maxn],lazy[maxn&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> n,q;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    sum[rt] = sum[rt&lt;&lt;<span class="number">1</span>]+sum[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> rt,ll len)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(lazy[rt])&#123;</span><br><span class="line">        lazy[rt&lt;&lt;<span class="number">1</span>] += lazy[rt];</span><br><span class="line">        lazy[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += lazy[rt];</span><br><span class="line">        sum[rt&lt;&lt;<span class="number">1</span>] += lazy[rt]*(len-len/<span class="number">2</span>);</span><br><span class="line">        sum[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += lazy[rt]*(len/<span class="number">2</span>);</span><br><span class="line">        lazy[rt] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        sum[rt] = a[l];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    build(lson);build(rson);</span><br><span class="line">    pushup(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(ll val,<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=l &amp;&amp; r&lt;=R)&#123;</span><br><span class="line">        lazy[rt] += val;</span><br><span class="line">        sum[rt] += val*(r-l+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    pushdown(rt,r-l+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) update(val,L,R,lson);</span><br><span class="line">    <span class="keyword">if</span>(mid &lt; R) update(val,L,R,rson);</span><br><span class="line">    pushup(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=l &amp;&amp; r&lt;=R)&#123;</span><br><span class="line">        <span class="keyword">return</span> sum[rt];</span><br><span class="line">    &#125;</span><br><span class="line">    pushdown(rt,r-l+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) ans += query(L,R,lson);</span><br><span class="line">    <span class="keyword">if</span>(mid &lt; R) ans += query(L,R,rson);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;c.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;q);</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>,a+i);</span><br><span class="line">    build(<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">    rep(i,<span class="number">0</span>,q)&#123;</span><br><span class="line">        <span class="keyword">char</span> op[<span class="number">20</span>];<span class="keyword">int</span> a,b,c;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,op);</span><br><span class="line">        <span class="keyword">if</span>(op[<span class="number">0</span>] == <span class="string">&#x27;C&#x27;</span>)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;a,&amp;b,&amp;c);</span><br><span class="line">            update(c,a,b,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,query(a,b,<span class="number">1</span>,n,<span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="D-Mayor’s-posters"><a href="#D-Mayor’s-posters" class="headerlink" title="D - Mayor’s posters"></a>D - Mayor’s posters</h1><h2 id="题意-3"><a href="#题意-3" class="headerlink" title="题意"></a>题意</h2><p>贴线段，每次贴都会覆盖掉前面的线。问贴到最后能看到多少种不同的线。</p>
<h2 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h2><p>线段树+离散化</p>
<p>覆盖线段的范围是1e8，无法建树所以需要离散化，把线段长度按照排序的顺序重新赋值。由于有$2n$个长度所以记得$maxn$要开两倍。</p>
<p>区间修改，单点查询。</p>
<h2 id="AC代码-3"><a href="#AC代码-3" class="headerlink" title="AC代码"></a>AC代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,mid,rt&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson mid+1,r,rt&lt;&lt;1|1</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e5</span> + <span class="number">20</span>;</span><br><span class="line"><span class="keyword">int</span> vis[maxn],lx[maxn],rx[maxn],lazy[maxn&lt;&lt;<span class="number">2</span>],mmax[maxn&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> T,n;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(lazy[rt])&#123;</span><br><span class="line">        lazy[rt&lt;&lt;<span class="number">1</span>] = lazy[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = lazy[rt];</span><br><span class="line">        mmax[rt&lt;&lt;<span class="number">1</span>] = mmax[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = lazy[rt];</span><br><span class="line">        lazy[rt] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    lazy[rt] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        mmax[rt] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    build(lson); build(rson);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> val,<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=l &amp;&amp; r&lt;=R)&#123;</span><br><span class="line">        lazy[rt] = val;</span><br><span class="line">        mmax[rt] = val;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    pushdown(rt);</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) update(val,L,R,lson);</span><br><span class="line">    <span class="keyword">if</span>(mid &lt; R) update(val,L,R,rson);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r &amp;&amp; l==p)&#123;</span><br><span class="line">        <span class="keyword">return</span> mmax[rt];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    pushdown(rt);</span><br><span class="line">    <span class="keyword">if</span>(p &lt;= mid) <span class="keyword">return</span> query(p,lson);</span><br><span class="line">    <span class="keyword">if</span>(mid &lt; p) <span class="keyword">return</span> query(p,rson);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;d.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;x;</span><br><span class="line">        rep(i,<span class="number">1</span>,n+<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> l,r;<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,lx+i,rx+i);</span><br><span class="line">            x.push_back(lx[i]);x.push_back(rx[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        sort(x.begin(),x.end());</span><br><span class="line">        x.erase(unique(x.begin(),x.end()),x.end());</span><br><span class="line">        rep(i,<span class="number">1</span>,n+<span class="number">1</span>)&#123;</span><br><span class="line">            lx[i] = lower_bound(x.begin(),x.end(),lx[i])-x.begin()+<span class="number">1</span>;</span><br><span class="line">            rx[i] = lower_bound(x.begin(),x.end(),rx[i])-x.begin()+<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> len = x.size();</span><br><span class="line">        build(<span class="number">1</span>,len,<span class="number">1</span>);</span><br><span class="line">        rep(i,<span class="number">1</span>,n+<span class="number">1</span>)&#123;</span><br><span class="line">            update(i,lx[i],rx[i],<span class="number">1</span>,len,<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        rep(i,<span class="number">1</span>,len+<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> x = query(i,<span class="number">1</span>,len,<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span>(vis[x] == <span class="number">0</span>)&#123;</span><br><span class="line">                ans ++;</span><br><span class="line">                vis[x] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="E-Just-a-Hook"><a href="#E-Just-a-Hook" class="headerlink" title="E - Just a Hook"></a>E - Just a Hook</h1><h2 id="题意-4"><a href="#题意-4" class="headerlink" title="题意"></a>题意</h2><p>区间修改，区间查询</p>
<h2 id="题解-4"><a href="#题解-4" class="headerlink" title="题解"></a>题解</h2><p>线段树</p>
<h2 id="ac代码"><a href="#ac代码" class="headerlink" title="ac代码"></a>ac代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,mid,rt&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson mid+1,r,rt&lt;&lt;1|1</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> sum[maxn&lt;&lt;<span class="number">2</span>],a[maxn],lazy[maxn&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> n,q,T;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    sum[rt] = sum[rt&lt;&lt;<span class="number">1</span>]+sum[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(lazy[rt])&#123;</span><br><span class="line">        lazy[rt&lt;&lt;<span class="number">1</span>] = lazy[rt];</span><br><span class="line">        lazy[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = lazy[rt];</span><br><span class="line">        sum[rt&lt;&lt;<span class="number">1</span>] = lazy[rt]*(len-len/<span class="number">2</span>);</span><br><span class="line">        sum[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = lazy[rt]*(len/<span class="number">2</span>);</span><br><span class="line">        lazy[rt] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    lazy[rt] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        sum[rt] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    build(lson);build(rson);</span><br><span class="line">    pushup(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> val,<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=l &amp;&amp; r&lt;=R)&#123;</span><br><span class="line">        lazy[rt] = val;</span><br><span class="line">        sum[rt] = val*(r-l+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    pushdown(rt,r-l+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) update(val,L,R,lson);</span><br><span class="line">    <span class="keyword">if</span>(mid &lt; R) update(val,L,R,rson);</span><br><span class="line">    pushup(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=l &amp;&amp; r&lt;=R)&#123;</span><br><span class="line">        <span class="keyword">return</span> sum[rt];</span><br><span class="line">    &#125;</span><br><span class="line">    pushdown(rt,r-l+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(L &lt;= mid) ans += query(L,R,lson);</span><br><span class="line">    <span class="keyword">if</span>(mid &lt; R) ans += query(L,R,rson);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;e.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line">    rep(test_case,<span class="number">1</span>,T+<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;q);</span><br><span class="line">        build(<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">        rep(i,<span class="number">0</span>,q)&#123;</span><br><span class="line">            <span class="keyword">int</span> l,r,val; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;l,&amp;r,&amp;val);</span><br><span class="line">            update(val,l,r,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case %d: The total value of the hook is %d.\n&quot;</span>,test_case,query(<span class="number">1</span>,n,<span class="number">1</span>,n,<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="F-Count-the-Colors"><a href="#F-Count-the-Colors" class="headerlink" title="F.Count the Colors"></a>F.Count the Colors</h1><h2 id="题意-5"><a href="#题意-5" class="headerlink" title="题意"></a>题意</h2><p>在一条线上区间涂颜色。</p>
<p>问所有颜色出现的区间块的数量。</p>
<h2 id="题解-5"><a href="#题解-5" class="headerlink" title="题解"></a>题解</h2><p>线段树+懒惰标记</p>
<p>需要注意的是，$n$不代表着数据的范围，8000才是数据的范围，并且由于区块间有空隙，所以离散化还有点不好做。虽然数据也只有8000。注意的是初始化的范围要覆盖到8000，不能以为到$n$就好了。</p>
<hr>
<p>+5 $n$当坐范围</p>
<p>+3 误以为build函数能够初始化所有的点，但其实是要memset(vis,-1,sizeof(vis));</p>
<h3 id="AC代码-4"><a href="#AC代码-4" class="headerlink" title="AC代码"></a>AC代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,mid,rt&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson mid+1,r,rt&lt;&lt;1|1</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head -------------------------</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">8e3</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> a[maxn&lt;&lt;<span class="number">2</span>],lazy[maxn&lt;&lt;<span class="number">2</span>],ans[maxn&lt;&lt;<span class="number">2</span>],id[maxn&lt;&lt;<span class="number">2</span>],vis[maxn&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(lazy[rt]!=<span class="number">-1</span>)&#123;</span><br><span class="line">        lazy[rt&lt;&lt;<span class="number">1</span>] = lazy[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = lazy[rt];</span><br><span class="line">        a[rt&lt;&lt;<span class="number">1</span>] = a[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = lazy[rt];</span><br><span class="line">        lazy[rt] = <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    lazy[rt] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        a[rt] = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    build(lson);build(rson);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> val,<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=l &amp;&amp; r&lt;=R)&#123;</span><br><span class="line">        a[rt] = val;</span><br><span class="line">        lazy[rt] = val;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    pushdown(rt);</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=mid) update(val,L,R,lson);</span><br><span class="line">    <span class="keyword">if</span>(mid&lt;R) update(val,L,R,rson);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        vis[l] = a[rt];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    pushdown(rt);</span><br><span class="line">    query(lson);</span><br><span class="line">    query(rson);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;1.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n)!=EOF)&#123;</span><br><span class="line">        build(<span class="number">1</span>,<span class="number">8000</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">memset</span>(ans,<span class="number">0</span>,<span class="keyword">sizeof</span>(ans));</span><br><span class="line">        <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</span><br><span class="line">        <span class="built_in">memset</span>(id,<span class="number">0</span>,<span class="keyword">sizeof</span>(id));</span><br><span class="line">        rep(i,<span class="number">1</span>,n+<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> l,r,x;<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;l,&amp;r,&amp;x);</span><br><span class="line">            <span class="keyword">if</span>(l&gt;=r) <span class="keyword">continue</span>;</span><br><span class="line">            update(x,l+<span class="number">1</span>,r,<span class="number">1</span>,<span class="number">8000</span>,<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        query(<span class="number">1</span>,<span class="number">8000</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> last = <span class="number">-1</span>;</span><br><span class="line">        <span class="comment">//int i = 1;</span></span><br><span class="line">        rep(i,<span class="number">1</span>,maxn)&#123;</span><br><span class="line">            <span class="keyword">while</span>(vis[i]==<span class="number">-1</span>) i++,last=<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i&gt;=maxn) <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">if</span>(vis[i] != last)&#123;</span><br><span class="line">                last = vis[i];</span><br><span class="line">                ans[vis[i]]++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i,<span class="number">0</span>,<span class="number">8000</span>+<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(ans[i]==<span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>,i,ans[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="G-Balanced-Lineup"><a href="#G-Balanced-Lineup" class="headerlink" title="G.Balanced Lineup"></a>G.Balanced Lineup</h1><h2 id="题意-6"><a href="#题意-6" class="headerlink" title="题意"></a>题意</h2><p>求区间最大值和最小值的差</p>
<h2 id="题解-6"><a href="#题解-6" class="headerlink" title="题解"></a>题解</h2><p>可以用ST表预处理，也可以用树状数组或者是线段树，线段树的常数比较大，但他们的复杂度均是$O(nlogn)$</p>
<h2 id="AC代码-5"><a href="#AC代码-5" class="headerlink" title="AC代码"></a>AC代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e4</span>+<span class="number">20</span>;</span><br><span class="line"><span class="keyword">int</span> mmax[maxn],mmin[maxn];</span><br><span class="line"><span class="keyword">int</span> a[maxn];</span><br><span class="line"><span class="keyword">int</span> n,q;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&amp;-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=x;i&lt;=n;i+=lowbit(i))&#123;</span><br><span class="line">        mmax[i] = a[i];</span><br><span class="line">        mmin[i] = a[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;lowbit(i);j&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">            mmax[i] = max(mmax[i],mmax[i-j]);</span><br><span class="line">            mmin[i] = min(mmin[i],mmin[i-j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query_min</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = INF;</span><br><span class="line">    <span class="keyword">while</span>(r&gt;=l)&#123;</span><br><span class="line">        res = min(a[r],res);</span><br><span class="line">        r--;</span><br><span class="line">        <span class="keyword">for</span>(;r-lowbit(r)&gt;=l;r-=lowbit(r))</span><br><span class="line">            res = min(mmin[r],res);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query_max</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = -INF;</span><br><span class="line">    <span class="keyword">while</span>(r&gt;=l)&#123;</span><br><span class="line">        res = max(a[r],res);</span><br><span class="line">        r--;</span><br><span class="line">        <span class="keyword">for</span>(;r-lowbit(r)&gt;=l;r-=lowbit(r))</span><br><span class="line">            res = max(mmax[r],res);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> query_max(l,r)-query_min(l,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;2.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;q);</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>) mmin[i]=INF,mmax[i]=-INF;</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,a+i);</span><br><span class="line">        update(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(q--)&#123;</span><br><span class="line">        <span class="keyword">int</span> l,r;<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;l,&amp;r);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,solve(l,r));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="H-Can-you-answer-the-queries"><a href="#H-Can-you-answer-the-queries" class="headerlink" title="H.Can you answer the queries?"></a>H.Can you answer the queries?</h1><h2 id="题意-7"><a href="#题意-7" class="headerlink" title="题意"></a>题意</h2><p>区间数字根号，区间查询数字和。</p>
<h2 id="题解-7"><a href="#题解-7" class="headerlink" title="题解"></a>题解</h2><p>线段树＋智力门槛</p>
<p>因为所有数字最多根号8次就会变成1。所以我们只需要处理一下当数字为1就不用再更新区间内的数了。</p>
<hr>
<p>acm还是靠智力和眼力啊，我想了半天都没想出来什么数学方法，原来只需要看出规律和找到最关键的突破点就ok了。</p>
<p>+1超时忘记开4倍数组了。。</p>
<p>+1 虚伪的看到了提醒要注意l,r的大小关系，妈的，这都卡，是不是人啊。</p>
<h2 id="AC代码-6"><a href="#AC代码-6" class="headerlink" title="AC代码"></a>AC代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,mid,rt&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson mid+1,r,rt&lt;&lt;1|1</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n,q;</span><br><span class="line">ll sum[maxn&lt;&lt;<span class="number">2</span>],mmax[maxn&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    sum[rt] = sum[rt&lt;&lt;<span class="number">1</span>] + sum[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">    mmax[rt] = max(mmax[rt&lt;&lt;<span class="number">1</span>],mmax[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        ll x;<span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>,&amp;x);</span><br><span class="line">        mmax[rt] = sum[rt] = x;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    build(lson);build(rson);</span><br><span class="line">    pushup(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(mmax[rt]==<span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        mmax[rt] = <span class="built_in">sqrt</span>(mmax[rt]);</span><br><span class="line">        sum[rt] = <span class="built_in">sqrt</span>(sum[rt]);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=mid) update(L,R,lson);</span><br><span class="line">    <span class="keyword">if</span>(mid&lt;R) update(L,R,rson);</span><br><span class="line">    pushup(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=l &amp;&amp; r&lt;=R) <span class="keyword">return</span> sum[rt];</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=mid)  ans += query(L,R,lson);</span><br><span class="line">    <span class="keyword">if</span>(mid&lt;R) ans += query(L,R,rson);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;1.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">int</span> test_case = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n))&#123;</span><br><span class="line">        build(<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;q);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d:\n&quot;</span>,test_case++);</span><br><span class="line">        <span class="keyword">while</span>(q--)&#123;</span><br><span class="line">            <span class="keyword">int</span> l,r,op;<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;op,&amp;l,&amp;r);</span><br><span class="line">            <span class="keyword">if</span>(l&gt;r)&#123;</span><br><span class="line">                <span class="keyword">int</span> temp = l;</span><br><span class="line">                l = r;</span><br><span class="line">                r = temp;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(op==<span class="number">0</span>)&#123;</span><br><span class="line">                update(l,r,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,query(l,r,<span class="number">1</span>,n,<span class="number">1</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="I-Tunnel-Warfare-前面写过了"><a href="#I-Tunnel-Warfare-前面写过了" class="headerlink" title="I Tunnel Warfare(前面写过了)"></a>I Tunnel Warfare(前面写过了)</h1><h2 id="题意-8"><a href="#题意-8" class="headerlink" title="题意"></a>题意</h2><h2 id="题解-8"><a href="#题解-8" class="headerlink" title="题解"></a>题解</h2><h2 id="ac代码-1"><a href="#ac代码-1" class="headerlink" title="ac代码"></a>ac代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e4</span>+<span class="number">20</span>;</span><br><span class="line"><span class="keyword">int</span> bit[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&amp;-x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = x;i;i-=lowbit(i))&#123;</span><br><span class="line">        ans += bit[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> query(r)-query(l<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> val)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=x;i&lt;=n;i+=lowbit(i))&#123;</span><br><span class="line">        bit[i] += val;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve_left</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;<span class="keyword">int</span> ans = r;</span><br><span class="line">    <span class="keyword">while</span>(l&lt;=r)&#123;</span><br><span class="line">        mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(query(mid,r)==r-mid+<span class="number">1</span>) r = mid<span class="number">-1</span>,ans = mid;</span><br><span class="line">        <span class="keyword">else</span> l = mid+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve_right</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mid,ans = l;</span><br><span class="line">    <span class="keyword">while</span>(l&lt;=r)&#123;</span><br><span class="line">        mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(query(l,mid)==mid-l+<span class="number">1</span>) l=mid+<span class="number">1</span>,ans = mid;</span><br><span class="line">        <span class="keyword">else</span> r = mid<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> vis[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;2.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m)!=EOF)&#123;</span><br><span class="line">        <span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; st;</span><br><span class="line">        <span class="built_in">memset</span>(bit,<span class="number">0</span>,<span class="keyword">sizeof</span>(bit));</span><br><span class="line">        <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</span><br><span class="line">        rep(i,<span class="number">1</span>,n+<span class="number">1</span>) add(i,<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">            <span class="keyword">char</span> op[<span class="number">20</span>];<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,op);</span><br><span class="line">            <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;D&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> x;<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">                st.push(x);</span><br><span class="line">                <span class="keyword">if</span>(vis[x]) <span class="keyword">continue</span>;</span><br><span class="line">                vis[x] = <span class="number">1</span>;</span><br><span class="line">                add(x,<span class="number">-1</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;Q&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> x;<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">                <span class="keyword">if</span>(query(x,x)==<span class="number">0</span>) <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">                <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,solve_right(x,n)-solve_left(<span class="number">1</span>,x)+<span class="number">1</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                add(st.top(),<span class="number">1</span>);</span><br><span class="line">                vis[st.top()] = <span class="number">0</span>;</span><br><span class="line">                st.pop();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="J-Assign-the-task"><a href="#J-Assign-the-task" class="headerlink" title="J.Assign the task"></a>J.Assign the task</h1><h2 id="题意-9"><a href="#题意-9" class="headerlink" title="题意"></a>题意</h2><p>dfs序+线段树模板题</p>
<h2 id="题解-9"><a href="#题解-9" class="headerlink" title="题解"></a>题解</h2><p>同上</p>
<hr>
<p>+1 lazy数组没有初始化，没适应无build建树</p>
<h2 id="AC代码-7"><a href="#AC代码-7" class="headerlink" title="AC代码"></a>AC代码</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">#define rep(i,a,n) for(int i&#x3D;(a);i&lt;(n);i++)</span><br><span class="line">#define per(i,a,n) for(int i&#x3D;(n-1);i&gt;&#x3D;(a);i--)</span><br><span class="line">#define fi first</span><br><span class="line">#define se second</span><br><span class="line">#define lson l,mid,rt&lt;&lt;1</span><br><span class="line">#define rson mid+1,r,rt&lt;&lt;1|1</span><br><span class="line">typedef pair &lt;int,int&gt; pII;</span><br><span class="line">typedef long long ll;</span><br><span class="line">const int INF &#x3D; 0x3f3f3f3f;</span><br><span class="line">&#x2F;&#x2F;head</span><br><span class="line">const int maxn &#x3D; 5e4+10;</span><br><span class="line">int T,n,clk;</span><br><span class="line">int on[maxn],in[maxn],ind[maxn],a[maxn&lt;&lt;2],lazy[maxn&lt;&lt;2];</span><br><span class="line">vector&lt;int&gt; G[maxn];</span><br><span class="line">void init()&#123;</span><br><span class="line">    clk &#x3D; 0;</span><br><span class="line">    memset(on,0,sizeof(on));</span><br><span class="line">    memset(in,0,sizeof(in));</span><br><span class="line">    memset(ind,0,sizeof(ind));</span><br><span class="line">    memset(a,-1,sizeof(a));</span><br><span class="line">    memset(lazy,-1,sizeof(lazy));</span><br><span class="line">    rep(i,0,n+1) G[i].clear();</span><br><span class="line">&#125;</span><br><span class="line">void dfs(int u,int fa)&#123;</span><br><span class="line">    for(auto v:G[u])&#123;</span><br><span class="line">        if(v&#x3D;&#x3D;fa) continue;</span><br><span class="line">        in[v] &#x3D; ++clk;</span><br><span class="line">        dfs(v,u);</span><br><span class="line">    &#125;</span><br><span class="line">    on[u] &#x3D; clk;</span><br><span class="line">&#125;</span><br><span class="line">void pushdown(int rt)&#123;</span><br><span class="line">    if(lazy[rt]!&#x3D;-1)&#123;</span><br><span class="line">        lazy[rt&lt;&lt;1] &#x3D; lazy[rt&lt;&lt;1|1] &#x3D; lazy[rt];</span><br><span class="line">        a[rt&lt;&lt;1] &#x3D; a[rt&lt;&lt;1|1] &#x3D; lazy[rt];</span><br><span class="line">        lazy[rt] &#x3D; -1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">void update(int val,int L,int R,int l,int r,int rt)&#123;</span><br><span class="line">    if(L&lt;&#x3D;l &amp;&amp; r&lt;&#x3D;R)&#123;</span><br><span class="line">        lazy[rt] &#x3D; val;</span><br><span class="line">        a[rt] &#x3D; val;</span><br><span class="line">        return ;</span><br><span class="line">    &#125;</span><br><span class="line">    pushdown(rt);</span><br><span class="line">    int mid &#x3D; l+r&gt;&gt;1;</span><br><span class="line">    if(L&lt;&#x3D;mid) update(val,L,R,lson);</span><br><span class="line">    if(mid&lt;R) update(val,L,R,rson);</span><br><span class="line">&#125;</span><br><span class="line">int query(int p,int l,int r,int rt)&#123;</span><br><span class="line">    if(l&#x3D;&#x3D;r &amp;&amp; p&#x3D;&#x3D;l) return a[rt];</span><br><span class="line">    int mid &#x3D; l+r&gt;&gt;1;</span><br><span class="line">    pushdown(rt);</span><br><span class="line">    if(p&lt;&#x3D;mid) return query(p,lson);</span><br><span class="line">    else return query(p,rson);</span><br><span class="line">&#125;</span><br><span class="line">int main()&#123;</span><br><span class="line">#ifdef LOCAL</span><br><span class="line">    freopen(&quot;3.in&quot;,&quot;r&quot;,stdin);</span><br><span class="line">#endif</span><br><span class="line">    scanf(&quot;%d&quot;,&amp;T);</span><br><span class="line">    rep(test_case,1,T+1)&#123;</span><br><span class="line">        scanf(&quot;%d&quot;,&amp;n);</span><br><span class="line">        init();</span><br><span class="line">        rep(i,0,n-1)&#123;</span><br><span class="line">            int u,v;scanf(&quot;%d%d&quot;,&amp;u,&amp;v);</span><br><span class="line">            G[v].push_back(u);</span><br><span class="line">            ind[u]++;</span><br><span class="line">        &#125;</span><br><span class="line">        int root &#x3D; 0;</span><br><span class="line">        rep(i,1,n+1) if(ind[i]&#x3D;&#x3D;0)&#123;</span><br><span class="line">            root &#x3D; i;</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">        in[root] &#x3D; ++clk;</span><br><span class="line">        dfs(root,-1);</span><br><span class="line">        int q;scanf(&quot;%d&quot;,&amp;q);</span><br><span class="line">        printf(&quot;Case #%d:\n&quot;,test_case);</span><br><span class="line">        while(q--)&#123;</span><br><span class="line">            char op[20];int x,y;</span><br><span class="line">            scanf(&quot;%s&quot;,op);</span><br><span class="line">            if(op[0]&#x3D;&#x3D;&#39;C&#39;)&#123;</span><br><span class="line">                scanf(&quot;%d&quot;,&amp;x);</span><br><span class="line">                printf(&quot;%d\n&quot;,query(in[x],1,n,1));</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                scanf(&quot;%d%d&quot;,&amp;x,&amp;y);</span><br><span class="line">                update(y,in[x],on[x],1,n,1);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="K-Transformation"><a href="#K-Transformation" class="headerlink" title="K.Transformation"></a>K.Transformation</h1><h2 id="题意-10"><a href="#题意-10" class="headerlink" title="题意"></a>题意</h2><p>有四种操作。</p>
<ol>
<li>将$[l,r]$区间的数字加上$val$.</li>
<li>将$[l,r]$区间的数字乘上$val$</li>
<li>将$[l,r]$区间的数字变成$val$</li>
<li>求区间$[l,r]$内所有数字$[1,2,3]$次方的和。</li>
</ol>
<h2 id="题解-10"><a href="#题解-10" class="headerlink" title="题解"></a>题解</h2><p>线段树</p>
<p>对于线段树的懒惰标记和取模运算细节要求很高。</p>
<p>相信对于sum数组的转化大家都能够推得出来，但是关于pushdown的操作是另有玄机。</p>
<p>首先他的顺序很重要。得先将lazy[1]递推下去，也就是操作3把数字变成$val$，之后再进行乘法和加法的操作。对于乘法很重要的一点是你在lazy[2]标记递推的时候，其实你把子树中的加法也相当于乘了$val$，所以递推不仅要递推乘法标记，还要递推加法标记。</p>
<hr>
<p>+3 更新Pushdown中你也要更新lazy数组的值</p>
<p>+1 更新的次序也有关系</p>
<p>+1初始化 有的要1.</p>
<p>+1 少写一个|1  rt[rt&lt;&lt;1|1]写成了rt&lt;&lt;1</p>
<p>+10000 有一个r-l+1写错了，下次写成 len 。不然很容易出错妈了个鸡</p>
<h2 id="AC代码-8"><a href="#AC代码-8" class="headerlink" title="AC代码"></a>AC代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,mid,rt&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson mid+1,r,rt&lt;&lt;1|1</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;  </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">read</span> <span class="params">(T &amp;ret)</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">char</span> c;  </span><br><span class="line">    <span class="keyword">int</span> sgn;  </span><br><span class="line">    <span class="keyword">if</span> (c = getchar(), c == EOF) <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">//EOF  </span></span><br><span class="line">    <span class="keyword">while</span> (c != <span class="string">&#x27;-&#x27;</span> &amp;&amp; (c &lt; <span class="string">&#x27;0&#x27;</span> || c &gt; <span class="string">&#x27;9&#x27;</span>) ) &#123;</span><br><span class="line">        <span class="keyword">if</span>((c = getchar()) == EOF) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sgn = (c == <span class="string">&#x27;-&#x27;</span>) ? <span class="number">-1</span> : <span class="number">1</span>;  </span><br><span class="line">    ret = (c == <span class="string">&#x27;-&#x27;</span>) ? <span class="number">0</span> : (c - <span class="string">&#x27;0&#x27;</span>);  </span><br><span class="line">    <span class="keyword">while</span> (c = getchar(), c &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) ret = ret * <span class="number">10</span> + (c - <span class="string">&#x27;0&#x27;</span>);  </span><br><span class="line">    ret *= sgn;  </span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">const</span> ll maxn = <span class="number">1e5</span> + <span class="number">20</span>;</span><br><span class="line"><span class="keyword">const</span> ll mod = <span class="number">1e4</span> + <span class="number">7</span>;</span><br><span class="line">ll pp[mod+<span class="number">20</span>][<span class="number">4</span>],sum[<span class="number">4</span>][maxn&lt;&lt;<span class="number">2</span>];</span><br><span class="line">ll lazy[maxn&lt;&lt;<span class="number">2</span>][<span class="number">4</span>];</span><br><span class="line"><span class="keyword">int</span> n,m,x,y,val;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(sum,<span class="number">0</span>,<span class="keyword">sizeof</span>(sum));</span><br><span class="line">    <span class="built_in">memset</span>(lazy,<span class="number">0</span>,<span class="keyword">sizeof</span>(lazy));</span><br><span class="line">    rep(i,<span class="number">0</span>,maxn)&#123;</span><br><span class="line">        lazy[i][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    rep(i,<span class="number">1</span>,<span class="number">4</span>)&#123;</span><br><span class="line">        sum[i][rt] = (sum[i][rt&lt;&lt;<span class="number">1</span>] + sum[i][rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>])%mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> rt,ll len)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(lazy[rt][<span class="number">3</span>])&#123;</span><br><span class="line">        ll c = lazy[rt][<span class="number">3</span>]%mod;</span><br><span class="line">        lazy[rt&lt;&lt;<span class="number">1</span>][<span class="number">1</span>] = lazy[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        lazy[rt&lt;&lt;<span class="number">1</span>][<span class="number">2</span>] = lazy[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">        lazy[rt&lt;&lt;<span class="number">1</span>][<span class="number">3</span>] = lazy[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>][<span class="number">3</span>] = c;</span><br><span class="line">        sum[<span class="number">1</span>][rt&lt;&lt;<span class="number">1</span>] = c*(len-len/<span class="number">2</span>);</span><br><span class="line">        sum[<span class="number">1</span>][rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = c*(len/<span class="number">2</span>);</span><br><span class="line">        sum[<span class="number">2</span>][rt&lt;&lt;<span class="number">1</span>] = pp[c][<span class="number">2</span>]*(len-len/<span class="number">2</span>)%mod;</span><br><span class="line">        sum[<span class="number">2</span>][rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = pp[c][<span class="number">2</span>]*(len/<span class="number">2</span>)%mod;</span><br><span class="line">        sum[<span class="number">3</span>][rt&lt;&lt;<span class="number">1</span>] = pp[c][<span class="number">3</span>]*(len-len/<span class="number">2</span>)%mod;</span><br><span class="line">        sum[<span class="number">3</span>][rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = pp[c][<span class="number">3</span>]*(len/<span class="number">2</span>)%mod;</span><br><span class="line">        lazy[rt][<span class="number">3</span>] = <span class="number">0</span>;</span><br><span class="line">        rep(i,<span class="number">1</span>,<span class="number">4</span>)&#123;</span><br><span class="line">            sum[i][rt&lt;&lt;<span class="number">1</span>] %= mod;</span><br><span class="line">            sum[i][rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] %= mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(lazy[rt][<span class="number">2</span>]!=<span class="number">1</span>)&#123;</span><br><span class="line">        ll c = lazy[rt][<span class="number">2</span>]%mod;</span><br><span class="line">        rep(i,<span class="number">1</span>,<span class="number">4</span>)&#123;</span><br><span class="line">            sum[i][rt&lt;&lt;<span class="number">1</span>] *= pp[c][i];</span><br><span class="line">            sum[i][rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] *= pp[c][i];</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i,<span class="number">1</span>,<span class="number">3</span>)&#123;</span><br><span class="line">            lazy[rt&lt;&lt;<span class="number">1</span>][i] = (lazy[rt&lt;&lt;<span class="number">1</span>][i]%mod)*c%mod;</span><br><span class="line">            lazy[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>][i] = (lazy[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>][i]%mod)*c%mod;</span><br><span class="line">        &#125;</span><br><span class="line">        lazy[rt][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">        rep(i,<span class="number">1</span>,<span class="number">4</span>)&#123;</span><br><span class="line">            sum[i][rt&lt;&lt;<span class="number">1</span>] %= mod;</span><br><span class="line">            sum[i][rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] %= mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(lazy[rt][<span class="number">1</span>])&#123;</span><br><span class="line">        ll c = lazy[rt][<span class="number">1</span>]%mod;</span><br><span class="line">        lazy[rt&lt;&lt;<span class="number">1</span>][<span class="number">1</span>] += c;</span><br><span class="line">        lazy[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>][<span class="number">1</span>] += c;</span><br><span class="line">        lazy[rt&lt;&lt;<span class="number">1</span>][<span class="number">1</span>] %= mod;</span><br><span class="line">        lazy[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>][<span class="number">1</span>] %= mod;</span><br><span class="line">        sum[<span class="number">3</span>][rt&lt;&lt;<span class="number">1</span>] += <span class="number">1l</span>l*<span class="number">3</span>*sum[<span class="number">2</span>][rt&lt;&lt;<span class="number">1</span>]%mod*c%mod + c*c%mod*c%mod*(len-len/<span class="number">2</span>)%mod + <span class="number">3</span>*sum[<span class="number">1</span>][rt&lt;&lt;<span class="number">1</span>]%mod*c%mod*c%mod;</span><br><span class="line">        sum[<span class="number">3</span>][rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += <span class="number">1l</span>l*<span class="number">3</span>*sum[<span class="number">2</span>][rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]%mod*c%mod + <span class="number">3</span>*sum[<span class="number">1</span>][rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]*c%mod*c%mod + c*c%mod*c%mod*(len/<span class="number">2</span>)%mod;</span><br><span class="line">        sum[<span class="number">2</span>][rt&lt;&lt;<span class="number">1</span>] += <span class="number">1l</span>l*<span class="number">2</span>*sum[<span class="number">1</span>][rt&lt;&lt;<span class="number">1</span>]%mod*c%mod + c*c%mod*(len-len/<span class="number">2</span>)%mod;</span><br><span class="line">        sum[<span class="number">2</span>][rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += <span class="number">1l</span>l*<span class="number">2</span>*sum[<span class="number">1</span>][rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]%mod*c%mod + c*c%mod*(len/<span class="number">2</span>)%mod;</span><br><span class="line">        sum[<span class="number">1</span>][rt&lt;&lt;<span class="number">1</span>] += c*(len-len/<span class="number">2</span>);</span><br><span class="line">        sum[<span class="number">1</span>][rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += c*(len/<span class="number">2</span>);</span><br><span class="line">        lazy[rt][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i,<span class="number">1</span>,<span class="number">4</span>)&#123;</span><br><span class="line">        sum[i][rt&lt;&lt;<span class="number">1</span>] %= mod;</span><br><span class="line">        sum[i][rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] %= mod;</span><br><span class="line">        lazy[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>][i] %= mod;</span><br><span class="line">        lazy[rt&lt;&lt;<span class="number">1</span>][i] %= mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> op,ll c,ll L,ll R,ll l,ll r,ll rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=l &amp;&amp; r&lt;=R)&#123;</span><br><span class="line">        <span class="keyword">if</span>(op==<span class="number">1</span>)&#123;</span><br><span class="line">            sum[<span class="number">3</span>][rt] += <span class="number">1l</span>l*<span class="number">3</span>*sum[<span class="number">2</span>][rt]*c%mod+<span class="number">1l</span>l*<span class="number">3</span>*sum[<span class="number">1</span>][rt]*c%mod*c%mod+c*c%mod*c%mod*(r-l+<span class="number">1</span>)%mod;</span><br><span class="line">            sum[<span class="number">2</span>][rt] += sum[<span class="number">1</span>][rt]%mod*c%mod*<span class="number">2</span>%mod+c*c%mod*(r-l+<span class="number">1</span>)%mod;</span><br><span class="line">            sum[<span class="number">1</span>][rt] += <span class="number">1l</span>l*(r-l+<span class="number">1</span>)*c%mod;</span><br><span class="line">            lazy[rt][<span class="number">1</span>] += c;</span><br><span class="line">            lazy[rt][<span class="number">1</span>] %= mod;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">2</span>)&#123;</span><br><span class="line">            rep(i,<span class="number">1</span>,<span class="number">4</span>) sum[i][rt] *= pp[c][i];</span><br><span class="line">            lazy[rt][<span class="number">2</span>] *= c;</span><br><span class="line">            lazy[rt][<span class="number">2</span>] %= mod;</span><br><span class="line">            lazy[rt][<span class="number">1</span>] *= c;</span><br><span class="line">            lazy[rt][<span class="number">1</span>] %= mod;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            rep(i,<span class="number">1</span>,<span class="number">4</span>) sum[i][rt] = pp[c][i]*(r-l+<span class="number">1</span>)%mod;</span><br><span class="line">            lazy[rt][<span class="number">3</span>] = c;</span><br><span class="line">            lazy[rt][<span class="number">1</span>] = <span class="number">0</span>;lazy[rt][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i,<span class="number">1</span>,<span class="number">4</span>)  sum[i][rt] %= mod;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    pushdown(rt,r-l+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=mid) update(op,c,L,R,lson);</span><br><span class="line">    <span class="keyword">if</span>(mid&lt;R) update(op,c,L,R,rson);</span><br><span class="line">    pushup(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> op,<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=l &amp;&amp; r&lt;=R)&#123;</span><br><span class="line">        <span class="keyword">return</span> sum[op][rt];</span><br><span class="line">    &#125;</span><br><span class="line">    pushdown(rt,r-l+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=mid) (ans += query(op,L,R,lson)%mod)%=mod;</span><br><span class="line">    <span class="keyword">if</span>(mid&lt;R) (ans += query(op,L,R,rson)%mod)%mod;</span><br><span class="line">    pushup(rt);</span><br><span class="line">    <span class="keyword">return</span> ans%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;2.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line">    <span class="comment">//freopen(&quot;2.out&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    rep(i,<span class="number">1</span>,mod+<span class="number">1</span>) pp[i][<span class="number">1</span>] = i%mod;</span><br><span class="line">    rep(i,<span class="number">1</span>,mod+<span class="number">1</span>)&#123;</span><br><span class="line">        rep(j,<span class="number">2</span>,<span class="number">4</span>)&#123;</span><br><span class="line">            pp[i][j] = (ll)pp[i][j<span class="number">-1</span>]*i%mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m))&#123;</span><br><span class="line">        init();</span><br><span class="line">        rep(i,<span class="number">0</span>,m)&#123;</span><br><span class="line">            <span class="keyword">int</span> op;read(op); read(x);read(y);read(val);</span><br><span class="line">            <span class="keyword">if</span>(op==<span class="number">4</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,query(val,x,y,<span class="number">1</span>,n,<span class="number">1</span>));</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                update(op,val,x,y,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    fclose(<span class="built_in">stdin</span>);</span><br><span class="line">    fclose(<span class="built_in">stdout</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="L-Vases-and-Flowers"><a href="#L-Vases-and-Flowers" class="headerlink" title="L - Vases and Flowers"></a>L - Vases and Flowers</h1><h2 id="题意-11"><a href="#题意-11" class="headerlink" title="题意"></a>题意</h2><p>做过 在我之前博客里面有。</p>
<h2 id="题解-11"><a href="#题解-11" class="headerlink" title="题解"></a>题解</h2><p>做过</p>
<hr>
<p>+2 忘记掉可能初始不能放在A点，所以要加入一个全局变量flag，初始化maxl。</p>
<h2 id="AC代码-9"><a href="#AC代码-9" class="headerlink" title="AC代码"></a>AC代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,mid,rt&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson mid+1,r,rt&lt;&lt;1|1</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">int</span> n,now,maxl,maxr,flag;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e4</span>+<span class="number">20</span>;</span><br><span class="line"><span class="keyword">int</span> sum[maxn&lt;&lt;<span class="number">2</span>],lazy[maxn&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    sum[rt] = sum[rt&lt;&lt;<span class="number">1</span>] + sum[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(lazy[rt] != <span class="number">-1</span>)&#123;</span><br><span class="line">        lazy[rt&lt;&lt;<span class="number">1</span>] = lazy[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = lazy[rt];</span><br><span class="line">        sum[rt&lt;&lt;<span class="number">1</span>] = lazy[rt]*(len-len/<span class="number">2</span>);</span><br><span class="line">        sum[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = lazy[rt]*(len/<span class="number">2</span>);</span><br><span class="line">        lazy[rt] = <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    lazy[rt] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        sum[rt] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    build(lson); build(rson);</span><br><span class="line">    pushup(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update1</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(now == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> len = r-l+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(sum[rt] == len) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;=p &amp;&amp; sum[rt] == <span class="number">0</span> &amp;&amp; len &lt;= now)&#123;</span><br><span class="line">        now -= len;</span><br><span class="line">        sum[rt] = len;</span><br><span class="line">        lazy[rt] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(flag == <span class="number">0</span>)</span><br><span class="line">        maxl = l,flag = <span class="number">1</span>; </span><br><span class="line">        maxr = max(maxr,r);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    pushdown(rt,len);</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(p&lt;=mid) update1(p,lson);</span><br><span class="line">    update1(p,rson);</span><br><span class="line">    pushup(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=l &amp;&amp; r&lt;=R)&#123;</span><br><span class="line">        lazy[rt] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> temp = sum[rt];</span><br><span class="line">        sum[rt] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> temp;</span><br><span class="line">    &#125;</span><br><span class="line">    pushdown(rt,r-l+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=mid) ans += query(L,R,lson);</span><br><span class="line">    <span class="keyword">if</span>(mid&lt;R) ans += query(L,R,rson);</span><br><span class="line">    pushup(rt);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;l.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">int</span> T;<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        <span class="keyword">int</span> m;<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">        build(<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">        rep(i,<span class="number">0</span>,m)&#123;</span><br><span class="line">            <span class="keyword">int</span> op,x,y;<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;op,&amp;x,&amp;y);</span><br><span class="line">            x++;</span><br><span class="line">            <span class="keyword">if</span>(op==<span class="number">1</span>)&#123;</span><br><span class="line">                now = y;</span><br><span class="line">                maxl = x;maxr = x;flag = <span class="number">0</span>;</span><br><span class="line">                update1(x,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span>(now == y)</span><br><span class="line">                    <span class="built_in">puts</span>(<span class="string">&quot;Can not put any one.&quot;</span>);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>,maxl<span class="number">-1</span>,maxr<span class="number">-1</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                y++;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,query(x,y,<span class="number">1</span>,n,<span class="number">1</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="M-约会安排"><a href="#M-约会安排" class="headerlink" title="M - 约会安排"></a>M - 约会安排</h1><h2 id="题意-12"><a href="#题意-12" class="headerlink" title="题意"></a>题意</h2><p>对每一次查询寻找$val$长度的最前面空闲时间并占据他。</p>
<ul>
<li>如果是女神来查询，那么空闲的时间也包括基友的时间</li>
<li>如果是基友来查询，那么只有空闲的时间可以选择</li>
<li>如果想要学习$[l,r]$，那么$[l,r]$之间的时间都会被清空。</li>
</ul>
<h2 id="题解-12"><a href="#题解-12" class="headerlink" title="题解"></a>题解</h2><p>线段树的区间合并。</p>
<p>这里由于要维护两个线段树，所以用结构体来构造树，不过确实使用结构体封装之后复用性高了很多。</p>
<ul>
<li>定义三个量$ll,rr,mm$分别表示从区间$[L,R]$最左边开始的最长长度和从区间最右边开始的最长长度和区间内横跨中点的最长长度。</li>
<li>定义$maxlen$来表示区间内最长的长度来剪枝。</li>
</ul>
<p>这样就可以更新了。</p>
<p>一棵树代表屌丝+女神占有的，一棵树代表女神占有的。</p>
<p>查询分为三种方向</p>
<ul>
<li>先查询左边开始的长度是否大于$val$，如果大于返回$L$，或者是递归左子树。</li>
<li>再查询中间的部分长度是否大于$val$，如果大于返回$mid-rr[lc]+1$就是中点减掉从左半部分右边的长度。</li>
<li>再查询递归右子树。</li>
</ul>
<hr>
<p>+1 区间合并中 更新父节点必须每个都更新，所以有时候你在return 之前也要更新一下。</p>
<h2 id="AC代码-10"><a href="#AC代码-10" class="headerlink" title="AC代码"></a>AC代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,mid,rt&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson mid+1,r,rt&lt;&lt;1|1</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head ----------------------------------------</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">20</span>;</span><br><span class="line"><span class="keyword">int</span> T,n,m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sgt</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> maxlen[maxn&lt;&lt;<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">int</span> ll[maxn&lt;&lt;<span class="number">2</span>],rr[maxn&lt;&lt;<span class="number">2</span>],mm[maxn&lt;&lt;<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">int</span> lazy[maxn&lt;&lt;<span class="number">2</span>];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">        lazy[rt] = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">            ll[rt] = rr[rt] = <span class="number">0</span>;</span><br><span class="line">            mm[rt] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        build(lson); build(rson);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        lazy[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(lazy[rt]&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            maxlen[rt] = ll[rt] = rr[rt] = mm[rt] = (lazy[rt]?(r-l+<span class="number">1</span>):<span class="number">0</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> lc = rt&lt;&lt;<span class="number">1</span>,rc = rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">            ll[rt] = ll[lc];</span><br><span class="line">            <span class="keyword">if</span>(ll[lc]==(mid-l+<span class="number">1</span>)) ll[rt] += ll[rc];</span><br><span class="line">            mm[rt] = rr[lc] + ll[rc];</span><br><span class="line">            rr[rt] = rr[rc];</span><br><span class="line">            <span class="keyword">if</span>(rr[rc] == r-mid) rr[rt] += rr[lc];</span><br><span class="line">            maxlen[rt] = max(maxlen[lc],max(maxlen[rc],mm[rt]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(lazy[rt]&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> lc=rt&lt;&lt;<span class="number">1</span>,rc=rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>;</span><br><span class="line">            lazy[lc] = lazy[rc] = lazy[rt];</span><br><span class="line">            lazy[rt] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> val,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">        pushup(l,r,rt);</span><br><span class="line">        <span class="comment">//cout&lt;&lt;l&lt;&lt;&#x27; &#x27;&lt;&lt;r&lt;&lt;&#x27; &#x27;&lt;&lt;&quot;         &quot;;</span></span><br><span class="line">        <span class="keyword">int</span> lc = rt&lt;&lt;<span class="number">1</span>,rc = rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(val&gt;maxlen[rt]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(ll[rt] &gt;= val) <span class="keyword">return</span> l;</span><br><span class="line">        pushdown(rt);</span><br><span class="line">        pushup(rson);</span><br><span class="line">        <span class="keyword">int</span> temp = query(val,lson);</span><br><span class="line">        <span class="keyword">if</span>(temp) <span class="keyword">return</span> temp;</span><br><span class="line">        <span class="keyword">if</span>(mm[rt] &gt;= val) <span class="keyword">return</span> mid-rr[lc]+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> query(val,rson);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> val,<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(L&lt;=l &amp;&amp; r&lt;=R)&#123;</span><br><span class="line">            lazy[rt] = val;</span><br><span class="line">            pushup(l,r,rt);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        pushdown(rt);</span><br><span class="line">        <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(L&lt;=mid) update(val,L,R,lson);</span><br><span class="line">        <span class="keyword">else</span> pushup(lson);</span><br><span class="line">        <span class="keyword">if</span>(mid&lt;R) update(val,L,R,rson);</span><br><span class="line">        <span class="keyword">else</span> pushup(rson);</span><br><span class="line">        pushup(l,r,rt);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;all,ns;</span><br><span class="line"><span class="keyword">char</span> op[<span class="number">20</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;1.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line">    rep(test_case,<span class="number">1</span>,T+<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case %d:\n&quot;</span>,test_case);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">        <span class="comment">//all.build(1,n,1); ns.build(1,n,1);</span></span><br><span class="line">        all.init(); ns.init();</span><br><span class="line">        <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,op);</span><br><span class="line">            <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;D&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> x;<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">                <span class="keyword">int</span> ans = all.query(x,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span>(ans)&#123;</span><br><span class="line">                    all.update(<span class="number">0</span>,ans,ans+x<span class="number">-1</span>,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%d,let&#x27;s fly\n&quot;</span>,ans);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="built_in">puts</span>(<span class="string">&quot;fly with yourself&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;N&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> x;<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">                <span class="keyword">int</span> ans = all.query(x,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span>(!ans) ans = ns.query(x,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span>(ans)&#123;</span><br><span class="line">                    all.update(<span class="number">0</span>,ans,ans+x<span class="number">-1</span>,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">                    ns.update(<span class="number">0</span>,ans,ans+x<span class="number">-1</span>,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%d,don&#x27;t put my gezi\n&quot;</span>,ans);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="built_in">puts</span>(<span class="string">&quot;wait for me&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">int</span> x,y;<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;x,&amp;y);</span><br><span class="line">                all.update(<span class="number">1</span>,x,y,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">                ns.update(<span class="number">1</span>,x,y,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;I am the hope of chinese chengxuyuan!!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Reference:<a target="_blank" rel="noopener" href="https://www.cnblogs.com/DSChan/p/4861977.html">https://www.cnblogs.com/DSChan/p/4861977.html</a></p>
</blockquote>
<h1 id="N-picture"><a href="#N-picture" class="headerlink" title="N.picture"></a>N.picture</h1><h2 id="题意-13"><a href="#题意-13" class="headerlink" title="题意"></a>题意</h2><p>求多个矩形周长的并</p>
<h2 id="题解-13"><a href="#题解-13" class="headerlink" title="题解"></a>题解</h2><p>扫描线+线段树</p>
<hr>
<p>这道题目没有离散化$X$坐标就可以做。而且例子也只有一个。。</p>
<h2 id="ac代码-2"><a href="#ac代码-2" class="headerlink" title="ac代码"></a>ac代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,mid,rt&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson mid+1,r,rt&lt;&lt;1|1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">2e4</span>+<span class="number">100</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> lx,rx,y;</span><br><span class="line">    <span class="keyword">int</span> f;</span><br><span class="line">    node()&#123;&#125;</span><br><span class="line">    node(<span class="keyword">int</span> _lx,<span class="keyword">int</span> _rx,<span class="keyword">int</span> _y,<span class="keyword">int</span> _f)&#123;</span><br><span class="line">        lx = _lx; rx = _rx; y = _y; f = _f;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> node &amp;s) <span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> y&lt;s.y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;L[maxn&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> sum[maxn&lt;&lt;<span class="number">2</span>],lb[maxn&lt;&lt;<span class="number">2</span>],rb[maxn&lt;&lt;<span class="number">2</span>],seg[maxn&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> flag[maxn&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(flag[rt])&#123;</span><br><span class="line">        sum[rt] = r-l+<span class="number">1</span>;</span><br><span class="line">        lb[rt] = rb[rt] = <span class="number">1</span>;</span><br><span class="line">        seg[rt] = <span class="number">2</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        sum[rt] = lb[rt] = rb[rt] = seg[rt] = <span class="number">0</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        sum[rt] = sum[rt&lt;&lt;<span class="number">1</span>] + sum[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">        lb[rt] = lb[rt&lt;&lt;<span class="number">1</span>];</span><br><span class="line">        rb[rt] = rb[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">        seg[rt] = seg[rt&lt;&lt;<span class="number">1</span>] + seg[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span>(lb[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]&amp;&amp;rb[rt&lt;&lt;<span class="number">1</span>]) seg[rt]-=<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> val,<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=l &amp;&amp; r&lt;=R)&#123;</span><br><span class="line">        flag[rt] += val;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(L&lt;=mid) update(val,L,R,lson);</span><br><span class="line">        <span class="keyword">if</span>(mid&lt;R) update(val,L,R,rson);</span><br><span class="line">    &#125;</span><br><span class="line">    pushup(rt,l,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;1.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n))&#123;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> maxl = INF; <span class="keyword">int</span> maxr = -INF;</span><br><span class="line">        rep(i,<span class="number">0</span>,n)&#123;</span><br><span class="line">            <span class="keyword">int</span> x1,y1,x2,y2;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>,&amp;x1,&amp;y1,&amp;x2,&amp;y2);</span><br><span class="line">            L[++cnt] = node(x1,x2,y1,<span class="number">1</span>);</span><br><span class="line">            L[++cnt] = node(x1,x2,y2,<span class="number">-1</span>);</span><br><span class="line">            maxl = min(maxl,x1);</span><br><span class="line">            maxr = max(maxr,x2);</span><br><span class="line">        &#125;</span><br><span class="line">        sort(L+<span class="number">1</span>,L+<span class="number">1</span>+cnt);</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>; </span><br><span class="line">        <span class="keyword">int</span> last = <span class="number">0</span>;</span><br><span class="line">        rep(i,<span class="number">1</span>,cnt+<span class="number">1</span>)&#123;</span><br><span class="line">            update(L[i].f,L[i].lx,L[i].rx<span class="number">-1</span>,maxl,maxr,<span class="number">1</span>);</span><br><span class="line">            res += <span class="built_in">abs</span>(sum[<span class="number">1</span>]-last);</span><br><span class="line">            res += seg[<span class="number">1</span>] * (L[i+<span class="number">1</span>].y-L[i].y);</span><br><span class="line">            last = sum[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,res);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-09-06T14:37:54.000Z" title="2018-09-06T14:37:54.000Z">2018-09-06</time>发表</span><span class="level-item"><time dateTime="2018-09-06T14:37:54.355Z" title="2018-09-06T14:37:54.355Z">2018-09-06</time>更新</span><span class="level-item">几秒读完 (大约0个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/uncategorized/2018/09/06/kuangbin%E5%B8%A6%E4%BD%A0%E9%A3%9E13-%E5%9F%BA%E7%A1%80%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95.html">[kuangbin带你飞13]基础计算几何</a></h1><div class="content"></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-09-06T13:01:19.000Z" title="2018-09-06T13:01:19.000Z">2018-09-06</time>发表</span><span class="level-item"><time dateTime="2018-09-06T13:14:51.269Z" title="2018-09-06T13:14:51.269Z">2018-09-06</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/acm/">acm</a></span><span class="level-item">4 分钟读完 (大约599个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/acm/2018/09/06/hdoj5521-Meeting.html">[hdoj5521]Meeting</a></h1><div class="content"><h1 id="Meeting"><a href="#Meeting" class="headerlink" title="Meeting"></a><a target="_blank" rel="noopener" href="http://acm.hdu.edu.cn/showproblem.php?pid=5521">Meeting</a></h1><h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>将图分成$m$个块，每个块中的点到块中点的需要的时间为$E_i$。Bessie在点1，Elsie在点$n$，问他们在最短的时间走到可以到哪一个点会和。点可以在不同的块中。</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>如果想要每个点都建边，无疑会爆空间。我们可以看出每个点都分配到几个块，而每个块又有几个点。那么我们可以将块看做点，连接着块中的点，这样每个块的边从$O(n^2)$变成了$O(n)$。</p>
<hr>
<p>我tmWA了20发，就是因为以前都是将点做标记，但是这次是块也要做标记，不然每块会浪费很多时间。而且因为只要该点是最优的，那么该块也是最优的了(因为该点到该块的距离为0)。</p>
<h2 id="AC代码"><a href="#AC代码" class="headerlink" title="AC代码"></a>AC代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(linker,<span class="meta-string">&quot;/STACK:1024000000,1024000000&quot;</span>)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line">ll val[maxn];</span><br><span class="line">ll cnt1[maxn],cnt2[maxn];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">&#x27;0&#x27;</span>||ch&gt;<span class="string">&#x27;9&#x27;</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">&#x27;-&#x27;</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;9&#x27;</span>)&#123;x=x*<span class="number">10</span>+ch-<span class="string">&#x27;0&#x27;</span>;ch=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">int</span> T,n,m;</span><br><span class="line">ll ans[maxn];</span><br><span class="line"><span class="keyword">int</span> vis[maxn];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    ll t;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    node()&#123;&#125;</span><br><span class="line">    node(ll a,<span class="keyword">int</span> b):t(a),id(b)&#123;&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> node&amp;x) <span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> t &gt; x.t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> rt,ll *cnt,<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;B[],<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;E[])</span></span>&#123;</span><br><span class="line">    cnt[rt] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">priority_queue</span>&lt;node &gt; q;</span><br><span class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</span><br><span class="line">    <span class="keyword">int</span> use[maxn];</span><br><span class="line">    <span class="built_in">memset</span>(use,<span class="number">0</span>,<span class="keyword">sizeof</span>(use));</span><br><span class="line">    q.push(node(<span class="number">0</span>,rt));</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> u = q.top().id; q.pop();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> bk:B[u])&#123;</span><br><span class="line">            <span class="keyword">if</span>(use[bk]) <span class="keyword">continue</span>;</span><br><span class="line">            use[bk] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> v: E[bk])&#123;</span><br><span class="line">                <span class="keyword">if</span>(cnt[u]+val[bk]&gt;=cnt[v]) <span class="keyword">continue</span>;</span><br><span class="line">                cnt[v] = cnt[u] + val[bk];</span><br><span class="line">                q.push(node(cnt[v],v));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;m.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line">    rep(test_case,<span class="number">1</span>,T+<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="built_in">memset</span>(cnt1,<span class="number">127</span>,<span class="keyword">sizeof</span>(cnt1));</span><br><span class="line">        <span class="built_in">memset</span>(cnt2,<span class="number">127</span>,<span class="keyword">sizeof</span>(cnt2));</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; B[n+<span class="number">1</span>];</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; E[m+<span class="number">1</span>];</span><br><span class="line">        rep(i,<span class="number">1</span>,n+<span class="number">1</span>) B[i].resize(<span class="number">5</span>);</span><br><span class="line">        rep(i,<span class="number">1</span>,m+<span class="number">1</span>) E[i].resize(<span class="number">5</span>);</span><br><span class="line">        rep(i,<span class="number">1</span>,m+<span class="number">1</span>)&#123;</span><br><span class="line">            val[i] = read(); <span class="keyword">int</span> s = read();</span><br><span class="line">            rep(j,<span class="number">0</span>,s)&#123;</span><br><span class="line">                <span class="keyword">int</span> x = read();</span><br><span class="line">                E[i].pb(x);B[x].pb(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        bfs(<span class="number">1</span>,cnt1,B,E); bfs(n,cnt2,B,E);</span><br><span class="line">        ll mmin = <span class="number">0xfffffff</span>;</span><br><span class="line">        rep(i,<span class="number">1</span>,n+<span class="number">1</span>)&#123;</span><br><span class="line">            ans[i] = max(cnt1[i],cnt2[i]);</span><br><span class="line">            <span class="keyword">if</span>(ans[i]&lt;mmin) mmin=ans[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(mmin != <span class="number">0xfffffff</span>)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: %lld\n&quot;</span>,test_case,mmin);</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: Evil John\n&quot;</span>,test_case);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        ll res[maxn];</span><br><span class="line">        rep(i,<span class="number">1</span>,n+<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(ans[i]==mmin)</span><br><span class="line">                res[cnt++] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i,<span class="number">0</span>,cnt)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d%c&quot;</span>,res[i],i==cnt<span class="number">-1</span>?<span class="string">&#x27;\n&#x27;</span>:<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-09-05T11:26:39.000Z" title="2018-09-05T11:26:39.000Z">2018-09-05</time>发表</span><span class="level-item"><time dateTime="2018-09-05T11:27:57.328Z" title="2018-09-05T11:27:57.328Z">2018-09-05</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%A8%A1%E6%9D%BF/">模板</a></span><span class="level-item">40 分钟读完 (大约6074个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/%E6%A8%A1%E6%9D%BF/2018/09/05/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95%E6%A8%A1%E6%9D%BF.html">计算几何模板</a></h1><div class="content"><h2 id="J-Distance-to-work"><a href="#J-Distance-to-work" class="headerlink" title="J .Distance to work"></a>J .<a target="_blank" rel="noopener" href="https://www.nowcoder.com/acm/contest/141/J">Distance to work</a></h2><h3 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h3><p>懒得看了</p>
<h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><p>计算几何。</p>
<p>扒一扒dls的板子</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">const</span> db EPS = <span class="number">1e-9</span>;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">sign</span><span class="params">(db a)</span> </span>&#123; <span class="keyword">return</span> a &lt; -EPS ? <span class="number">-1</span> : a &gt; EPS; &#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">cmp</span><span class="params">(db a, db b)</span></span>&#123; <span class="keyword">return</span> sign(a-b); &#125;</span><br><span class="line">   </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">P</span> &#123;</span></span><br><span class="line">    db x, y;</span><br><span class="line">    P() &#123;&#125;</span><br><span class="line">    P(db _x, db _y) : x(_x), y(_y) &#123;&#125;</span><br><span class="line">    P <span class="keyword">operator</span>+(P p) &#123; <span class="keyword">return</span> &#123;x + p.x, y + p.y&#125;; &#125;</span><br><span class="line">    P <span class="keyword">operator</span>-(P p) &#123; <span class="keyword">return</span> &#123;x - p.x, y - p.y&#125;; &#125;</span><br><span class="line">    P <span class="keyword">operator</span>*(db d) &#123; <span class="keyword">return</span> &#123;x * d, y * d&#125;; &#125;</span><br><span class="line">    P <span class="keyword">operator</span>/(db d) &#123; <span class="keyword">return</span> &#123;x / d, y / d&#125;; &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(P p) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> c = cmp(x, p.x);</span><br><span class="line">        <span class="keyword">if</span> (c) <span class="keyword">return</span> c == <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">return</span> cmp(y, p.y) == <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>==(P o) <span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> cmp(x,o.x) == <span class="number">0</span> &amp;&amp; cmp(y,o.y) == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function">db <span class="title">dot</span><span class="params">(P p)</span> </span>&#123; <span class="keyword">return</span> x * p.x + y * p.y; &#125;</span><br><span class="line">    <span class="function">db <span class="title">det</span><span class="params">(P p)</span> </span>&#123; <span class="keyword">return</span> x * p.y - y * p.x; &#125;</span><br><span class="line">      </span><br><span class="line">    <span class="function">db <span class="title">distTo</span><span class="params">(P p)</span> </span>&#123; <span class="keyword">return</span> (*<span class="keyword">this</span>-p).<span class="built_in">abs</span>(); &#125;</span><br><span class="line">    <span class="function">db <span class="title">alpha</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">atan2</span>(y, x); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123; <span class="built_in">cin</span>&gt;&gt;x&gt;&gt;y; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">write</span><span class="params">()</span> </span>&#123;<span class="built_in">cout</span>&lt;&lt;<span class="string">&quot;(&quot;</span>&lt;&lt;x&lt;&lt;<span class="string">&quot;,&quot;</span>&lt;&lt;y&lt;&lt;<span class="string">&quot;)&quot;</span>&lt;&lt;<span class="built_in">endl</span>;&#125;</span><br><span class="line">    <span class="function">db <span class="title">abs</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">sqrt</span>(abs2());&#125;</span><br><span class="line">    <span class="function">db <span class="title">abs2</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> x * x + y * y; &#125;</span><br><span class="line">    <span class="function">P <span class="title">rot90</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> P(-y,x);&#125;</span><br><span class="line">    <span class="function">P <span class="title">unit</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> *<span class="keyword">this</span>/<span class="built_in">abs</span>(); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">quad</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> sign(y) == <span class="number">1</span> || (sign(y) == <span class="number">0</span> &amp;&amp; sign(x) &gt;= <span class="number">0</span>); &#125;</span><br><span class="line">    <span class="function">P <span class="title">rot</span><span class="params">(db an)</span></span>&#123; <span class="keyword">return</span> &#123;x*<span class="built_in">cos</span>(an)-y*<span class="built_in">sin</span>(an),x*<span class="built_in">sin</span>(an) + y*<span class="built_in">cos</span>(an)&#125;; &#125;</span><br><span class="line">&#125;;</span><br><span class="line">   </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">L</span>&#123;</span> <span class="comment">//ps[0] -&gt; ps[1]</span></span><br><span class="line">    P ps[<span class="number">2</span>];</span><br><span class="line">    L() &#123;&#125;</span><br><span class="line">    L(P p1,P p2) &#123; ps[<span class="number">0</span>]=p1; ps[<span class="number">1</span>]=p2; &#125;</span><br><span class="line">    P&amp; <span class="keyword">operator</span>[](<span class="keyword">int</span> i) &#123; <span class="keyword">return</span> ps[i]; &#125;</span><br><span class="line">    <span class="function">P <span class="title">dir</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> ps[<span class="number">1</span>] - ps[<span class="number">0</span>]; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">include</span><span class="params">(P p)</span> </span>&#123; <span class="keyword">return</span> sign((ps[<span class="number">1</span>] - ps[<span class="number">0</span>]).det(p - ps[<span class="number">0</span>])) &gt; <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="function">L <span class="title">push</span><span class="params">()</span></span>&#123; <span class="comment">// push eps outward</span></span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line">        P delta = (ps[<span class="number">1</span>] - ps[<span class="number">0</span>]).rot90().unit() * eps;</span><br><span class="line">        <span class="keyword">return</span> L(ps[<span class="number">0</span>] - delta, ps[<span class="number">1</span>] - delta);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> cross(p1,p2,p3) ((p2.x-p1.x)*(p3.y-p1.y)-(p3.x-p1.x)*(p2.y-p1.y))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> crossOp(p1,p2,p3) sign(cross(p1,p2,p3))</span></span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chkLL</span><span class="params">(P p1, P p2, P q1, P q2)</span> </span>&#123;</span><br><span class="line">    db a1 = cross(q1, q2, p1), a2 = -cross(q1, q2, p2);</span><br><span class="line">    <span class="keyword">return</span> sign(a1+a2) != <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="function">P <span class="title">isLL</span><span class="params">(P p1, P p2, P q1, P q2)</span> </span>&#123;</span><br><span class="line">    db a1 = cross(q1, q2, p1), a2 = -cross(q1, q2, p2);</span><br><span class="line">    <span class="keyword">return</span> (p1 * a2 + p2 * a1) / (a1 + a2);</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function">P <span class="title">isLL</span><span class="params">(L l1,L l2)</span></span>&#123; <span class="keyword">return</span> isLL(l1[<span class="number">0</span>],l1[<span class="number">1</span>],l2[<span class="number">0</span>],l2[<span class="number">1</span>]); &#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">intersect</span><span class="params">(db l1,db r1,db l2,db r2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l1&gt;r1) swap(l1,r1); <span class="keyword">if</span>(l2&gt;r2) swap(l2,r2);</span><br><span class="line">    <span class="keyword">return</span> !( cmp(r1,l2) == <span class="number">-1</span> || cmp(r2,l1) == <span class="number">-1</span> );</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isSS</span><span class="params">(P p1, P p2, P q1, P q2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> intersect(p1.x,p2.x,q1.x,q2.x) &amp;&amp; intersect(p1.y,p2.y,q1.y,q2.y) &amp;&amp;</span><br><span class="line">    crossOp(p1,p2,q1) * crossOp(p1,p2,q2) &lt;= <span class="number">0</span> &amp;&amp; crossOp(q1,q2,p1)</span><br><span class="line">            * crossOp(q1,q2,p2) &lt;= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isSS_strict</span><span class="params">(P p1, P p2, P q1, P q2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> crossOp(p1,p2,q1) * crossOp(p1,p2,q2) &lt; <span class="number">0</span> &amp;&amp; crossOp(q1,q2,p1)</span><br><span class="line">            * crossOp(q1,q2,p2) &lt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isMiddle</span><span class="params">(db a, db m, db b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sign(a - m) == <span class="number">0</span> || sign(b - m) == <span class="number">0</span> || (a &lt; m != b &lt; m);</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isMiddle</span><span class="params">(P a, P m, P b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> isMiddle(a.x, m.x, b.x) &amp;&amp; isMiddle(a.y, m.y, b.y);</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">onSeg</span><span class="params">(P p1, P p2, P q)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> crossOp(p1,p2,q) == <span class="number">0</span> &amp;&amp; isMiddle(p1, q, p2);</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">onSeg_strict</span><span class="params">(P p1, P p2, P q)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> crossOp(p1,p2,q) == <span class="number">0</span> &amp;&amp; sign((q-p1).dot(p1-p2)) * sign((q-p2).dot(p1-p2)) &lt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function">P <span class="title">proj</span><span class="params">(P p1, P p2, P q)</span> </span>&#123;</span><br><span class="line">    P dir = p2 - p1;</span><br><span class="line">    <span class="keyword">return</span> p1 + dir * (dir.dot(q - p1) / dir.abs2());</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function">P <span class="title">reflect</span><span class="params">(P p1, P p2, P q)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> proj(p1,p2,q) * <span class="number">2</span> - q;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function">db <span class="title">nearest</span><span class="params">(P p1,P p2,P q)</span></span>&#123;</span><br><span class="line">    P h = proj(p1,p2,q);</span><br><span class="line">    <span class="keyword">if</span>(isMiddle(p1,h,p2))</span><br><span class="line">        <span class="keyword">return</span> q.distTo(h);</span><br><span class="line">    <span class="keyword">return</span> min(p1.distTo(q),p2.distTo(q));</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function">db <span class="title">disSS</span><span class="params">(P p1, P p2, P q1, P q2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(isSS(p1,p2,q1,q2)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> min(min(nearest(p1,p2,q1),nearest(p1,p2,q2)), min(nearest(q1,q2,p1),nearest(q1,q2,p2)));</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function">db <span class="title">rad</span><span class="params">(P p1,P p2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> atan2l(p1.det(p2),p1.dot(p2));</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function">db <span class="title">incircle</span><span class="params">(P p1, P p2, P p3)</span></span>&#123;</span><br><span class="line">    db A = p1.distTo(p2);</span><br><span class="line">    db B = p2.distTo(p3);</span><br><span class="line">    db C = p3.distTo(p1);</span><br><span class="line">    <span class="keyword">return</span> sqrtl(A*B*C/(A+B+C));</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="comment">//polygon</span></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">db <span class="title">area</span><span class="params">(<span class="built_in">vector</span>&lt;P&gt; ps)</span></span>&#123;</span><br><span class="line">    db ret = <span class="number">0</span>; rep(i,<span class="number">0</span>,ps.size()) ret += ps[i].det(ps[(i+<span class="number">1</span>)%ps.size()]);</span><br><span class="line">    <span class="keyword">return</span> ret/<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">contain</span><span class="params">(<span class="built_in">vector</span>&lt;P&gt; ps, P p)</span></span>&#123; <span class="comment">//2:inside,1:on_seg,0:outside</span></span><br><span class="line">    <span class="keyword">int</span> n = ps.size(), ret = <span class="number">0</span>;</span><br><span class="line">    rep(i,<span class="number">0</span>,n)&#123;</span><br><span class="line">        P u=ps[i],v=ps[(i+<span class="number">1</span>)%n];</span><br><span class="line">        <span class="keyword">if</span>(onSeg(u,v,p)) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(cmp(u.y,v.y)&lt;=<span class="number">0</span>) swap(u,v);</span><br><span class="line">        <span class="keyword">if</span>(cmp(p.y,u.y) &gt;<span class="number">0</span> || cmp(p.y,v.y) &lt;= <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">        ret ^= crossOp(p,u,v) &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret*<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;P&gt; <span class="title">convexHull</span><span class="params">(<span class="built_in">vector</span>&lt;P&gt; ps)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = ps.size(); <span class="keyword">if</span>(n &lt;= <span class="number">1</span>) <span class="keyword">return</span> ps;</span><br><span class="line">    sort(ps.begin(), ps.end());</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;P&gt; <span class="title">qs</span><span class="params">(n * <span class="number">2</span>)</span></span>; <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; qs[k++] = ps[i++])</span><br><span class="line">        <span class="keyword">while</span> (k &gt; <span class="number">1</span> &amp;&amp; crossOp(qs[k - <span class="number">2</span>], qs[k - <span class="number">1</span>], ps[i]) &lt;= <span class="number">0</span>) --k;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">2</span>, t = k; i &gt;= <span class="number">0</span>; qs[k++] = ps[i--])</span><br><span class="line">        <span class="keyword">while</span> (k &gt; t &amp;&amp; crossOp(qs[k - <span class="number">2</span>], qs[k - <span class="number">1</span>], ps[i]) &lt;= <span class="number">0</span>) --k;</span><br><span class="line">    qs.resize(k - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> qs;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;P&gt; <span class="title">convexHullNonStrict</span><span class="params">(<span class="built_in">vector</span>&lt;P&gt; ps)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//caution: need to unique the Ps first</span></span><br><span class="line">    <span class="keyword">int</span> n = ps.size(); <span class="keyword">if</span>(n &lt;= <span class="number">1</span>) <span class="keyword">return</span> ps;</span><br><span class="line">    sort(ps.begin(), ps.end());</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;P&gt; <span class="title">qs</span><span class="params">(n * <span class="number">2</span>)</span></span>; <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; qs[k++] = ps[i++])</span><br><span class="line">        <span class="keyword">while</span> (k &gt; <span class="number">1</span> &amp;&amp; crossOp(qs[k - <span class="number">2</span>], qs[k - <span class="number">1</span>], ps[i]) &lt; <span class="number">0</span>) --k;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">2</span>, t = k; i &gt;= <span class="number">0</span>; qs[k++] = ps[i--])</span><br><span class="line">        <span class="keyword">while</span> (k &gt; t &amp;&amp; crossOp(qs[k - <span class="number">2</span>], qs[k - <span class="number">1</span>], ps[i]) &lt; <span class="number">0</span>) --k;</span><br><span class="line">    qs.resize(k - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> qs;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function">db <span class="title">convexDiameter</span><span class="params">(<span class="built_in">vector</span>&lt;P&gt; ps)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = ps.size(); <span class="keyword">if</span>(n &lt;= <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> is = <span class="number">0</span>, js = <span class="number">0</span>; rep(k,<span class="number">1</span>,n) is = ps[k]&lt;ps[is]?k:is, js = ps[js] &lt; ps[k]?k:js;</span><br><span class="line">    <span class="keyword">int</span> i = is, j = js;</span><br><span class="line">    db ret = ps[i].distTo(ps[j]);</span><br><span class="line">    <span class="keyword">do</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>((ps[(i+<span class="number">1</span>)%n]-ps[i]).det(ps[(j+<span class="number">1</span>)%n]-ps[j]) &gt;= <span class="number">0</span>)</span><br><span class="line">            (++j)%=n;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            (++i)%=n;</span><br><span class="line">        ret = max(ret,ps[i].distTo(ps[j]));</span><br><span class="line">    &#125;<span class="keyword">while</span>(i!=is || j!=js);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;P&gt; <span class="title">convexCut</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;P&gt;&amp;ps, P q1, P q2)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;P&gt; qs;</span><br><span class="line">    <span class="keyword">int</span> n = ps.size();</span><br><span class="line">    rep(i,<span class="number">0</span>,n)&#123;</span><br><span class="line">        P p1 = ps[i], p2 = ps[(i+<span class="number">1</span>)%n];</span><br><span class="line">        <span class="keyword">int</span> d1 = crossOp(q1,q2,p1), d2 = crossOp(q1,q2,p2);</span><br><span class="line">        <span class="keyword">if</span>(d1 &gt;= <span class="number">0</span>) qs.pb(p1);</span><br><span class="line">        <span class="keyword">if</span>(d1 * d2 &lt; <span class="number">0</span>) qs.pb(isLL(p1,p2,q1,q2));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> qs;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="comment">//min_dist</span></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">db <span class="title">min_dist</span><span class="params">(<span class="built_in">vector</span>&lt;P&gt;&amp;ps,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(r-l&lt;=<span class="number">5</span>)&#123;</span><br><span class="line">        db ret = <span class="number">1e100</span>;</span><br><span class="line">        rep(i,l,r) rep(j,l,i) ret = min(ret,ps[i].distTo(ps[j]));</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> m = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    db ret = min(min_dist(ps,l,m),min_dist(ps,m,r));</span><br><span class="line">    <span class="built_in">vector</span>&lt;P&gt; qs; rep(i,l,r) <span class="keyword">if</span>(<span class="built_in">abs</span>(ps[i].x-ps[m].x)&lt;= ret) qs.pb(ps[i]);</span><br><span class="line">    sort(qs.begin(), qs.end(),[](P a,P b) -&gt; <span class="keyword">bool</span> &#123;<span class="keyword">return</span> a.y&lt;b.y; &#125;);</span><br><span class="line">    rep(i,<span class="number">1</span>,qs.size()) <span class="keyword">for</span>(<span class="keyword">int</span> j=i<span class="number">-1</span>;j&gt;=<span class="number">0</span>&amp;&amp;qs[j].y&gt;=qs[i].y-ret;--j)</span><br><span class="line">        ret = min(ret,qs[i].distTo(qs[j]));</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">type</span><span class="params">(P o1,db r1,P o2,db r2)</span></span>&#123;</span><br><span class="line">    db d = o1.distTo(o2);</span><br><span class="line">    <span class="keyword">if</span>(cmp(d,r1+r2) == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">if</span>(cmp(d,r1+r2) == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">if</span>(cmp(d,<span class="built_in">abs</span>(r1-r2)) == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(cmp(d,<span class="built_in">abs</span>(r1-r2)) == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;P&gt; <span class="title">isCL</span><span class="params">(P o,db r,P p1,P p2)</span></span>&#123;</span><br><span class="line">    db x = (p1-o).dot(p2-p1), y = (p2-p1).abs2(), d = x * x - y * ((p1-o).abs2() - r*r);</span><br><span class="line">    <span class="keyword">if</span>(sign(d) &lt; <span class="number">0</span>) <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    d = max(d,<span class="number">0.0</span>); P m = p1 - (p2-p1)*(x/y), dr = (p2-p1)*(<span class="built_in">sqrt</span>(d)/y);</span><br><span class="line">    <span class="keyword">return</span> &#123;m-dr,m+dr&#125;; <span class="comment">//along dir: p1-&gt;p2</span></span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;P&gt; <span class="title">isCC</span><span class="params">(P o1, db r1, P o2, db r2)</span> </span>&#123; <span class="comment">//need to check whether two circles are the same</span></span><br><span class="line">    db d = o1.distTo(o2);</span><br><span class="line">    <span class="keyword">if</span> (cmp(d, r1 + r2) == <span class="number">1</span>) <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    <span class="keyword">if</span> (cmp(d,<span class="built_in">abs</span>(r1-r2))==<span class="number">-1</span>) <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    d = min(d, r1 + r2);</span><br><span class="line">    db y = (r1 * r1 + d * d - r2 * r2) / (<span class="number">2</span> * d), x = <span class="built_in">sqrt</span>(r1 * r1 - y * y);</span><br><span class="line">    P dr = (o2 - o1).unit();</span><br><span class="line">    P q1 = o1 + dr * y, q2 = dr.rot90() * x;</span><br><span class="line">    <span class="keyword">return</span> &#123;q1-q2,q1+q2&#125;;<span class="comment">//along circle 1</span></span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;P&gt; <span class="title">tanCP</span><span class="params">(P o, db r, P p)</span> </span>&#123;</span><br><span class="line">    db x = (p - o).abs2(), d = x - r * r;</span><br><span class="line">    <span class="keyword">if</span> (sign(d) &lt;= <span class="number">0</span>) <span class="keyword">return</span> &#123;&#125;; <span class="comment">// on circle =&gt; no tangent</span></span><br><span class="line">    P q1 = o + (p - o) * (r * r / x);</span><br><span class="line">    P q2 = (p - o).rot90() * (r * <span class="built_in">sqrt</span>(d) / x);</span><br><span class="line">    <span class="keyword">return</span> &#123;q1-q2,q1+q2&#125;; <span class="comment">//counter clock-wise</span></span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;L&gt; <span class="title">extanCC</span><span class="params">(P o1, db r1, P o2, db r2)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;L&gt; ret;</span><br><span class="line">    <span class="keyword">if</span> (cmp(r1, r2) == <span class="number">0</span>) &#123;</span><br><span class="line">        P dr = (o2 - o1).unit().rot90() * r1;</span><br><span class="line">        ret.pb(L(o1 + dr, o2 + dr)), ret.pb(L(o1 - dr, o2 - dr));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        P p = (o2 * r1 - o1 * r2) / (r1 - r2);</span><br><span class="line">        <span class="built_in">vector</span>&lt;P&gt; ps = tanCP(o1, r1, p), qs = tanCP(o2, r2, p);</span><br><span class="line">        rep(i,<span class="number">0</span>,min(ps.size(),qs.size())) ret.pb(L(ps[i], qs[i])); <span class="comment">//c1 counter-clock wise</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;L&gt; <span class="title">intanCC</span><span class="params">(P o1, db r1, P o2, db r2)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;L&gt; ret;</span><br><span class="line">    P p = (o1 * r2 + o2 * r1) / (r1 + r2);</span><br><span class="line">    <span class="built_in">vector</span>&lt;P&gt; ps = tanCP(o1,r1,p), qs = tanCP(o2,r2,p);</span><br><span class="line">    rep(i,<span class="number">0</span>,min(ps.size(),qs.size())) ret.pb(L(ps[i], qs[i])); <span class="comment">//c1 counter-clock wise</span></span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function">db <span class="title">areaCT</span><span class="params">(db r, P p1, P p2)</span></span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;P&gt; is = isCL(P(<span class="number">0</span>,<span class="number">0</span>),r,p1,p2);</span><br><span class="line">    <span class="keyword">if</span>(is.empty()) <span class="keyword">return</span> r*r*rad(p1,p2)/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">bool</span> b1 = cmp(p1.abs2(),r*r) == <span class="number">1</span>, b2 = cmp(p2.abs2(), r*r) == <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(b1 &amp;&amp; b2)&#123;</span><br><span class="line">        <span class="keyword">if</span>(sign((p1-is[<span class="number">0</span>]).dot(p2-is[<span class="number">0</span>])) &lt;= <span class="number">0</span> &amp;&amp;</span><br><span class="line">            sign((p1-is[<span class="number">0</span>]).dot(p2-is[<span class="number">0</span>])) &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> r*r*(rad(p1,is[<span class="number">0</span>]) + rad(is[<span class="number">1</span>],p2))/<span class="number">2</span> + is[<span class="number">0</span>].det(is[<span class="number">1</span>])/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> r*r*rad(p1,p2)/<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(b1) <span class="keyword">return</span> (r*r*rad(p1,is[<span class="number">0</span>]) + is[<span class="number">0</span>].det(p2))/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(b2) <span class="keyword">return</span> (p1.det(is[<span class="number">1</span>]) + r*r*rad(is[<span class="number">1</span>],p2))/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">return</span> p1.det(p2)/<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">parallel</span><span class="params">(L l0, L l1)</span> </span>&#123; <span class="keyword">return</span> sign( l0.dir().det( l1.dir() ) ) == <span class="number">0</span>; &#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">sameDir</span><span class="params">(L l0, L l1)</span> </span>&#123; <span class="keyword">return</span> parallel(l0, l1) &amp;&amp; sign(l0.dir().dot(l1.dir()) ) == <span class="number">1</span>; &#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span> <span class="params">(P a,  P b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a.quad() != b.quad()) &#123;</span><br><span class="line">        <span class="keyword">return</span> a.quad() &lt; b.quad();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sign( a.det(b) ) &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (L l0, L l1) &#123;</span><br><span class="line">    <span class="keyword">if</span> (sameDir(l0, l1)) &#123;</span><br><span class="line">        <span class="keyword">return</span> l1.include(l0[<span class="number">0</span>]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> cmp( l0.dir(), l1.dir() );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(L u, L v, L w)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> w.include(isLL(u,v));</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;P&gt; <span class="title">halfPlaneIS</span><span class="params">(<span class="built_in">vector</span>&lt;L&gt; &amp;l)</span> </span>&#123;</span><br><span class="line">    sort(l.begin(), l.end());</span><br><span class="line">    <span class="built_in">deque</span>&lt;L&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)l.size(); ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &amp;&amp; sameDir(l[i], l[i - <span class="number">1</span>])) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">while</span> (q.size() &gt; <span class="number">1</span> &amp;&amp; !check(q[q.size() - <span class="number">2</span>], q[q.size() - <span class="number">1</span>], l[i])) q.pop_back();</span><br><span class="line">        <span class="keyword">while</span> (q.size() &gt; <span class="number">1</span> &amp;&amp; !check(q[<span class="number">1</span>], q[<span class="number">0</span>], l[i])) q.pop_front();</span><br><span class="line">        q.push_back(l[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (q.size() &gt; <span class="number">2</span> &amp;&amp; !check(q[q.size() - <span class="number">2</span>], q[q.size() - <span class="number">1</span>], q[<span class="number">0</span>])) q.pop_back();</span><br><span class="line">    <span class="keyword">while</span> (q.size() &gt; <span class="number">2</span> &amp;&amp; !check(q[<span class="number">1</span>], q[<span class="number">0</span>], q[q.size() - <span class="number">1</span>])) q.pop_front();</span><br><span class="line">    <span class="built_in">vector</span>&lt;P&gt; ret;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)q.size(); ++i) ret.push_back(isLL(q[i], q[(i + <span class="number">1</span>) % q.size()]));</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="function">P <span class="title">inCenter</span><span class="params">(P A, P B, P C)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> a = (B - C).<span class="built_in">abs</span>(), b = (C - A).<span class="built_in">abs</span>(), c = (A - B).<span class="built_in">abs</span>();</span><br><span class="line">    <span class="keyword">return</span> (A * a + B * b + C * c) / (a + b + c);</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="function">P <span class="title">circumCenter</span><span class="params">(P a, P b, P c)</span> </span>&#123;</span><br><span class="line">    P bb = b - a, cc = c - a;</span><br><span class="line">    <span class="keyword">double</span> db = bb.abs2(), dc = cc.abs2(), d = <span class="number">2</span> * bb.det(cc);</span><br><span class="line">    <span class="keyword">return</span> a - P(bb.y * dc - cc.y * db, cc.x * db - bb.x * dc) / d;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="function">P <span class="title">othroCenter</span><span class="params">(P a, P b, P c)</span> </span>&#123;</span><br><span class="line">    P ba = b - a, ca = c - a, bc = b - c;</span><br><span class="line">    <span class="keyword">double</span> Y = ba.y * ca.y * bc.y,</span><br><span class="line">    A = ca.x * ba.y - ba.x * ca.y,</span><br><span class="line">    x0 = (Y + ca.x * ba.y * b.x - ba.x * ca.y * c.x) / A,</span><br><span class="line">    y0 = -ba.x * (x0 - c.x) / ba.y + ca.y;</span><br><span class="line">    <span class="keyword">return</span> &#123;x0, y0&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="AC代码（别人家的模板。）"><a href="#AC代码（别人家的模板。）" class="headerlink" title="AC代码（别人家的模板。）"></a>AC代码（别人家的模板。）</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>; <span class="comment">// 计算几何模板</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, x, n) for (int i = x; i &lt; n; ++i)</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> inf = <span class="number">1e20</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxp = <span class="number">1010</span>;</span><br><span class="line"><span class="comment">// Compares a double to zero</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sgn</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(x) &lt; eps) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// square of a double</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">sqr</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x * x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">15 * Point</span></span><br><span class="line"><span class="comment">16 * Point() - Empty constructor</span></span><br><span class="line"><span class="comment">17 * Point(double _x,double _y) - constructor</span></span><br><span class="line"><span class="comment">18 * input() - double input</span></span><br><span class="line"><span class="comment">19 * output() - %.2f output</span></span><br><span class="line"><span class="comment">20 * operator == - compares x and y</span></span><br><span class="line"><span class="comment">21 * operator &lt; - compares first by x, then by y</span></span><br><span class="line"><span class="comment">22 * operator - - return new Point after subtracting</span></span><br><span class="line"><span class="comment">curresponging x and y</span></span><br><span class="line"><span class="comment">23 * operator ^ - cross product of 2d points</span></span><br><span class="line"><span class="comment">24 * operator * - dot product</span></span><br><span class="line"><span class="comment">25 * len() - gives length from origin</span></span><br><span class="line"><span class="comment">26 * len2() - gives square of length from origin</span></span><br><span class="line"><span class="comment">27 * distance(Point p) - gives distance from p</span></span><br><span class="line"><span class="comment">28 * operator + Point b - returns new Point after adding</span></span><br><span class="line"><span class="comment">curresponging x and y</span></span><br><span class="line"><span class="comment">29 * operator * double k - returns new Point after multiplieing x and</span></span><br><span class="line"><span class="comment">y by k</span></span><br><span class="line"><span class="comment">30 * operator / double k - returns new Point after divideing x and y</span></span><br><span class="line"><span class="comment">by k</span></span><br><span class="line"><span class="comment">31 * rad(Point a,Point b) - returns the angle of Point a and Point b</span></span><br><span class="line"><span class="comment">from this Point</span></span><br><span class="line"><span class="comment">32 * trunc(double r) - return Point that if truncated the</span></span><br><span class="line"><span class="comment">distance from center to r</span></span><br><span class="line"><span class="comment">33 * rotleft() - returns 90 degree ccw rotated point</span></span><br><span class="line"><span class="comment">34 * rotright() - returns 90 degree cw rotated point</span></span><br><span class="line"><span class="comment">35 * rotate(Point p,double angle) - returns Point after rotateing the</span></span><br><span class="line"><span class="comment">Point centering at p by angle radian ccw</span></span><br><span class="line"><span class="comment">36 */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line">    Point() &#123;&#125;</span><br><span class="line">    Point(<span class="keyword">double</span> _x, <span class="keyword">double</span> _y) &#123;</span><br><span class="line">        x = _x;</span><br><span class="line">        y = _y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lf%lf&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.2f␣%.2f\n&quot;</span>, x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>==(Point b) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sgn(x - b.x) == <span class="number">0</span> &amp;&amp; sgn(y - b.y) == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(Point b) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sgn(x - b.x) == <span class="number">0</span> ? sgn(y - b.y) &lt; <span class="number">0</span> : x &lt; b.x;</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span>-(<span class="keyword">const</span> Point &amp;b) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Point(x - b.x, y - b.y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//叉积</span></span><br><span class="line">    <span class="keyword">double</span> <span class="keyword">operator</span>^(<span class="keyword">const</span> Point &amp;b) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x * b.y - y * b.x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//点积</span></span><br><span class="line">    <span class="keyword">double</span> <span class="keyword">operator</span>*(<span class="keyword">const</span> Point &amp;b) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x * b.x + y * b.y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回长度</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">len</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hypot(x, y); <span class="comment">//库函数</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回长度的平方</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">len2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x * x + y * y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回两点的距离</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">distance</span><span class="params">(Point p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hypot(x - p.x, y - p.y);</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span>+(<span class="keyword">const</span> Point &amp;b) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Point(x + b.x, y + b.y);</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span>*(<span class="keyword">const</span> <span class="keyword">double</span> &amp;k) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Point(x * k, y * k);</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span>/(<span class="keyword">const</span> <span class="keyword">double</span> &amp;k) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Point(x / k, y / k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//计算 pa 和 pb 的夹角</span></span><br><span class="line">    <span class="comment">//就是求这个点看 a,b 所成的夹角</span></span><br><span class="line">    <span class="comment">//测试 LightOJ1203</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">rad</span><span class="params">(Point a, Point b)</span> </span>&#123;</span><br><span class="line">        Point p = *<span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">fabs</span>(<span class="built_in">atan2</span>(<span class="built_in">fabs</span>((a - p) ^ (b - p)), (a - p) * (b - p)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//化为长度为 r 的向量</span></span><br><span class="line">    <span class="function">Point <span class="title">trunc</span><span class="params">(<span class="keyword">double</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> l = len();</span><br><span class="line">        <span class="keyword">if</span> (!sgn(l)) <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">        r /= l;</span><br><span class="line">        <span class="keyword">return</span> Point(x * r, y * r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//逆时针旋转 90 度</span></span><br><span class="line">    <span class="function">Point <span class="title">rotleft</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Point(-y, x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//顺时针旋转 90 度</span></span><br><span class="line">    <span class="function">Point <span class="title">rotright</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Point(y, -x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//绕着 p 点逆时针旋转 angle</span></span><br><span class="line">    <span class="function">Point <span class="title">rotate</span><span class="params">(Point p, <span class="keyword">double</span> angle)</span> </span>&#123;</span><br><span class="line">        Point v = (*<span class="keyword">this</span>) - p;</span><br><span class="line">        <span class="keyword">double</span> c = <span class="built_in">cos</span>(angle), s = <span class="built_in">sin</span>(angle);</span><br><span class="line">        <span class="keyword">return</span> Point(p.x + v.x * c - v.y * s, p.y + v.x * s + v.y * c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Stores two points</span></span><br><span class="line"><span class="comment"> * Line() - Empty constructor</span></span><br><span class="line"><span class="comment"> * Line(Point _s,Point _e) - Line through _s and _e</span></span><br><span class="line"><span class="comment"> * operator == - checks if two points are same</span></span><br><span class="line"><span class="comment"> * Line(Point p,double angle) - one end p , another end at angle degree</span></span><br><span class="line"><span class="comment"> * Line(double a,double b,double c) - Line of equation ax + by + c = 0</span></span><br><span class="line"><span class="comment"> * input() - inputs s and e</span></span><br><span class="line"><span class="comment"> * adjust() - orders in such a way that s &lt; e</span></span><br><span class="line"><span class="comment"> * length() - distance of se</span></span><br><span class="line"><span class="comment"> * angle() - return 0 &lt;= angle &lt; pi</span></span><br><span class="line"><span class="comment"> * relation(Point p) - 3 if point is on line</span></span><br><span class="line"><span class="comment"> * 1 if point on the left of line</span></span><br><span class="line"><span class="comment"> * 2 if point on the right of line</span></span><br><span class="line"><span class="comment"> * pointonseg(double p) - return true if point on segment</span></span><br><span class="line"><span class="comment"> * parallel(Line v) - return true if they are parallel</span></span><br><span class="line"><span class="comment"> * segcrossseg(Line v) - returns 0 if does not intersect</span></span><br><span class="line"><span class="comment"> * returns 1 if non - standard intersection</span></span><br><span class="line"><span class="comment"> * returns 2 if intersects</span></span><br><span class="line"><span class="comment"> * linecrossseg(Line v) - line and seg</span></span><br><span class="line"><span class="comment"> * linecrossline(Line v) - 0 if parallel</span></span><br><span class="line"><span class="comment"> * 1 if coincides</span></span><br><span class="line"><span class="comment"> * 2 if intersects</span></span><br><span class="line"><span class="comment"> * crosspoint(Line v) - returns intersection point</span></span><br><span class="line"><span class="comment"> * dispointtoline(Point p) - distance from point p to the line</span></span><br><span class="line"><span class="comment"> * dispointtoseg(Point p) - distance from p to the segment</span></span><br><span class="line"><span class="comment"> * dissegtoseg(Line v) - distance of two segment</span></span><br><span class="line"><span class="comment"> * lineprog(Point p) - returns projected point p on se line</span></span><br><span class="line"><span class="comment"> * symmetrypoint(Point p) - returns reflection point of p over se</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Line</span> &#123;</span></span><br><span class="line">    Point s, e;</span><br><span class="line">    Line() &#123;&#125;</span><br><span class="line">    Line(Point _s, Point _e) &#123;</span><br><span class="line">        s = _s;</span><br><span class="line">        e = _e;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>==(Line v) &#123;</span><br><span class="line">        <span class="keyword">return</span> (s == v.s) &amp;&amp; (e == v.e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//根据一个点和倾斜角 angle 确定直线,0&lt;=angle&lt;pi</span></span><br><span class="line">    Line(Point p, <span class="keyword">double</span> angle) &#123;</span><br><span class="line">        s = p;</span><br><span class="line">        <span class="keyword">if</span> (sgn(angle - pi / <span class="number">2</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">            e = (s + Point(<span class="number">0</span>, <span class="number">1</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            e = (s + Point(<span class="number">1</span>, <span class="built_in">tan</span>(angle)));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ax+by+c=0</span></span><br><span class="line">    Line(<span class="keyword">double</span> a, <span class="keyword">double</span> b, <span class="keyword">double</span> c) &#123;</span><br><span class="line">        <span class="keyword">if</span> (sgn(a) == <span class="number">0</span>) &#123;</span><br><span class="line">            s = Point(<span class="number">0</span>, -c / b);</span><br><span class="line">            e = Point(<span class="number">1</span>, -c / b);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sgn(b) == <span class="number">0</span>) &#123;</span><br><span class="line">            s = Point(-c / a, <span class="number">0</span>);</span><br><span class="line">            e = Point(-c / a, <span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            s = Point(<span class="number">0</span>, -c / b);</span><br><span class="line">            e = Point(<span class="number">1</span>, (-c - a) / b);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        s.input();</span><br><span class="line">        e.input();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">adjust</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (e &lt; s) swap(s, e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//求线段长度</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">length</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> s.distance(e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回直线倾斜角 0&lt;=angle&lt;pi</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">angle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> k = <span class="built_in">atan2</span>(e.y - s.y, e.x - s.x);</span><br><span class="line">        <span class="keyword">if</span> (sgn(k) &lt; <span class="number">0</span>) k += pi;</span><br><span class="line">        <span class="keyword">if</span> (sgn(k - pi) == <span class="number">0</span>) k -= pi;</span><br><span class="line">        <span class="keyword">return</span> k;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//点和直线关系</span></span><br><span class="line">    <span class="comment">// 1 在左侧</span></span><br><span class="line">    <span class="comment">// 2 在右侧</span></span><br><span class="line">    <span class="comment">// 3 在直线上</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">relation</span><span class="params">(Point p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> c = sgn((p - s) ^ (e - s));</span><br><span class="line">        <span class="keyword">if</span> (c &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (c &gt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 点在线段上的判断</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">pointonseg</span><span class="params">(Point p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sgn((p - s) ^ (e - s)) == <span class="number">0</span> &amp;&amp; sgn((p - s) * (p - e)) &lt;= <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//两向量平行 (对应直线平行或重合)</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">parallel</span><span class="params">(Line v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sgn((e - s) ^ (v.e - v.s)) == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//两线段相交判断</span></span><br><span class="line">    <span class="comment">// 2 规范相交</span></span><br><span class="line">    <span class="comment">// 1 非规范相交</span></span><br><span class="line">    <span class="comment">// 0 不相交</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">segcrossseg</span><span class="params">(Line v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> d1 = sgn((e - s) ^ (v.s - s));</span><br><span class="line">        <span class="keyword">int</span> d2 = sgn((e - s) ^ (v.e - s));</span><br><span class="line">        <span class="keyword">int</span> d3 = sgn((v.e - v.s) ^ (s - v.s));</span><br><span class="line">        <span class="keyword">int</span> d4 = sgn((v.e - v.s) ^ (e - v.s));</span><br><span class="line">        <span class="keyword">if</span> ((d1 ^ d2) == <span class="number">-2</span> &amp;&amp; (d3 ^ d4) == <span class="number">-2</span>) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">return</span> (d1 == <span class="number">0</span> &amp;&amp; sgn((v.s - s) * (v.s - e)) &lt;= <span class="number">0</span>) || (d2 == <span class="number">0</span> &amp;&amp; sgn((v.e - s) * (v.e - e)) &lt;= <span class="number">0</span>) || (d3 == <span class="number">0</span> &amp;&amp; sgn((s - v.s) * (s - v.e)) &lt;= <span class="number">0</span>) || (d4 == <span class="number">0</span> &amp;&amp; sgn((e - v.s) * (e - v.e)) &lt;= <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//直线和线段相交判断</span></span><br><span class="line">    <span class="comment">//-*this line -v seg</span></span><br><span class="line">    <span class="comment">// 2 规范相交</span></span><br><span class="line">    <span class="comment">// 1 非规范相交</span></span><br><span class="line">    <span class="comment">// 0 不相交</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">linecrossseg</span><span class="params">(Line v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> d1 = sgn((e - s) ^ (v.s - s));</span><br><span class="line">        <span class="keyword">int</span> d2 = sgn((e - s) ^ (v.e - s));</span><br><span class="line">        <span class="keyword">if</span> ((d1 ^ d2) == <span class="number">-2</span>) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">return</span> (d1 == <span class="number">0</span> || d2 == <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//两直线关系</span></span><br><span class="line">    <span class="comment">// 0 平行</span></span><br><span class="line">    <span class="comment">// 1 重合</span></span><br><span class="line">    <span class="comment">// 2 相交</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">linecrossline</span><span class="params">(Line v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ((*<span class="keyword">this</span>).parallel(v)) <span class="keyword">return</span> v.relation(s) == <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//求两直线的交点</span></span><br><span class="line">    <span class="comment">//要保证两直线不平行或重合</span></span><br><span class="line">    <span class="function">Point <span class="title">crosspoint</span><span class="params">(Line v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> a1 = (v.e - v.s) ^ (s - v.s);</span><br><span class="line">        <span class="keyword">double</span> a2 = (v.e - v.s) ^ (e - v.s);</span><br><span class="line">        <span class="keyword">return</span> Point((s.x * a2 - e.x * a1) / (a2 - a1), (s.y * a2 - e.y * a1) / (a2 - a1));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//点到直线的距离</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">dispointtoline</span><span class="params">(Point p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">fabs</span>((p - s) ^ (e - s)) / length();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//点到线段的距离</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">dispointtoseg</span><span class="params">(Point p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (sgn((p - s) * (e - s)) &lt; <span class="number">0</span> || sgn((p - e) * (s - e)) &lt; <span class="number">0</span>) <span class="keyword">return</span> min(p.distance(s), p.distance(e));</span><br><span class="line">        <span class="keyword">return</span> dispointtoline(p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回线段到线段的距离</span></span><br><span class="line">    <span class="comment">//前提是两线段不相交，相交距离就是 0 了</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">dissegtoseg</span><span class="params">(Line v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> min(min(dispointtoseg(v.s), dispointtoseg(v.e)), min(v.dispointtoseg(s), v.dispointtoseg(e)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回点 p 在直线上的投影</span></span><br><span class="line">    <span class="function">Point <span class="title">lineprog</span><span class="params">(Point p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> s + (((e - s) * ((e - s) * (p - s))) / ((e - s).len2()));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回点 p 关于直线的对称点</span></span><br><span class="line">    <span class="function">Point <span class="title">symmetrypoint</span><span class="params">(Point p)</span> </span>&#123;</span><br><span class="line">        Point q = lineprog(p);</span><br><span class="line">        <span class="keyword">return</span> Point(<span class="number">2</span> * q.x - p.x, <span class="number">2</span> * q.y - p.y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">circle</span> &#123;</span></span><br><span class="line">    Point p;  <span class="comment">//圆心</span></span><br><span class="line">    <span class="keyword">double</span> r; <span class="comment">//半径</span></span><br><span class="line">    circle() &#123;&#125;</span><br><span class="line">    circle(Point _p, <span class="keyword">double</span> _r) &#123;</span><br><span class="line">        p = _p;</span><br><span class="line">        r = _r;</span><br><span class="line">    &#125;</span><br><span class="line">    circle(<span class="keyword">double</span> x, <span class="keyword">double</span> y, <span class="keyword">double</span> _r) &#123;</span><br><span class="line">        p = Point(x, y);</span><br><span class="line">        r = _r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//三角形的外接圆</span></span><br><span class="line">    <span class="comment">//需要 Point 的 + / rotate() 以及 Line 的 crosspoint()</span></span><br><span class="line">    <span class="comment">//利用两条边的中垂线得到圆心</span></span><br><span class="line">    <span class="comment">//测试：UVA12304</span></span><br><span class="line">    circle(Point a, Point b, Point c) &#123;</span><br><span class="line">        Line u = Line((a + b) / <span class="number">2</span>, ((a + b) / <span class="number">2</span>) + ((b - a).rotleft()));</span><br><span class="line">        Line v = Line((b + c) / <span class="number">2</span>, ((b + c) / <span class="number">2</span>) + ((c - b).rotleft()));</span><br><span class="line">        p = u.crosspoint(v);</span><br><span class="line">        r = p.distance(a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//三角形的内切圆</span></span><br><span class="line">    <span class="comment">//参数 bool t 没有作用，只是为了和上面外接圆函数区别</span></span><br><span class="line">    <span class="comment">//测试：UVA12304</span></span><br><span class="line">    circle(Point a, Point b, Point c, <span class="keyword">bool</span> t) &#123;</span><br><span class="line">        Line u, v;</span><br><span class="line">        <span class="keyword">double</span> m = <span class="built_in">atan2</span>(b.y - a.y, b.x - a.x), n = <span class="built_in">atan2</span>(c.y - a.y, c.x - a.x);</span><br><span class="line">        u.s = a;</span><br><span class="line">        u.e = u.s + Point(<span class="built_in">cos</span>((n + m) / <span class="number">2</span>), <span class="built_in">sin</span>((n + m) / <span class="number">2</span>));</span><br><span class="line">        v.s = b;</span><br><span class="line">        m = <span class="built_in">atan2</span>(a.y - b.y, a.x - b.x), n = <span class="built_in">atan2</span>(c.y - b.y, c.x - b.x);</span><br><span class="line">        v.e = v.s + Point(<span class="built_in">cos</span>((n + m) / <span class="number">2</span>), <span class="built_in">sin</span>((n + m) / <span class="number">2</span>));</span><br><span class="line">        p = u.crosspoint(v);</span><br><span class="line">        r = Line(a, b).dispointtoseg(p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//输入</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        p.input();</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//输出</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.2lf␣%.2lf␣%.2lf\n&quot;</span>, p.x, p.y, r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>==(circle v) &#123;</span><br><span class="line">        <span class="keyword">return</span> (p == v.p) &amp;&amp; sgn(r - v.r) == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(circle v) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ((p &lt; v.p) || ((p == v.p) &amp;&amp; sgn(r - v.r) &lt; <span class="number">0</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//面积</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">area</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> pi * r * r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//周长</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">circumference</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span> * pi * r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//点和圆的关系</span></span><br><span class="line">    <span class="comment">// 0 圆外</span></span><br><span class="line">    <span class="comment">// 1 圆上</span></span><br><span class="line">    <span class="comment">// 2 圆内</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">relation</span><span class="params">(Point b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> dst = b.distance(p);</span><br><span class="line">        <span class="keyword">if</span> (sgn(dst - r) &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (sgn(dst - r) == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//线段和圆的关系</span></span><br><span class="line">    <span class="comment">//比较的是圆心到线段的距离和半径的关系</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">relationseg</span><span class="params">(Line v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> dst = v.dispointtoseg(p);</span><br><span class="line">        <span class="keyword">if</span> (sgn(dst - r) &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (sgn(dst - r) == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//直线和圆的关系</span></span><br><span class="line">    <span class="comment">//比较的是圆心到直线的距离和半径的关系</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">relationline</span><span class="params">(Line v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> dst = v.dispointtoline(p);</span><br><span class="line">        <span class="keyword">if</span> (sgn(dst - r) &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (sgn(dst - r) == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//两圆的关系</span></span><br><span class="line">    <span class="comment">// 5 相离</span></span><br><span class="line">    <span class="comment">// 4 外切</span></span><br><span class="line">    <span class="comment">// 3 相交</span></span><br><span class="line">    <span class="comment">// 2 内切</span></span><br><span class="line">    <span class="comment">// 1 内含</span></span><br><span class="line">    <span class="comment">//需要 Point 的 distance</span></span><br><span class="line">    <span class="comment">//测试：UVA12304</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">relationcircle</span><span class="params">(circle v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> d = p.distance(v.p);</span><br><span class="line">        <span class="keyword">if</span> (sgn(d - r - v.r) &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">if</span> (sgn(d - r - v.r) == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">double</span> l = <span class="built_in">fabs</span>(r - v.r);</span><br><span class="line">        <span class="keyword">if</span> (sgn(d - r - v.r) &lt; <span class="number">0</span> &amp;&amp; sgn(d - l) &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">if</span> (sgn(d - l) == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (sgn(d - l) &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//求两个圆的交点，返回 0 表示没有交点，返回 1 是一个交点，2 是两个交点</span></span><br><span class="line">    <span class="comment">//需要 relationcircle</span></span><br><span class="line">    <span class="comment">//测试：UVA12304</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">pointcrosscircle</span><span class="params">(circle v, Point &amp;p1, Point &amp;p2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rel = relationcircle(v);</span><br><span class="line">        <span class="keyword">if</span> (rel == <span class="number">1</span> || rel == <span class="number">5</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">double</span> d = p.distance(v.p);</span><br><span class="line">        <span class="keyword">double</span> l = (d * d + r * r - v.r * v.r) / (<span class="number">2</span> * d);</span><br><span class="line">        <span class="keyword">double</span> h = <span class="built_in">sqrt</span>(r * r - l * l);</span><br><span class="line">        Point tmp = p + (v.p - p).trunc(l);</span><br><span class="line">        p1 = tmp + ((v.p - p).rotleft().trunc(h));</span><br><span class="line">        p2 = tmp + ((v.p - p).rotright().trunc(h));</span><br><span class="line">        <span class="keyword">if</span> (rel == <span class="number">2</span> || rel == <span class="number">4</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//求直线和圆的交点，返回交点个数</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">pointcrossline</span><span class="params">(Line v, Point &amp;p1, Point &amp;p2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!(*<span class="keyword">this</span>).relationline(v)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        Point a = v.lineprog(p);</span><br><span class="line">        <span class="keyword">double</span> d = v.dispointtoline(p);</span><br><span class="line">        d = <span class="built_in">sqrt</span>(r * r - d * d);</span><br><span class="line">        <span class="keyword">if</span> (sgn(d) == <span class="number">0</span>) &#123;</span><br><span class="line">            p1 = a;</span><br><span class="line">            p2 = a;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        p1 = a + (v.e - v.s).trunc(d);</span><br><span class="line">        p2 = a - (v.e - v.s).trunc(d);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//得到过 a,b 两点，半径为 r1 的两个圆</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">gercircle</span><span class="params">(Point a, Point b, <span class="keyword">double</span> r1, circle &amp;c1, circle &amp;c2)</span> </span>&#123;</span><br><span class="line">        circle x(a, r1), y(b, r1);</span><br><span class="line">        <span class="keyword">int</span> t = x.pointcrosscircle(y, c1.p, c2.p);</span><br><span class="line">        <span class="keyword">if</span> (!t) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        c1.r = c2.r = r;</span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//得到与直线 u 相切，过点 q, 半径为 r1 的圆</span></span><br><span class="line">    <span class="comment">//测试：UVA12304</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getcircle</span><span class="params">(Line u, Point q, <span class="keyword">double</span> r1, circle &amp;c1, circle &amp;c2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> dis = u.dispointtoline(q);</span><br><span class="line">        <span class="keyword">if</span> (sgn(dis - r1 * <span class="number">2</span>) &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (sgn(dis) == <span class="number">0</span>) &#123;</span><br><span class="line">            c1.p = q + ((u.e - u.s).rotleft().trunc(r1));</span><br><span class="line">            c2.p = q + ((u.e - u.s).rotright().trunc(r1));</span><br><span class="line">            c1.r = c2.r = r1;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Line u1 = Line((u.s + (u.e - u.s).rotleft().trunc(r1)), (u.e + (u.e - u.s).rotleft().trunc(r1)));</span><br><span class="line">        Line u2 = Line((u.s + (u.e - u.s).rotright().trunc(r1)), (u.e + (u.e - u.s).rotright().trunc(r1)));</span><br><span class="line">        circle cc = circle(q, r1);</span><br><span class="line">        Point p1, p2;</span><br><span class="line">        <span class="keyword">if</span> (!cc.pointcrossline(u1, p1, p2)) cc.pointcrossline(u2, p1, p2);</span><br><span class="line">        c1 = circle(p1, r1);</span><br><span class="line">        <span class="keyword">if</span> (p1 == p2) &#123;</span><br><span class="line">            c2 = c1;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        c2 = circle(p2, r1);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//同时与直线 u,v 相切，半径为 r1 的圆</span></span><br><span class="line">    <span class="comment">//测试：UVA12304</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getcircle</span><span class="params">(Line u, Line v, <span class="keyword">double</span> r1, circle &amp;c1, circle &amp;c2, circle &amp;c3, circle &amp;c4)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u.parallel(v)) <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">//两直线平行</span></span><br><span class="line">        Line u1 = Line(u.s + (u.e - u.s).rotleft().trunc(r1), u.e + (u.e - u.s).rotleft().trunc(r1));</span><br><span class="line">        Line u2 = Line(u.s + (u.e - u.s).rotright().trunc(r1), u.e + (u.e - u.s).rotright().trunc(r1));</span><br><span class="line">        Line v1 = Line(v.s + (v.e - v.s).rotleft().trunc(r1), v.e + (v.e - v.s).rotleft().trunc(r1));</span><br><span class="line">        Line v2 = Line(v.s + (v.e - v.s).rotright().trunc(r1), v.e + (v.e - v.s).rotright().trunc(r1));</span><br><span class="line">        c1.r = c2.r = c3.r = c4.r = r1;</span><br><span class="line">        c1.p = u1.crosspoint(v1);</span><br><span class="line">        c2.p = u1.crosspoint(v2);</span><br><span class="line">        c3.p = u2.crosspoint(v1);</span><br><span class="line">        c4.p = u2.crosspoint(v2);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//同时与不相交圆 cx,cy 相切，半径为 r1 的圆</span></span><br><span class="line">    <span class="comment">//测试：UVA12304</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getcircle</span><span class="params">(circle cx, circle cy, <span class="keyword">double</span> r1, circle &amp;c1, circle &amp;c2)</span> </span>&#123;</span><br><span class="line">        circle x(cx.p, r1 + cx.r), y(cy.p, r1 + cy.r);</span><br><span class="line">        <span class="keyword">int</span> t = x.pointcrosscircle(y, c1.p, c2.p);</span><br><span class="line">        <span class="keyword">if</span> (!t) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        c1.r = c2.r = r1;</span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">//过一点作圆的切线 (先判断点和圆的关系)</span></span><br><span class="line">    <span class="comment">//测试：UVA12304</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">tangentline</span><span class="params">(Point q, Line &amp;u, Line &amp;v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x = relation(q);</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="number">2</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="number">1</span>) &#123;</span><br><span class="line">            u = Line(q, q + (q - p).rotleft());</span><br><span class="line">            v = u;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">double</span> d = p.distance(q);</span><br><span class="line">        <span class="keyword">double</span> l = r * r / d;</span><br><span class="line">        <span class="keyword">double</span> h = <span class="built_in">sqrt</span>(r * r - l * l);</span><br><span class="line">        u = Line(q, p + ((q - p).trunc(l) + (q - p).rotleft().trunc(h)));</span><br><span class="line">        v = Line(q, p + ((q - p).trunc(l) + (q - p).rotright().trunc(h)));</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//求两圆相交的面积</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">areacircle</span><span class="params">(circle v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rel = relationcircle(v);</span><br><span class="line">        <span class="keyword">if</span> (rel &gt;= <span class="number">4</span>) <span class="keyword">return</span> <span class="number">0.0</span>;</span><br><span class="line">        <span class="keyword">if</span> (rel &lt;= <span class="number">2</span>) <span class="keyword">return</span> min(area(), v.area());</span><br><span class="line">        <span class="keyword">double</span> d = p.distance(v.p);</span><br><span class="line">        <span class="keyword">double</span> hf = (r + v.r + d) / <span class="number">2.0</span>;</span><br><span class="line">        <span class="keyword">double</span> ss = <span class="number">2</span> * <span class="built_in">sqrt</span>(hf * (hf - r) * (hf - v.r) * (hf - d));</span><br><span class="line">        <span class="keyword">double</span> a1 = <span class="built_in">acos</span>((r * r + d * d - v.r * v.r) / (<span class="number">2.0</span> * r * d));</span><br><span class="line">        a1 = a1 * r * r;</span><br><span class="line">        <span class="keyword">double</span> a2 = <span class="built_in">acos</span>((v.r * v.r + d * d - r * r) / (<span class="number">2.0</span> * v.r * d));</span><br><span class="line">        a2 = a2 * v.r * v.r;</span><br><span class="line">        <span class="keyword">return</span> a1 + a2 - ss;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//求圆和三角形 pab 的相交面积</span></span><br><span class="line">    <span class="comment">//测试：POJ3675 HDU3982 HDU2892</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">areatriangle</span><span class="params">(Point a, Point b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (sgn((p - a) ^ (p - b)) == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0.0</span>;</span><br><span class="line">        Point q[<span class="number">5</span>];</span><br><span class="line">        <span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">        q[len++] = a;</span><br><span class="line">        <span class="function">Line <span class="title">l</span><span class="params">(a, b)</span></span>;</span><br><span class="line">        Point p1, p2;</span><br><span class="line">        <span class="keyword">if</span> (pointcrossline(l, q[<span class="number">1</span>], q[<span class="number">2</span>]) == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (sgn((a - q[<span class="number">1</span>]) * (b - q[<span class="number">1</span>])) &lt; <span class="number">0</span>) q[len++] = q[<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span> (sgn((a - q[<span class="number">2</span>]) * (b - q[<span class="number">2</span>])) &lt; <span class="number">0</span>) q[len++] = q[<span class="number">2</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        q[len++] = b;</span><br><span class="line">        <span class="keyword">if</span> (len == <span class="number">4</span> &amp;&amp; sgn((q[<span class="number">0</span>] - q[<span class="number">1</span>]) * (q[<span class="number">2</span>] - q[<span class="number">1</span>])) &gt; <span class="number">0</span>) swap(q[<span class="number">1</span>], q[<span class="number">2</span>]);</span><br><span class="line">        <span class="keyword">double</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (relation(q[i]) == <span class="number">0</span> || relation(q[i + <span class="number">1</span>]) == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">double</span> arg = p.rad(q[i], q[i + <span class="number">1</span>]);</span><br><span class="line">                res += r * r * arg / <span class="number">2.0</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                res += <span class="built_in">fabs</span>((q[i] - p) ^ (q[i + <span class="number">1</span>] - p)) / <span class="number">2.0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">  </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * n,p Line l for each side</span></span><br><span class="line"><span class="comment"> * input(int _n) - inputs _n size polygon</span></span><br><span class="line"><span class="comment"> * add(Point q) - adds a point at end of the list</span></span><br><span class="line"><span class="comment"> * getline() - populates line array</span></span><br><span class="line"><span class="comment"> * cmp - comparision in convex_hull order</span></span><br><span class="line"><span class="comment"> * norm() - sorting in convex_hull order</span></span><br><span class="line"><span class="comment"> * getconvex(polygon &amp;convex) - returns convex hull in convex</span></span><br><span class="line"><span class="comment"> * Graham(polygon &amp;convex) - returns convex hull in convex</span></span><br><span class="line"><span class="comment"> * isconvex() - checks if convex</span></span><br><span class="line"><span class="comment"> * relationpoint(Point q) - returns 3 if q is a vertex</span></span><br><span class="line"><span class="comment"> * 2 if on a side</span></span><br><span class="line"><span class="comment"> * 1 if inside</span></span><br><span class="line"><span class="comment"> * 0 if outside</span></span><br><span class="line"><span class="comment"> * convexcut(Line u,polygon &amp;po) - left side of u in po</span></span><br><span class="line"><span class="comment"> * gercircumference() - returns side length</span></span><br><span class="line"><span class="comment"> * getarea() - returns area</span></span><br><span class="line"><span class="comment"> * getdir() - returns 0 for cw, 1 for ccw</span></span><br><span class="line"><span class="comment"> * getbarycentre() - returns barycenter</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">  </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">polygon</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    Point p[maxp];</span><br><span class="line">    Line l[maxp];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">(<span class="keyword">int</span> _n)</span> </span>&#123;</span><br><span class="line">        n = _n;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) p[i].input();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(Point q)</span> </span>&#123;</span><br><span class="line">        p[n++] = q;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getline</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            l[i] = Line(p[i], p[(i + <span class="number">1</span>) % n]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">cmp</span> &#123;</span></span><br><span class="line">        Point p;</span><br><span class="line">        cmp(<span class="keyword">const</span> Point &amp;p0) &#123;</span><br><span class="line">            p = p0;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">const</span> Point &amp;aa, <span class="keyword">const</span> Point &amp;bb)</span> </span>&#123;</span><br><span class="line">            Point a = aa, b = bb;</span><br><span class="line">            <span class="keyword">int</span> d = sgn((a - p) ^ (b - p));</span><br><span class="line">            <span class="keyword">if</span> (d == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> sgn(a.distance(p) - b.distance(p)) &lt; <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> d &gt; <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//进行极角排序</span></span><br><span class="line">    <span class="comment">//首先需要找到最左下角的点</span></span><br><span class="line">    <span class="comment">//需要重载号好 Point 的 &lt; 操作符 (min 函数要用)</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">norm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Point mi = p[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) mi = min(mi, p[i]);</span><br><span class="line">        sort(p, p + n, cmp(mi));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//得到凸包</span></span><br><span class="line">    <span class="comment">//得到的凸包里面的点编号是 0 ∼ n-1 的</span></span><br><span class="line">    <span class="comment">//两种凸包的方法</span></span><br><span class="line">    <span class="comment">//注意如果有影响，要特判下所有点共点，或者共线的特殊情况</span></span><br><span class="line">    <span class="comment">//测试 LightOJ1203 LightOJ1239</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getconvex</span><span class="params">(polygon &amp;convex)</span> </span>&#123;</span><br><span class="line">        sort(p, p + n);</span><br><span class="line">        convex.n = n;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; min(n, <span class="number">2</span>); i++) &#123;</span><br><span class="line">            convex.p[i] = p[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (convex.n == <span class="number">2</span> &amp;&amp; (convex.p[<span class="number">0</span>] == convex.p[<span class="number">1</span>])) convex.n--; <span class="comment">//特判</span></span><br><span class="line">        <span class="keyword">if</span> (n &lt;= <span class="number">2</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">int</span> &amp;top = convex.n;</span><br><span class="line">        top = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">while</span> (top &amp;&amp; sgn((convex.p[top] - p[i]) ^ (convex.p[top - <span class="number">1</span>] - p[i])) &lt;= <span class="number">0</span>) top--;</span><br><span class="line">            convex.p[++top] = p[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> temp = top;</span><br><span class="line">        convex.p[++top] = p[n - <span class="number">2</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">3</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="keyword">while</span> (top != temp &amp;&amp; sgn((convex.p[top] - p[i]) ^ (convex.p[top - <span class="number">1</span>] - p[i])) &lt;= <span class="number">0</span>) top--;</span><br><span class="line">            convex.p[++top] = p[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (convex.n == <span class="number">2</span> &amp;&amp; (convex.p[<span class="number">0</span>] == convex.p[<span class="number">1</span>])) convex.n--; <span class="comment">//特判</span></span><br><span class="line">        convex.norm(); <span class="comment">//原来得到的是顺时针的点，排序后逆时针</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//得到凸包的另外一种方法</span></span><br><span class="line">    <span class="comment">//测试 LightOJ1203 LightOJ1239</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Graham</span><span class="params">(polygon &amp;convex)</span> </span>&#123;</span><br><span class="line">        norm();</span><br><span class="line">        <span class="keyword">int</span> &amp;top = convex.n;</span><br><span class="line">        top = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">            top = <span class="number">1</span>;</span><br><span class="line">            convex.p[<span class="number">0</span>] = p[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">2</span>) &#123;</span><br><span class="line">            top = <span class="number">2</span>;</span><br><span class="line">            convex.p[<span class="number">0</span>] = p[<span class="number">0</span>];</span><br><span class="line">            convex.p[<span class="number">1</span>] = p[<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span> (convex.p[<span class="number">0</span>] == convex.p[<span class="number">1</span>]) top--;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        convex.p[<span class="number">0</span>] = p[<span class="number">0</span>];</span><br><span class="line">        convex.p[<span class="number">1</span>] = p[<span class="number">1</span>];</span><br><span class="line">        top = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">while</span> (top &gt; <span class="number">1</span> &amp;&amp; sgn((convex.p[top - <span class="number">1</span>] - convex.p[top - <span class="number">2</span>]) ^ (p[i] - convex.p[top - <span class="number">2</span>])) &lt;= <span class="number">0</span>) top--;</span><br><span class="line">            convex.p[top++] = p[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (convex.n == <span class="number">2</span> &amp;&amp; (convex.p[<span class="number">0</span>] == convex.p[<span class="number">1</span>])) convex.n--; <span class="comment">//特判</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//判断是不是凸的</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isconvex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">bool</span> s[<span class="number">2</span>];</span><br><span class="line">        <span class="built_in">memset</span>(s, <span class="literal">false</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> j = (i + <span class="number">1</span>) % n;</span><br><span class="line">            <span class="keyword">int</span> k = (j + <span class="number">1</span>) % n;</span><br><span class="line">            s[sgn((p[j] - p[i]) ^ (p[k] - p[i])) + <span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (s[<span class="number">0</span>] &amp;&amp; s[<span class="number">2</span>]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//判断点和任意多边形的关系</span></span><br><span class="line">    <span class="comment">// 3 点上</span></span><br><span class="line">    <span class="comment">// 2 边上</span></span><br><span class="line">    <span class="comment">// 1 内部</span></span><br><span class="line">    <span class="comment">// 0 外部</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">relationpoint</span><span class="params">(Point q)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (p[i] == q) <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        getline();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (l[i].pointonseg(q)) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> j = (i + <span class="number">1</span>) % n;</span><br><span class="line">            <span class="keyword">int</span> k = sgn((q - p[j]) ^ (p[i] - p[j]));</span><br><span class="line">            <span class="keyword">int</span> u = sgn(p[i].y - q.y);</span><br><span class="line">            <span class="keyword">int</span> v = sgn(p[j].y - q.y);</span><br><span class="line">            <span class="keyword">if</span> (k &gt; <span class="number">0</span> &amp;&amp; u &lt; <span class="number">0</span> &amp;&amp; v &gt;= <span class="number">0</span>) cnt++;</span><br><span class="line">            <span class="keyword">if</span> (k &lt; <span class="number">0</span> &amp;&amp; v &lt; <span class="number">0</span> &amp;&amp; u &gt;= <span class="number">0</span>) cnt--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cnt != <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//直线 u 切割凸多边形左侧</span></span><br><span class="line">    <span class="comment">//注意直线方向</span></span><br><span class="line">    <span class="comment">//测试：HDU3982</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">convexcut</span><span class="params">(Line u, polygon &amp;po)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> &amp;top = po.n; <span class="comment">//注意引用</span></span><br><span class="line">        top = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> d1 = sgn((u.e - u.s) ^ (p[i] - u.s));</span><br><span class="line">            <span class="keyword">int</span> d2 = sgn((u.e - u.s) ^ (p[(i + <span class="number">1</span>) % n] - u.s));</span><br><span class="line">            <span class="keyword">if</span> (d1 &gt;= <span class="number">0</span>) po.p[top++] = p[i];</span><br><span class="line">            <span class="keyword">if</span> (d1 * d2 &lt; <span class="number">0</span>) po.p[top++] = u.crosspoint(Line(p[i], p[(i + <span class="number">1</span>) % n]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//得到周长</span></span><br><span class="line">    <span class="comment">//测试 LightOJ1239</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getcircumference</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            sum += p[i].distance(p[(i + <span class="number">1</span>) % n]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//得到面积面积</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getarea</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            sum += (p[i] ^ p[(i + <span class="number">1</span>) % n]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">fabs</span>(sum) / <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//得到方向</span></span><br><span class="line">    <span class="comment">// 1 表示逆时针，0 表示顺时针</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">getdir</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) sum += (p[i] ^ p[(i + <span class="number">1</span>) % n]);</span><br><span class="line">        <span class="keyword">if</span> (sgn(sum) &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//得到重心</span></span><br><span class="line">    <span class="function">Point <span class="title">getbarycentre</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="function">Point <span class="title">ret</span><span class="params">(<span class="number">0</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">double</span> area = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">double</span> tmp = (p[i] - p[<span class="number">0</span>]) ^ (p[i + <span class="number">1</span>] - p[<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">if</span> (sgn(tmp) == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">            area += tmp;</span><br><span class="line">            ret.x += (p[<span class="number">0</span>].x + p[i].x + p[i + <span class="number">1</span>].x) / <span class="number">3</span> * tmp;</span><br><span class="line">            ret.y += (p[<span class="number">0</span>].y + p[i].y + p[i + <span class="number">1</span>].y) / <span class="number">3</span> * tmp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (sgn(area)) ret = ret / area;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//多边形和圆交的面积</span></span><br><span class="line">    <span class="comment">//测试：POJ3675 HDU3982 HDU2892</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">areacircle</span><span class="params">(circle c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> j = (i + <span class="number">1</span>) % n;</span><br><span class="line">            <span class="keyword">if</span> (sgn((p[j] - c.p) ^ (p[i] - c.p)) &gt;= <span class="number">0</span>)</span><br><span class="line">                ans += c.areatriangle(p[i], p[j]);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                ans -= c.areatriangle(p[i], p[j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">fabs</span>(ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//多边形和圆关系</span></span><br><span class="line">    <span class="comment">// 2 圆完全在多边形内</span></span><br><span class="line">    <span class="comment">// 1 圆在多边形里面，碰到了多边形边界</span></span><br><span class="line">    <span class="comment">// 0 其它</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">relationcircle</span><span class="params">(circle c)</span> </span>&#123;</span><br><span class="line">        getline();</span><br><span class="line">        <span class="keyword">int</span> x = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (relationpoint(c.p) != <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">//圆心不在内部</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (c.relationseg(l[i]) == <span class="number">2</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (c.relationseg(l[i]) == <span class="number">1</span>) x = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// AB X AC</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">cross</span><span class="params">(Point A, Point B, Point C)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (B - A) ^ (C - A);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// AB*AC</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">dot</span><span class="params">(Point A, Point B, Point C)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (B - A) * (C - A);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//最小矩形面积覆盖</span></span><br><span class="line"><span class="comment">// A 必须是凸包 (而且是逆时针顺序)</span></span><br><span class="line"><span class="comment">// 测试 UVA 10173</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">minRectangleCover</span><span class="params">(polygon A)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//要特判 A.n &lt; 3 的情况</span></span><br><span class="line">    <span class="keyword">if</span> (A.n &lt; <span class="number">3</span>) <span class="keyword">return</span> <span class="number">0.0</span>;</span><br><span class="line">    A.p[A.n] = A.p[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">double</span> ans = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">int</span> r = <span class="number">1</span>, p = <span class="number">1</span>, q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; A.n; i++) &#123;</span><br><span class="line">        <span class="comment">//卡出离边 A.p[i] - A.p[i+1] 最远的点</span></span><br><span class="line">        <span class="keyword">while</span> (sgn(cross(A.p[i], A.p[i + <span class="number">1</span>], A.p[r + <span class="number">1</span>]) - cross(A.p[i], A.p[i + <span class="number">1</span>], A.p[r])) &gt;= <span class="number">0</span>) r = (r + <span class="number">1</span>) % A.n;</span><br><span class="line">        <span class="comment">//卡出 A.p[i] - A.p[i+1] 方向上正向 n 最远的点</span></span><br><span class="line">        <span class="keyword">while</span> (sgn(dot(A.p[i], A.p[i + <span class="number">1</span>], A.p[p + <span class="number">1</span>]) - dot(A.p[i], A.p[i + <span class="number">1</span>], A.p[p])) &gt;= <span class="number">0</span>) p = (p + <span class="number">1</span>) % A.n;</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">0</span>) q = p;</span><br><span class="line">        <span class="comment">//卡出 A.p[i] - A.p[i+1] 方向上负向最远的点</span></span><br><span class="line">        <span class="keyword">while</span> (sgn(dot(A.p[i], A.p[i + <span class="number">1</span>], A.p[q + <span class="number">1</span>]) - dot(A.p[i], A.p[i + <span class="number">1</span>], A.p[q])) &lt;= <span class="number">0</span>) q = (q + <span class="number">1</span>) % A.n;</span><br><span class="line">        <span class="keyword">double</span> d = (A.p[i] - A.p[i + <span class="number">1</span>]).len2();</span><br><span class="line">        <span class="keyword">double</span> tmp = cross(A.p[i], A.p[i + <span class="number">1</span>], A.p[r]) * (dot(A.p[i], A.p[i + <span class="number">1</span>], A.p[p]) - dot(A.p[i], A.p[i + <span class="number">1</span>], A.p[q])) / d;</span><br><span class="line">        <span class="keyword">if</span> (ans &lt; <span class="number">0</span> || ans &gt; tmp) ans = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="comment">//直线切凸多边形</span></span><br><span class="line"><span class="comment">//多边形是逆时针的，在 q1q2 的左侧</span></span><br><span class="line"><span class="comment">//测试:HDU3982</span></span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;Point&gt; <span class="title">convexCut</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;Point&gt; &amp;ps, Point q1, Point q2)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;Point&gt; qs;</span><br><span class="line">    <span class="keyword">int</span> n = ps.size();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        Point p1 = ps[i], p2 = ps[(i + <span class="number">1</span>) % n];</span><br><span class="line">        <span class="keyword">int</span> d1 = sgn((q2 - q1) ^ (p1 - q1)), d2 = sgn((q2 - q1) ^ (p2 - q1));</span><br><span class="line">        <span class="keyword">if</span> (d1 &gt;= <span class="number">0</span>) qs.push_back(p1);</span><br><span class="line">        <span class="keyword">if</span> (d1 * d2 &lt; <span class="number">0</span>) qs.push_back(Line(p1, p2).crosspoint(Line(q1, q2)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> qs;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">double</span> l = <span class="number">0.00001</span>, r = <span class="number">3000</span>;</span><br><span class="line"><span class="keyword">double</span> cx, cy;</span><br><span class="line">polygon P, P2;</span><br><span class="line"><span class="keyword">double</span> p, q;</span><br><span class="line"><span class="keyword">double</span> area;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">slove</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lf%lf&quot;</span>, &amp;cx, &amp;cy);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lf%lf&quot;</span>, &amp;p, &amp;q);</span><br><span class="line">    <span class="keyword">double</span> a = area * (q - p) / q;</span><br><span class="line">    <span class="comment">// cout &lt;&lt; &quot;a==&quot; &lt;&lt; a &lt;&lt; endl;</span></span><br><span class="line">  </span><br><span class="line">    l = <span class="number">0.00001</span>, r = <span class="number">3000</span>;</span><br><span class="line">    <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">        <span class="keyword">double</span> mid = (l + r) / <span class="number">2.0</span>;</span><br><span class="line">        <span class="function">circle <span class="title">c</span><span class="params">(cx, cy, mid)</span></span>;</span><br><span class="line">        <span class="keyword">double</span> res = P.areacircle(c);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">fabs</span>(res - a) &lt; eps) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%.8f\n&quot;</span>, mid);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (res &lt; a) &#123;</span><br><span class="line">            l = mid;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            r = mid;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e8</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">32767</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    P.input(n);</span><br><span class="line">    area = P.getarea();</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</span><br><span class="line">    <span class="comment">// cout &lt;&lt; &quot;area==&quot; &lt;&lt; area &lt;&lt; endl;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i) &#123;</span><br><span class="line">        slove();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-09-05T10:43:09.000Z" title="2018-09-05T10:43:09.000Z">2018-09-05</time>发表</span><span class="level-item"><time dateTime="2018-09-05T14:37:46.765Z" title="2018-09-05T14:37:46.765Z">2018-09-05</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/acm/">acm</a></span><span class="level-item">5 分钟读完 (大约740个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/acm/2018/09/05/nowcoder3-%E8%A1%A5%E9%A2%98%E5%90%91.html">[nowcoder3]补题向</a></h1><div class="content"><h2 id="J-Coloring-Tree"><a href="#J-Coloring-Tree" class="headerlink" title="J.Coloring Tree"></a>J.Coloring Tree</h2><h3 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h3><p>给一棵树，每个节点从$[1,k]$选择一种颜色染。定义树的颜色值为两个相同颜色节点之间的最小值。问如果一棵树的颜色值为$D$，那么它有多少种染色方式。</p>
<h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><blockquote>
<p>Reference:<a target="_blank" rel="noopener" href="https://www.nowcoder.com/discuss/88556?type=101&amp;order=0&amp;pos=1&amp;page=1">https://www.nowcoder.com/discuss/88556?type=101&amp;order=0&amp;pos=1&amp;page=1</a></p>
</blockquote>
<h3 id="本地能过就是能过"><a href="#本地能过就是能过" class="headerlink" title="本地能过就是能过"></a>本地能过就是能过</h3><p>谁能知道我为啥超时10%有重赏</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n,k,D,tot;</span><br><span class="line"><span class="keyword">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> next,to;</span><br><span class="line">&#125;G[maxn&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> head[maxn],vis[maxn],cnt[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    G[tot].to = v;</span><br><span class="line">    G[tot].next = head[u];</span><br><span class="line">    head[u] = tot++;</span><br><span class="line">&#125;</span><br><span class="line">ll ans = <span class="number">1</span>;</span><br><span class="line"><span class="function">ll <span class="title">pow3</span><span class="params">(ll a,ll b)</span></span>&#123;</span><br><span class="line">    ll res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) res = res*a%mod;</span><br><span class="line">        a = a*a%mod;</span><br><span class="line">        b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> ds)</span></span>&#123;</span><br><span class="line">    <span class="built_in">queue</span>&lt;pII&gt; q;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    q.push(<span class="built_in">make_pair</span>(rt,<span class="number">0</span>));vis[rt] = rt; ans = cnt[rt]%mod;</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> u = q.front().fi; <span class="keyword">int</span> d = q.front().se; q.pop();</span><br><span class="line">        <span class="keyword">if</span>(d &gt;= ds) <span class="keyword">break</span>;</span><br><span class="line">        cnt[u]--;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u];~i;i=G[i].next)&#123;</span><br><span class="line">            <span class="keyword">int</span> v = G[i].to;</span><br><span class="line">            <span class="keyword">if</span>(vis[v]==rt) <span class="keyword">continue</span>;</span><br><span class="line">            vis[v] = rt;</span><br><span class="line">            q.push(<span class="built_in">make_pair</span>(v,d+<span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c=getchar();</span><br><span class="line">    <span class="keyword">bool</span> flag=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(c&lt;<span class="string">&#x27;0&#x27;</span>||c&gt;<span class="string">&#x27;9&#x27;</span>)&#123;<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>)flag=<span class="number">1</span>;   c=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(c&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;c&lt;=<span class="string">&#x27;9&#x27;</span>)&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+c-<span class="string">&#x27;0&#x27;</span>;c=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> flag?-x:x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;j.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;n,&amp;k,&amp;D);</span><br><span class="line">    rep(i,<span class="number">0</span>,n<span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="keyword">int</span> u,v; u =read();v= read();</span><br><span class="line">        add(u,v); add(v,u);</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans1 = <span class="number">1</span>,ans2 = <span class="number">1</span>;</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>) cnt[i] = k;</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt;q;</span><br><span class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</span><br><span class="line">    q.push(<span class="number">1</span>);<span class="keyword">int</span> sign[maxn]=&#123;<span class="number">0</span>&#125;;sign[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> u = q.front();q.pop();</span><br><span class="line">        ans1 = ans1*bfs(u,D)%mod;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i= head[u];~i;i=G[i].next)&#123;</span><br><span class="line">            <span class="keyword">int</span> v = G[i].to;</span><br><span class="line">            <span class="keyword">if</span>(sign[v]) <span class="keyword">continue</span>;</span><br><span class="line">            sign[v] = <span class="number">1</span>;</span><br><span class="line">            q.push(v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>) cnt[i] = k;</span><br><span class="line">    <span class="built_in">memset</span>(sign,<span class="number">0</span>,<span class="keyword">sizeof</span>(sign));</span><br><span class="line">    q.push(<span class="number">1</span>); sign[<span class="number">1</span>] =<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> u = q.front();q.pop();</span><br><span class="line">        ans2 = ans2*bfs(u,D+<span class="number">1</span>)%mod;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i= head[u];~i;i=G[i].next)&#123;</span><br><span class="line">            <span class="keyword">int</span> v = G[i].to;</span><br><span class="line">            <span class="keyword">if</span>(sign[v]) <span class="keyword">continue</span>;</span><br><span class="line">            sign[v] = <span class="number">1</span>;</span><br><span class="line">            q.push(v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,(ans1-ans2+mod)%mod);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="真丶AC代码"><a href="#真丶AC代码" class="headerlink" title="真丶AC代码"></a>真丶AC代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n,k,D,tot;</span><br><span class="line"><span class="keyword">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> next,to;</span><br><span class="line">&#125;G[maxn&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> head[maxn],vis[maxn],cnt[maxn],dis[maxn][maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    G[tot].to = v;</span><br><span class="line">    G[tot].next = head[u];</span><br><span class="line">    head[u] = tot++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> fa,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[u];~i;i=G[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> v = G[i].to;</span><br><span class="line">        <span class="keyword">if</span>(v == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dis[v][rt] = dis[u][rt]+<span class="number">1</span>;</span><br><span class="line">        dfs(v,u,rt);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">(<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt;q;</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>) cnt[i] = k;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    q.push(<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> u = q.front();q.pop();</span><br><span class="line">        ll res = <span class="number">0</span>;</span><br><span class="line">        rep(v,<span class="number">1</span>,n+<span class="number">1</span>) <span class="keyword">if</span>(v!=u) cnt[v] -= (dis[u][v]&lt;d);</span><br><span class="line">        <span class="keyword">if</span>(cnt[u] &lt;= <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        ans = ans*cnt[u]%mod;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=head[u];~i;i=G[i].next)&#123;</span><br><span class="line">            <span class="keyword">int</span> v = G[i].to;</span><br><span class="line">            <span class="keyword">if</span>(dis[<span class="number">1</span>][u]+<span class="number">1</span> == dis[<span class="number">1</span>][v])&#123;</span><br><span class="line">                q.push(v);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c=getchar();</span><br><span class="line">    <span class="keyword">bool</span> flag=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(c&lt;<span class="string">&#x27;0&#x27;</span>||c&gt;<span class="string">&#x27;9&#x27;</span>)&#123;<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>)flag=<span class="number">1</span>;   c=getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(c&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;c&lt;=<span class="string">&#x27;9&#x27;</span>)&#123;x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+c-<span class="string">&#x27;0&#x27;</span>;c=getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> flag?-x:x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;j.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;n,&amp;k,&amp;D);</span><br><span class="line">    rep(i,<span class="number">0</span>,n<span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="keyword">int</span> u,v; u = read(); v = read();</span><br><span class="line">        add(u,v); add(v,u);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>) dfs(i,<span class="number">-1</span>,i);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,(solve(D)-solve(D+<span class="number">1</span>)+mod)%mod);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-09-03T12:00:44.000Z" title="2018-09-03T12:00:44.000Z">2018-09-03</time>发表</span><span class="level-item"><time dateTime="2018-09-03T12:18:47.629Z" title="2018-09-03T12:18:47.629Z">2018-09-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%A8%A1%E6%9D%BF/">模板</a></span><span class="level-item">3 分钟读完 (大约465个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/%E6%A8%A1%E6%9D%BF/2018/09/03/%E5%9B%9E%E6%96%87%E6%A0%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html">回文树学习笔记</a></h1><div class="content"><h1 id="回文树学习笔记"><a href="#回文树学习笔记" class="headerlink" title="回文树学习笔记"></a>回文树学习笔记</h1><h2 id="神奇的数据结构-Palindromic-Tree-回文树"><a href="#神奇的数据结构-Palindromic-Tree-回文树" class="headerlink" title="神奇的数据结构 Palindromic Tree 回文树"></a>神奇的数据结构 Palindromic Tree 回文树</h2><h3 id="功能简介"><a href="#功能简介" class="headerlink" title="功能简介"></a>功能简介</h3><ol>
<li>求一个串$S$中$[0,i]$中本质不同回文串的个数</li>
<li>求串$S$中每一个本质不同回文串出现的次数</li>
<li>求指定下标$i$结尾的回文串的个数</li>
</ol>
<h3 id="变量简介"><a href="#变量简介" class="headerlink" title="变量简介"></a>变量简介</h3><ol>
<li>$len[i]$表示编号为$i$节点所表示的回文串的$len$。</li>
<li>$next[i][c]$表示编号为$i$的节点表示的回文串在两边添加字符$c$之后会变成的回文串的编号。</li>
<li>$fail[i]$表示节点$i$失配以后跳转后不等于自己的节点$i$所表示的回稳产的最长长度。</li>
<li>$cnt[i]$表示节点$i$表示的本质不同的串的个数。</li>
<li>$num[i]$表示以节点$i$表示的最长回文串的最右端点为回文串结尾的回文串个数。</li>
<li>$last$指向新添加一个字母后所形成的最长回文串表示的节点。</li>
<li>$S[i]$表示第$i$次添加的字符(初始化S[0]=不存在的字符)。</li>
<li>$p$表示添加的节点个数。</li>
<li>$n$表示添加的字符个数。</li>
</ol>
<h3 id="模板-抄的"><a href="#模板-抄的" class="headerlink" title="模板(抄的)"></a>模板(抄的)</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">26</span>; <span class="comment">// attention 用模板的时候要改变</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Ptree</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> next[maxn][N];</span><br><span class="line">    <span class="keyword">int</span> fail[maxn];</span><br><span class="line">    <span class="keyword">int</span> cnt[maxn];</span><br><span class="line">    <span class="keyword">int</span> num[maxn];</span><br><span class="line">    <span class="keyword">int</span> len[maxn];</span><br><span class="line">    <span class="keyword">int</span> S[maxn];</span><br><span class="line">    <span class="keyword">int</span> last,n,p;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">newNode</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        rep(i,<span class="number">0</span>,N) next[p][i] = <span class="number">0</span>;</span><br><span class="line">        cnt[p] = <span class="number">0</span>;num[p] = <span class="number">0</span>;len[p] = x;</span><br><span class="line">        <span class="keyword">return</span> p++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        p = <span class="number">0</span>;</span><br><span class="line">        newNode(<span class="number">0</span>);newNode(<span class="number">-1</span>);</span><br><span class="line">        last = <span class="number">0</span>; n = <span class="number">0</span>;S[n] = <span class="number">-1</span>;fail[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_fail</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(S[n-len[x]<span class="number">-1</span>] != S[n]) x = fail[x];</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">        c -= <span class="string">&#x27;a&#x27;</span>; <span class="comment">// attention 用模板的时候要改变</span></span><br><span class="line">        S[++n] = c;</span><br><span class="line">        <span class="keyword">int</span> cur = get_fail(last);</span><br><span class="line">        <span class="keyword">if</span>(!next[cur][c])&#123;</span><br><span class="line">            <span class="keyword">int</span> now = newNode(len[cur]+<span class="number">2</span>);</span><br><span class="line">            fail[now] = next[get_fail(fail[cur])][c];</span><br><span class="line">            next[cur][c] = now;</span><br><span class="line">            num[now] = num[fail[now]] + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        last = next[cur][c];</span><br><span class="line">        cnt[last]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">count</span><span class="params">()</span></span>&#123;</span><br><span class="line">        per(i,<span class="number">0</span>,p) cnt[fail[i]] += cnt[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

















<blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u013368721/article/details/42100363">https://blog.csdn.net/u013368721/article/details/42100363</a></p>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-09-03T09:24:49.000Z" title="2018-09-03T09:24:49.000Z">2018-09-03</time>发表</span><span class="level-item"><time dateTime="2018-09-04T08:02:05.873Z" title="2018-09-04T08:02:05.873Z">2018-09-04</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/acm/">acm</a></span><span class="level-item">11 分钟读完 (大约1586个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/acm/2018/09/03/2018-ICPC%E5%8D%97%E4%BA%AC%E8%B5%9B%E5%8C%BA%E7%BD%91%E7%BB%9C%E8%B5%9B.html">2018 ICPC南京赛区网络赛</a></h1><div class="content"><h1 id="ACM-ICPC-2018-南京赛区网络预赛"><a href="#ACM-ICPC-2018-南京赛区网络预赛" class="headerlink" title="ACM-ICPC 2018 南京赛区网络预赛"></a><a target="_blank" rel="noopener" href="https://www.jisuanke.com/contest/1555">ACM-ICPC 2018 南京赛区网络预赛</a></h1><h2 id="A-An-Olympian-Math-Problem"><a href="#A-An-Olympian-Math-Problem" class="headerlink" title="A. An Olympian Math Problem"></a>A. An Olympian Math Problem</h2><h3 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h3><p>$S=1×1!+2×2!+⋯+(n - 1) \times (n-1)!(n−1)×(n−1)!$问$Smodn$是多少。</p>
<h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><p>思维题，打表题？答案就是$n-1$证明如下。</p>
<p>看到$n-1$很不爽，那就加一个$(n-1)!$就凑好了。</p>
<p>$S+1!+2!+…+(n-1)!=2!+3!+…+n!$</p>
<p>之后再减掉。</p>
<p>$S=n!-1!$那么对$n$取余$S modn=-1modn=n-1$搞定。</p>
<h3 id="AC代码"><a href="#AC代码" class="headerlink" title="AC代码"></a>AC代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line">ll n;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;1.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>,&amp;n);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,n<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="B-The-writing-on-the-wall"><a href="#B-The-writing-on-the-wall" class="headerlink" title="B. The writing on the wall"></a>B. The writing on the wall</h2><h2 id="E-AC-Challenge"><a href="#E-AC-Challenge" class="headerlink" title="E. AC Challenge"></a>E. AC Challenge</h2><h3 id="题意-1"><a href="#题意-1" class="headerlink" title="题意"></a>题意</h3><p>做题目，要按照一定顺序做题目，每个题目有两个值$a,b$，表示做了题目后增加$t*a+b$。</p>
<h3 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h3><p>状态压缩+剪枝+拓扑排序。</p>
<p>因为$n$的数据量小于$20$所以可以使用状态压缩。</p>
<p>$S$表示已经做的题目。</p>
<p>$vs$数组存储已知做题的最大值。如果做同样的题值比较小就减掉。</p>
<h3 id="AC代码-1"><a href="#AC代码-1" class="headerlink" title="AC代码"></a>AC代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">30</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">noddde</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> next,to;</span><br><span class="line">&#125;G[maxn*maxn*<span class="number">3</span>];</span><br><span class="line"><span class="keyword">int</span> head[maxn],ind[maxn];</span><br><span class="line">ll a[maxn],b[maxn];</span><br><span class="line"><span class="keyword">int</span> cnt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    G[cnt].to = v;</span><br><span class="line">    G[cnt].next = head[u];</span><br><span class="line">    head[u] = cnt++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line">ll ans = <span class="number">0</span>;</span><br><span class="line">ll vis[maxn];</span><br><span class="line">ll vs[<span class="number">1</span>&lt;&lt;<span class="number">22</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> t,ll temp,<span class="keyword">int</span> S)</span></span>&#123;</span><br><span class="line">    ans = max(ans,temp);</span><br><span class="line">    <span class="keyword">if</span>(vs[S] &gt; temp) <span class="keyword">return</span>;</span><br><span class="line">    vs[S] = temp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u];~i;i=G[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> v = G[i].to;</span><br><span class="line">        ind[v]--;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(ind[i] == <span class="number">0</span> &amp;&amp; vis[i]==<span class="number">0</span>)&#123;</span><br><span class="line">            vis[i] = <span class="number">1</span>;</span><br><span class="line">            dfs(i,t+<span class="number">1</span>,temp+a[i]*t+b[i],S|(<span class="number">1</span>&lt;&lt;i));</span><br><span class="line">            vis[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u];~i;i=G[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> v = G[i].to;</span><br><span class="line">        ind[v]++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;e.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">int</span> s;<span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld%d&quot;</span>,&amp;a[i],&amp;b[i],&amp;s);</span><br><span class="line">        rep(j,<span class="number">0</span>,s)&#123;</span><br><span class="line">            <span class="keyword">int</span> u;<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;u);</span><br><span class="line">            add(u,i);ind[i]++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(ind[i]==<span class="number">0</span>)&#123;</span><br><span class="line">            ind[i]++;</span><br><span class="line">            add(<span class="number">0</span>,i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = <span class="number">0</span>;</span><br><span class="line">    dfs(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="G-Lpl-and-Energy-saving-Lamps"><a href="#G-Lpl-and-Energy-saving-Lamps" class="headerlink" title="G. Lpl and Energy-saving Lamps"></a>G. Lpl and Energy-saving Lamps</h2><h3 id="题意-2"><a href="#题意-2" class="headerlink" title="题意"></a>题意</h3><p>一个人去给所有房间换灯泡，每个月都会获得$m$个灯泡，每个房间有$a_i$个灯泡，之后以能换就换的态度每个月从第一个房间开始换，没有能换的房间就停止，把灯泡留到下一个月。换过灯泡就不用再换了。问给定月份中已经换好的房间数和当月剩下的灯泡数。</p>
<h3 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h3><p>线段树维护一个区间最小值。</p>
<p>由于线段树遍历是从前往后的，就不用担心顺序问题。</p>
<h3 id="AC代码-2"><a href="#AC代码-2" class="headerlink" title="AC代码"></a>AC代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,mid,rt&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson mid+1,r,rt&lt;&lt;1|1</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> day[maxn],remain[maxn];</span><br><span class="line"><span class="keyword">int</span> a[maxn],Min[maxn&lt;&lt;<span class="number">2</span>],ask[maxn];</span><br><span class="line"><span class="keyword">int</span> n,m,now,ans;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    Min[rt] = min(Min[rt&lt;&lt;<span class="number">1</span>],Min[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        Min[rt] = a[l];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    build(lson);</span><br><span class="line">    build(rson);</span><br><span class="line">    pushup(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(Min[rt] &gt; now) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        now -= Min[rt];</span><br><span class="line">        ans ++;</span><br><span class="line">        Min[rt] = INF;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    update(lson);</span><br><span class="line">    update(rson);</span><br><span class="line">    pushup(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;g.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,a+i);</span><br><span class="line">    <span class="keyword">int</span> maxq = <span class="number">0</span>;<span class="keyword">int</span> q;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;q);</span><br><span class="line">    rep(i,<span class="number">0</span>,q)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,ask+i);</span><br><span class="line">        maxq = max(maxq,ask[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    build(<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">    rep(i,<span class="number">1</span>,maxq+<span class="number">1</span>)&#123;</span><br><span class="line">        now += m;</span><br><span class="line">        update(<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">        day[i] = ans;remain[i] = now;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i,<span class="number">0</span>,q)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>,day[ask[i]],remain[ask[i]]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="I-Skr"><a href="#I-Skr" class="headerlink" title="I. Skr"></a>I. Skr</h2><h3 id="题意-3"><a href="#题意-3" class="headerlink" title="题意"></a>题意</h3><p>给定一个由数字构成的字符串，$n\leq 2000000$。问回文串加起来有多少？</p>
<h3 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h3><p>两种做法：</p>
<ol>
<li>马拉车+hash</li>
<li>回文树+dfs</li>
</ol>
<h3 id="AC代码1"><a href="#AC代码1" class="headerlink" title="AC代码1"></a>AC代码1</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ULL unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">4000000</span>+<span class="number">40</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">ULL P = <span class="number">1313131</span>;</span><br><span class="line">ULL sqr[maxn/<span class="number">2</span>],has[maxn/<span class="number">2</span>],V[maxn];</span><br><span class="line">ll ha[maxn/<span class="number">2</span>],tmp[maxn/<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> Laxt[maxn],Next[maxn],cnt=<span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MOD = <span class="number">2000007</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> _insert(ULL Now)</span><br><span class="line">&#123;</span><br><span class="line">       <span class="keyword">int</span> u=Now%MOD;</span><br><span class="line">       <span class="keyword">for</span>(<span class="keyword">int</span> i=Laxt[u];i;i=Next[i])&#123;</span><br><span class="line">        <span class="keyword">if</span>(V[i]==Now) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       Next[++cnt]=Laxt[u];</span><br><span class="line">       Laxt[u]=cnt;</span><br><span class="line">       V[cnt]=Now;</span><br><span class="line">       <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">ll ans=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">void</span> _hash(<span class="keyword">int</span> x,<span class="keyword">int</span> y)&#123;</span><br><span class="line">    ULL Now=has[y]-has[x<span class="number">-1</span>]*sqr[y-x+<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span>(!_insert(Now))</span><br><span class="line">    &#123;</span><br><span class="line">		ans+=((ha[y]-ha[x<span class="number">-1</span>]*tmp[y-x+<span class="number">1</span>]%mod)%mod+mod)%mod;</span><br><span class="line">		ans%=mod;</span><br><span class="line">	&#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">int</span> r[maxn];</span><br><span class="line"><span class="keyword">char</span> c[maxn];</span><br><span class="line"><span class="keyword">void</span> _malacher()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> R=<span class="number">0</span>,Mid=<span class="number">0</span>,Len;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,c+<span class="number">1</span>);</span><br><span class="line">    Len=<span class="built_in">strlen</span>(c+<span class="number">1</span>);</span><br><span class="line">    sqr[<span class="number">0</span>]=tmp[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    has[<span class="number">0</span>]=ha[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=Len;i++)&#123;</span><br><span class="line">        sqr[i]=sqr[i<span class="number">-1</span>]*P;</span><br><span class="line">        has[i]=has[i<span class="number">-1</span>]*P+c[i];</span><br><span class="line">        tmp[i]=tmp[i<span class="number">-1</span>]*<span class="number">10</span>%mod;</span><br><span class="line">        ha[i]=(ha[i<span class="number">-1</span>]*<span class="number">10</span>+c[i]-<span class="string">&#x27;0&#x27;</span>)%mod;</span><br><span class="line">    &#125;  </span><br><span class="line">    </span><br><span class="line">     <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=Len;++i) &#123;      </span><br><span class="line">        _hash(i,i);</span><br><span class="line">        <span class="keyword">if</span>(R&gt;i) r[i]=min(r[<span class="number">2</span>*Mid-i],R-i);</span><br><span class="line">        <span class="keyword">while</span>(i+r[i]+<span class="number">1</span>&lt;=Len&amp;&amp;c[i+r[i]+<span class="number">1</span>]==c[i-r[i]<span class="number">-1</span>])&#123;</span><br><span class="line">            _hash(i-r[i]<span class="number">-1</span>,i+r[i]+<span class="number">1</span>);</span><br><span class="line">            r[i]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(i+r[i]&gt;R) &#123;</span><br><span class="line">            R=i+r[i];</span><br><span class="line">            Mid=i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    cnt=<span class="number">0</span>;Mid=<span class="number">0</span>;R=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(Laxt,<span class="number">0</span>,<span class="keyword">sizeof</span>(Laxt));</span><br><span class="line">    <span class="built_in">memset</span>(r,<span class="number">0</span>,<span class="keyword">sizeof</span>(r));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=Len;++i) &#123;</span><br><span class="line">        <span class="keyword">if</span>(R&gt;i) r[i]=min(r[<span class="number">2</span>*Mid-i],R-i+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">while</span>(i+r[i]&lt;=Len&amp;&amp;c[i+r[i]]==c[i-r[i]<span class="number">-1</span>]) &#123;</span><br><span class="line">            _hash(i-r[i]<span class="number">-1</span>,i+r[i]);</span><br><span class="line">            ++r[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(i+r[i]<span class="number">-1</span>&gt;R) &#123;</span><br><span class="line">            R=i+r[i]<span class="number">-1</span>;</span><br><span class="line">            Mid=i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    _malacher();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="AC代码2"><a href="#AC代码2" class="headerlink" title="AC代码2"></a>AC代码2</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN=<span class="number">2005005</span>;</span><br><span class="line"><span class="keyword">const</span> ll MOD=<span class="number">1000000007l</span>l;</span><br><span class="line"> </span><br><span class="line"><span class="function">ll <span class="title">pow</span><span class="params">(ll a,ll b)</span></span>&#123;</span><br><span class="line">  ll t,y;</span><br><span class="line">  t=<span class="number">1</span>; y=a;</span><br><span class="line">  <span class="keyword">while</span> (b!=<span class="number">0</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span> (b&amp;<span class="number">1</span>==<span class="number">1</span>) t=t*y%MOD;</span><br><span class="line">    y=y*y%MOD; b=b&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">int</span> len[MAXN];</span><br><span class="line"><span class="keyword">int</span> nxt[MAXN][<span class="number">15</span>];</span><br><span class="line"><span class="keyword">int</span> fail[MAXN];</span><br><span class="line"><span class="keyword">int</span> num[MAXN];</span><br><span class="line"><span class="keyword">int</span> cnt[MAXN];</span><br><span class="line"><span class="keyword">int</span> last;</span><br><span class="line"><span class="keyword">int</span> S[MAXN];</span><br><span class="line"><span class="keyword">int</span> tot;</span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">new_node</span><span class="params">(<span class="keyword">int</span> l)</span></span>&#123;</span><br><span class="line">    cnt[tot]=<span class="number">0</span>;</span><br><span class="line">    num[tot]=<span class="number">0</span>;</span><br><span class="line">    len[tot]=l;</span><br><span class="line">    <span class="keyword">return</span> tot++;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init_tree</span><span class="params">()</span></span>&#123;</span><br><span class="line">    tot=<span class="number">0</span>;</span><br><span class="line">    new_node(<span class="number">0</span>);</span><br><span class="line">    new_node(<span class="number">-1</span>);</span><br><span class="line">    last=<span class="number">0</span>;</span><br><span class="line">    N=<span class="number">0</span>;</span><br><span class="line">    S[N]=<span class="number">-1</span>;</span><br><span class="line">    fail[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_fail</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(S[N-len[x]<span class="number">-1</span>]!=S[N])</span><br><span class="line">        x=fail[x];</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_char</span><span class="params">(<span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">    c-=<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    S[++N]=c;</span><br><span class="line">    <span class="keyword">int</span> cur=get_fail(last);</span><br><span class="line">    <span class="keyword">if</span>(!nxt[cur][c])&#123;</span><br><span class="line">        <span class="keyword">int</span> now=new_node(len[cur]+<span class="number">2</span>);</span><br><span class="line">        fail[now]=nxt[get_fail(fail[cur])][c];</span><br><span class="line">        nxt[cur][c]=now;</span><br><span class="line">        num[now]=num[fail[now]]+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    last=nxt[cur][c];</span><br><span class="line">    cnt[last]++;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">ll jans=<span class="number">0</span>;</span><br><span class="line">ll oans=<span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x,ll fa)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">9</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(nxt[x][i])&#123;</span><br><span class="line">			ll cur;</span><br><span class="line">			<span class="keyword">if</span>(len[nxt[x][i]]==<span class="number">1</span>)&#123;</span><br><span class="line">				jans+=i;</span><br><span class="line">				cur=i;</span><br><span class="line">				jans%=MOD;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				cur=i*<span class="built_in">pow</span>(<span class="number">10</span>,(len[nxt[x][i]]<span class="number">-1</span>))%MOD+i+fa*<span class="number">10</span>%MOD;</span><br><span class="line">				jans=(jans+cur%MOD)%MOD;</span><br><span class="line">				jans%=MOD;</span><br><span class="line">			&#125;</span><br><span class="line">			dfs1(nxt[x][i],cur%MOD);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x,ll fa)</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">9</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(nxt[x][i])&#123;</span><br><span class="line">			ll cur;</span><br><span class="line">			cur=i*<span class="built_in">pow</span>(<span class="number">10</span>,(len[nxt[x][i]]<span class="number">-1</span>))%MOD+i+fa*<span class="number">10</span>%MOD;</span><br><span class="line">			oans=(oans+cur%MOD)%MOD;</span><br><span class="line">			dfs2(nxt[x][i],cur%MOD);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">char</span> str[MAXN];</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"> 	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,str);</span><br><span class="line"> 	<span class="keyword">int</span> N1 = <span class="built_in">strlen</span>(str);</span><br><span class="line"> 	init_tree();</span><br><span class="line"> 	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;N1;i++)</span><br><span class="line"> 		add_char(str[i]);</span><br><span class="line"> 	dfs1(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"> 	dfs2(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line"> 	<span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,(jans%MOD+oans%MOD)%MOD);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="L-Magical-Girl-Haze"><a href="#L-Magical-Girl-Haze" class="headerlink" title="L. Magical Girl Haze"></a>L. Magical Girl Haze</h2><h3 id="题意-4"><a href="#题意-4" class="headerlink" title="题意"></a>题意</h3><p>给定一个图，问从$1$走到$n$如果可以选择$k$条路为$0$，那么最短的路径是多少。</p>
<h3 id="题解-4"><a href="#题解-4" class="headerlink" title="题解"></a>题解</h3><p>分层图最短路+堆优化dijistra</p>
<p>每使用一次道路为0，就进入$step+1$的路径比较。比较好的dp思维。对于pair使用了一个小trick，负值就可以不用手写greater和重载小于了。但是现场赛应该还是手写node算了。</p>
<p>dp转移两种状态.</p>
<ul>
<li>$dp[v][step+1] = min(dp[v][step+1],dp[u][step])$</li>
<li>$dp[v][step] = min(dp[v][step],dp[u][step]+val(u,v))$</li>
</ul>
<h3 id="AC代码-3"><a href="#AC代码-3" class="headerlink" title="AC代码"></a>AC代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> T,n,m,k,cnt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to,next,val;</span><br><span class="line">&#125;G[maxn&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> head[maxn];</span><br><span class="line">ll dp[maxn][<span class="number">13</span>],done[maxn][<span class="number">13</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,ll val)</span></span>&#123;</span><br><span class="line">    G[cnt].to = v;</span><br><span class="line">    G[cnt].next = head[u];</span><br><span class="line">    G[cnt].val = val;</span><br><span class="line">    head[u] = cnt++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dijstra</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">priority_queue</span>&lt;<span class="built_in">pair</span>&lt;ll,<span class="built_in">pair</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; &gt; &gt; pq;</span><br><span class="line">    pq.push(mp(<span class="number">0</span>,mp(<span class="number">1</span>,<span class="number">0</span>)));</span><br><span class="line">    dp[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(!pq.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> u = pq.top().se.fi;</span><br><span class="line">        ll dis = pq.top().fi;</span><br><span class="line">        <span class="keyword">int</span> step = pq.top().se.se;</span><br><span class="line">        pq.pop();</span><br><span class="line">        <span class="keyword">if</span>(done[u][step]) <span class="keyword">continue</span>;</span><br><span class="line">        done[u][step] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(u == n)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,-dis);<span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=head[u];~i;i=G[i].next)&#123;</span><br><span class="line">            <span class="keyword">int</span> v = G[i].to;ll val = G[i].val;</span><br><span class="line">            <span class="keyword">if</span>(step&lt;k &amp;&amp; !done[v][step+<span class="number">1</span>] &amp;&amp; dp[v][step+<span class="number">1</span>]&lt;dis)&#123;</span><br><span class="line">                dp[v][step+<span class="number">1</span>] = dis;</span><br><span class="line">                pq.push(mp(dis,mp(v,step+<span class="number">1</span>)));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!done[v][step] &amp;&amp; dp[v][step]&lt;dis+val)&#123;</span><br><span class="line">                dp[v][step] = dis+val;</span><br><span class="line">                pq.push(mp(dp[v][step],mp(v,step)));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(<span class="keyword">int</span>)*(n+<span class="number">2</span>));</span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(done,<span class="number">0</span>,<span class="keyword">sizeof</span>(done));</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>) rep(j,<span class="number">0</span>,k+<span class="number">1</span>) dp[i][j] = <span class="number">-1e16</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;l.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;n,&amp;m,&amp;k);</span><br><span class="line">        init();</span><br><span class="line">        rep(i,<span class="number">0</span>,m)&#123;</span><br><span class="line">            <span class="keyword">int</span> u,v;ll val;<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%lld&quot;</span>,&amp;u,&amp;v,&amp;val);</span><br><span class="line">            add(u,v,-val);</span><br><span class="line">        &#125;</span><br><span class="line">        dijstra();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-09-03T08:05:30.000Z" title="2018-09-03T08:05:30.000Z">2018-09-03</time>发表</span><span class="level-item"><time dateTime="2018-12-08T05:00:03.018Z" title="2018-12-08T05:00:03.018Z">2018-12-08</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a></span><span class="level-item">7 分钟读完 (大约1122个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/2018/09/03/web%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0.html">web应用开发笔记</a></h1><div class="content"><h1 id="web应用开发"><a href="#web应用开发" class="headerlink" title="web应用开发"></a>web应用开发</h1><p>现代人的生活方式</p>
<ul>
<li>移动端,mobile</li>
<li>浏览器,browser</li>
</ul>
<p>10年前还是以客户端,client软件形式。</p>
<h2 id="两个主流技术"><a href="#两个主流技术" class="headerlink" title="两个主流技术"></a>两个主流技术</h2><ul>
<li>.Net</li>
<li>J2ee</li>
</ul>
<p>.Net过气了，用J2ee</p>
<h3 id="J2ee的三个方面"><a href="#J2ee的三个方面" class="headerlink" title="J2ee的三个方面"></a>J2ee的三个方面</h3><ol>
<li>M 模型:负责数据方面的事情，数据分为两个方面，store存储，access访问。依靠模型完成这个功能。<ol>
<li>承载数据。</li>
<li>把数据中的信息进行表达convey，存储信息和加工信息。</li>
<li>不只是一个dbms。</li>
</ol>
</li>
<li>V 视图:将信息呈现出来，view显示。<ol>
<li>把数据呈现给用户。</li>
<li>承载用户修改功能，使用户能够修改信息。</li>
</ol>
</li>
<li>C 控制:把用户的信息进行处理(按照一定的算法和一定的逻辑)，之后再保存在M端。</li>
</ol>
<p>summary：M存储信息，V交互，C逻辑控制（算法）。</p>
<p><img src="/var/folders/36/rpzy0ngj08lgj766c83n484r0000gn/T/abnerworks.Typora/image-20180903105104497.png" alt="image-20180903105104497"></p>
<p>梅宏，杨芙青，吕健——网构建</p>
<h3 id="开发V端"><a href="#开发V端" class="headerlink" title="开发V端"></a>开发V端</h3><p>V html,jsp,css,jQuery</p>
<p>自学html。 在w3c学</p>
<p>jQuery,是js的一个库。</p>
<p>extjs 扩展版js 丰富了UI设计功能</p>
<h3 id="开发M端"><a href="#开发M端" class="headerlink" title="开发M端"></a>开发M端</h3><p>MySql，Oracle，SQL server,DB2,Access</p>
<p>框架Hibernate统一了不同的dbms的操作。</p>
<p>缺点：是将数据和公共模型进行映射，一旦确定就不好改变，开发的时候麻烦。</p>
<p>iBatis 容易改进的框架</p>
<p>MyBatis</p>
<h3 id="开发C端"><a href="#开发C端" class="headerlink" title="开发C端"></a>开发C端</h3><p>struts 框架，把数据进行逻辑处理之后保存到M端。</p>
<p>jQuery js spring 开发代码是Java。framework</p>
<h2 id="开发模式"><a href="#开发模式" class="headerlink" title="开发模式"></a>开发模式</h2><p>Html + css + mySQL 几种在view端和modle端</p>
<p>jsp + css + mySQL</p>
<p>jQuery+css+mySQL</p>
<p>PHP + css + mySQL</p>
<p>这些都是小型网站。 乐色</p>
<p>我们的模式</p>
<p>JSP+Struts+mySQL  plus + spring + ssh</p>
<p>Real 项目： JSP + SSH + CSS + MYSQL</p>
<h3 id="SSH-Spring-Struts-Hibernate"><a href="#SSH-Spring-Struts-Hibernate" class="headerlink" title="SSH Spring Struts Hibernate"></a>SSH Spring Struts Hibernate</h3><h2 id="JSP详解"><a href="#JSP详解" class="headerlink" title="JSP详解"></a>JSP详解</h2><h2 id="element-语素"><a href="#element-语素" class="headerlink" title="element 语素"></a>element 语素</h2><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">	<span class="comment">//可以嵌入语句</span></span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<h3 id="有三类语句"><a href="#有三类语句" class="headerlink" title="有三类语句"></a>有三类语句</h3><ol>
<li>表达式</li>
<li>小脚本</li>
<li>声明</li>
</ol>
<h3 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h3><p>table称为一个标签，tag。标签有很多属性</p>
<h2 id="看看JSP和mySQL"><a href="#看看JSP和mySQL" class="headerlink" title="看看JSP和mySQL"></a>看看JSP和mySQL</h2><p>NaviCat可视化操作MySQL</p>
<p>1433 SQLServer</p>
<p>3306 mySQL 端口</p>
<p>各种端口号是必记。</p>
<h3 id="Myecl"><a href="#Myecl" class="headerlink" title="Myecl"></a>Myecl</h3><p>集成了子IDE,所以比较方便。</p>
<h3 id="JAR包"><a href="#JAR包" class="headerlink" title="JAR包"></a>JAR包</h3><p>是将java代码和文档集成在一个包中。</p>
<p>5.1.35java connect是可以用的</p>
<p>jdbc driver</p>
<p>URL，第一节是JDBC协议，第二节是MySQL表示数据库名称，第三节是代表这MySQL服务器的名字，localhost 127.0.0.1,第四节是端口号。后面都删掉。后面是连着的库。</p>
<p>driver name 随便取。</p>
<p>Schema 是 database的超集。 datebase是table的超集。</p>
<h3 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h3><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StringTypeConversion <span class="comment">//把子段转化成串</span></span><br></pre></td></tr></table></figure>

<p>connection transantion statement resultset</p>
<p>先建立连接，使用JSP连接MySQL</p>
<p>getConnection函数是静态类型，可以通过类名直接调用函数。</p>
<p>语句分为两方面</p>
<ul>
<li>静态的，</li>
<li>动态的，是由运行时候确定的查询和修改语句</li>
</ul>
<p>获得了resultset之后因为其中有很多条记录，所以必须要用循环。resultset自带了迭代器，iterator。一行一行，一个记录一个记录访问。</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//把当前指针指向的record赋予re,之后指针往下走。</span></span><br><span class="line"><span class="keyword">while</span>(re.next())&#123;</span><br><span class="line">	TypeConversion(rs,Type.VARCHAR,<span class="number">1</span>);</span><br><span class="line"><span class="comment">//and so on 把结果串加入过来。</span></span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rs.close();</span><br><span class="line">stmt.close();</span><br><span class="line">conn.close();</span><br><span class="line"><span class="comment">// 记得关闭连接 一级一级一级往回退</span></span><br></pre></td></tr></table></figure>

<h3 id="交互界面-登陆界面"><a href="#交互界面-登陆界面" class="headerlink" title="交互界面(登陆界面)"></a>交互界面(登陆界面)</h3><p>早年窗口还叫Window，现在流行叫frame。</p>
<ul>
<li>使用html的指令去做</li>
<li>使用JSTL做窗口，使用扩展模板库</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;userName&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pass&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;登陆&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="MVC的思想"><a href="#MVC的思想" class="headerlink" title="MVC的思想"></a>MVC的思想</h2><h3 id="C的思想"><a href="#C的思想" class="headerlink" title="C的思想"></a>C的思想</h3><p>逻辑控制部分，与应用与需求是相关的。</p>
<p>Struts的本质是借用了java类或者说是函数映射成了一个action，就像html的标签一样可以任意的去使用它。</p>
<p>Struts缺省的配置文件是Sruts.xml 。</p>
<ol>
<li>web.xml</li>
<li>配置struts.xml文件</li>
<li>建立Action类文件</li>
<li>建立Action执行后转向的jsp文件。</li>
</ol>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><p>${message} 直接将message类中的信息直接输出出来。</p>
<p>他把control端的数据在页面里输出出来。</p>
<p>那么如何把view端的数据在control中获得呢？</p>
<h3 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a>实现原理</h3><ul>
<li>数据共享 data sharing</li>
<li>配置文件 configuration</li>
</ul>
<p>struts2提供在一个类中，具有一定特征的函数就可以映射成actions。</p>
<h3 id="result"><a href="#result" class="headerlink" title="result"></a>result</h3><p>dispatcher分发包裹的方式，之前建立的页面缺省的是dispatcher。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-09-02T03:52:04.000Z" title="2018-09-02T03:52:04.000Z">2018-09-02</time>发表</span><span class="level-item"><time dateTime="2018-09-02T03:52:42.263Z" title="2018-09-02T03:52:42.263Z">2018-09-02</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/cf1500/">cf1500</a></span><span class="level-item">3 分钟读完 (大约522个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/cf1500/2018/09/02/Codeforces-Round-499-Div-2.html">Codeforces Round #499 (Div. 2)</a></h1><div class="content"><h1 id="Codeforces-Round-499-Div-2-http-codeforces-com-contest-1011"><a href="#Codeforces-Round-499-Div-2-http-codeforces-com-contest-1011" class="headerlink" title="Codeforces Round #499 (Div. 2)](http://codeforces.com/contest/1011)"></a>Codeforces Round #499 (Div. 2)](<a target="_blank" rel="noopener" href="http://codeforces.com/contest/1011">http://codeforces.com/contest/1011</a>)</h1><h2 id="A-Stages"><a href="#A-Stages" class="headerlink" title="A. Stages"></a>A. Stages</h2><h3 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h3><p>给定一段序列，每个字母代表这一个权值，比如$a$代表$1$。之后问从中挑选出一个序列，要求$a[i]$和$a[i+1]$之间相隔一个字母，问从任意顺序选择$k$个字母，最少可以有多少权值。</p>
<h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><p>贪心，其实如果取最大值的话， 我就有点不会了。但是取最小值可以贪心的对所有位置都取能取的最小值。</p>
<h3 id="AC代码"><a href="#AC代码" class="headerlink" title="AC代码"></a>AC代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">int</span> n,k;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">60</span>;</span><br><span class="line"><span class="keyword">char</span> s[maxn];</span><br><span class="line"><span class="keyword">int</span> a[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;1.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;k);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,s);</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line">    rep(i,<span class="number">0</span>,n) a[i] = s[i] -<span class="string">&#x27;a&#x27;</span>+<span class="number">1</span>;</span><br><span class="line">    sort(a,a+len);</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;<span class="keyword">int</span> t = <span class="number">0</span>;<span class="keyword">int</span> si = <span class="number">-3</span>;</span><br><span class="line">    rep(i,<span class="number">0</span>,len)&#123;</span><br><span class="line">        <span class="keyword">if</span>(si&lt;a[i]<span class="number">-1</span> &amp;&amp; t&lt;k)&#123;</span><br><span class="line">            ans +=a[i];</span><br><span class="line">            t++;</span><br><span class="line">            si = a[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(t==k)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="B-Planning-The-Expedition"><a href="#B-Planning-The-Expedition" class="headerlink" title="B. Planning The Expedition"></a>B. Planning The Expedition</h2><h3 id="题意-1"><a href="#题意-1" class="headerlink" title="题意"></a>题意</h3><p>每个人每天都要吃一个特定种类(由你分配)的食物，你现在有$k$种食物，每个食物都有对应的数量，问怎么分配可以在当前食物下过存活尽量多的天数。</p>
<h3 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h3><p>二分枚举答案(坑爹cf，$m&lt;100$二分都不用)。因为答案是递减的。</p>
<h3 id="AC代码-1"><a href="#AC代码-1" class="headerlink" title="AC代码"></a>AC代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">int</span> m,n;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">110</span>;</span><br><span class="line"><span class="keyword">int</span> a[maxn],b[maxn];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a&gt;b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> cnt,ans;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> day,<span class="keyword">int</span> idx,<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(p &lt;= <span class="number">0</span>)&#123;</span><br><span class="line">        ans = max(ans,day);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(idx ==cnt) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=a[idx];i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(a[idx] / i &lt; day) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(day,idx+<span class="number">1</span>,p-i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;2.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">    rep(i,<span class="number">1</span>,m+<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">int</span> x;<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">        a[x]++;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = <span class="number">0</span>;</span><br><span class="line">    sort(a+<span class="number">1</span>,a+m+<span class="number">1</span>,cmp);</span><br><span class="line">    rep(i,<span class="number">1</span>,<span class="number">101</span>) <span class="keyword">if</span>(a[i]==<span class="number">0</span>) &#123;cnt = i;<span class="keyword">break</span>;&#125;</span><br><span class="line">    <span class="keyword">for</span>(ans = <span class="number">1</span>;ans&lt;=<span class="number">100</span>;ans++)&#123;</span><br><span class="line">        <span class="keyword">int</span> peo = <span class="number">0</span>;</span><br><span class="line">        rep(i,<span class="number">1</span>,<span class="number">10</span>)&#123;</span><br><span class="line">            peo += a[i]/ans;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(peo &lt;n)&#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="C-Fly"><a href="#C-Fly" class="headerlink" title="C.Fly"></a>C.Fly</h2><h3 id="题意-2"><a href="#题意-2" class="headerlink" title="题意"></a>题意</h3><p>每次降落和出发都需要消耗燃料，问最少带多少燃料可以来一次旅行。</p>
<h3 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h3><p>小学奥数题，反向做即可。</p>
<h3 id="AC代码-2"><a href="#AC代码-2" class="headerlink" title="AC代码"></a>AC代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="D-Rocket"><a href="#D-Rocket" class="headerlink" title="D. Rocket"></a>D. Rocket</h2><h3 id="题意-3"><a href="#题意-3" class="headerlink" title="题意"></a>题意</h3><p>猜数字，你问至多$60$次数字，他给出你问的数字是大了还是笑了，他有一个循环答题方案，比如第一次打错，第二次答对，循环少于$30$次。让你问出答案。</p>
<h3 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h3><p>循环至多$30$次暗示了你可以故意说一些已知的问题来试他。比如问-1是大了还是小了。之后就是简单的二分了。</p>
<p>心路历程：第一次做交互题，输入输出完全搞不懂。</p>
<h3 id="AC代码-3"><a href="#AC代码-3" class="headerlink" title="AC代码"></a>AC代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">bool</span> vis[<span class="number">100</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;x&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    fflush(<span class="built_in">stdout</span>);</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;y;</span><br><span class="line">    <span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="comment">//freopen(&quot;4.in&quot;,&quot;r&quot;,stdin);</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;m,&amp;n);</span><br><span class="line">    rep(i,<span class="number">0</span>,n)&#123;</span><br><span class="line">        <span class="keyword">int</span> x = query(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(x == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="built_in">cout</span>&lt;&lt;<span class="number">1</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(x&lt;<span class="number">0</span>) vis[i] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = <span class="number">0</span>;<span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> l,r;</span><br><span class="line">    l = <span class="number">1</span>,r = m;</span><br><span class="line">    <span class="keyword">while</span>(l&lt;=r)&#123;</span><br><span class="line">        mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> y = query(mid);</span><br><span class="line">        <span class="keyword">if</span>(vis[cnt]) y = -y;</span><br><span class="line">        <span class="keyword">if</span>(y==<span class="number">1</span>) l = mid+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(y==<span class="number">-1</span>)r = mid<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">cout</span>&lt;&lt;mid&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cnt = (cnt+<span class="number">1</span>)%n;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-08-31T08:45:24.000Z" title="2018-08-31T08:45:24.000Z">2018-08-31</time>发表</span><span class="level-item"><time dateTime="2018-09-01T02:48:02.697Z" title="2018-09-01T02:48:02.697Z">2018-09-01</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/acm/">acm</a></span><span class="level-item">1 分钟读完 (大约130个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/acm/2018/08/31/%E5%85%AB%E6%95%B0%E7%A0%81%E9%97%AE%E9%A2%98.html">八数码问题</a></h1><div class="content"><h1 id="八数码问题"><a href="#八数码问题" class="headerlink" title="八数码问题"></a>八数码问题</h1><h2 id="前提知识-康拓展开"><a href="#前提知识-康拓展开" class="headerlink" title="前提知识 康拓展开"></a>前提知识 康拓展开</h2><h3 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h3><p>相当于hash存储序列，使用更加小的空间来存储排列。</p>
<h3 id="公式"><a href="#公式" class="headerlink" title="公式"></a>公式</h3><p>$X = a_n*(n-1)!+a_{n-1}<em>(n-2)+…+a_1</em>0!$，$a_i$表示当前未出现的数字是排在第几个元素。$0 \leq a_i &lt; i,1 \leq i \leq n$</p>
<h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> fac[maxn];</span><br><span class="line">fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">rep(i,<span class="number">1</span>,max) fac[i] = fac[i<span class="number">-1</span>]*i;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cantor</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    rep(i,<span class="number">0</span>,maxn)&#123;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k=i+<span class="number">1</span>;k&lt;maxn;k++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(vis[k]&lt;vis[i]) cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">        ans += fac[n-i]*cnt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<p>reference:<a target="_blank" rel="noopener" href="https://blog.csdn.net/cyningsun/article/details/6797128">https://blog.csdn.net/cyningsun/article/details/6797128</a></p>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/6/">上一页</a></div><div class="pagination-next"><a href="/page/8/">下一页</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/6/">6</a></li><li><a class="pagination-link is-current" href="/page/7/">7</a></li><li><a class="pagination-link" href="/page/8/">8</a></li><li><a class="pagination-link" href="/page/9/">9</a></li><li><a class="pagination-link" href="/page/10/">10</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/1.gif" alt="Chea Sim"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Chea Sim</p><p class="is-size-6 is-block">Student from Z</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Ning Bo</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">91</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">26</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">69</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/CheaSim" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/CheaSim"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/www.cheasim.com"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/1600/"><span class="level-start"><span class="level-item">1600</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/acm/"><span class="level-start"><span class="level-item">acm</span></span><span class="level-end"><span class="level-item tag">37</span></span></a></li><li><a class="level is-mobile" href="/categories/acm%E6%A8%A1%E6%9D%BF/"><span class="level-start"><span class="level-item">acm模板</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/ac%E8%87%AA%E5%8A%A8%E6%9C%BA/"><span class="level-start"><span class="level-item">ac自动机</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/cf/"><span class="level-start"><span class="level-item">cf</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/cf1500/"><span class="level-start"><span class="level-item">cf1500</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/dfs/"><span class="level-start"><span class="level-item">dfs</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/dp/"><span class="level-start"><span class="level-item">dp</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/hash/"><span class="level-start"><span class="level-item">hash</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/html/"><span class="level-start"><span class="level-item">html</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/pat/"><span class="level-start"><span class="level-item">pat</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E4%B8%93%E9%A1%B9%E7%BB%83%E4%B9%A0/"><span class="level-start"><span class="level-item">专项练习</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E4%BF%9D%E7%A0%94/"><span class="level-start"><span class="level-item">保研</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%89%8D%E7%AB%AF/"><span class="level-start"><span class="level-item">前端</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span class="level-start"><span class="level-item">学习笔记</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/"><span class="level-start"><span class="level-item">学习计划</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%BC%80%E5%8F%91/"><span class="level-start"><span class="level-item">开发</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%90%AC%E7%A0%96/"><span class="level-start"><span class="level-item">搬砖</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%A6%82%E7%8E%87dp/"><span class="level-start"><span class="level-item">概率dp</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%A8%A1%E6%9D%BF/"><span class="level-start"><span class="level-item">模板</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%BA%BF%E6%AE%B5%E6%A0%91/"><span class="level-start"><span class="level-item">线段树</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%80%83%E7%A0%94/"><span class="level-start"><span class="level-item">考研</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%80%83%E7%A0%94%E8%B7%AF%E6%BC%AB%E6%BC%AB/"><span class="level-start"><span class="level-item">考研路漫漫</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%93%9D%E6%A1%A5%E6%9D%AF/"><span class="level-start"><span class="level-item">蓝桥杯</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AE%BA%E8%A7%A3/"><span class="level-start"><span class="level-item">论解</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-11-18T09:05:20.000Z">2020-11-18</time></p><p class="title"><a href="/%E8%AE%BA%E8%A7%A3/2020/11/18/ALBERT-%E6%9B%B4%E5%B0%8F%E4%BD%86%E6%98%AF%E6%9B%B4%E6%85%A2%EF%BC%9F.html">ALBERT 更小但是更慢？</a></p><p class="categories"><a href="/categories/%E8%AE%BA%E8%A7%A3/">论解</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2019-12-25T06:17:24.000Z">2019-12-25</time></p><p class="title"><a href="/%E8%80%83%E7%A0%94/2019/12/25/%E8%80%83%E7%A0%94%E9%9A%8F%E6%83%B3.html">考研随想</a></p><p class="categories"><a href="/categories/%E8%80%83%E7%A0%94/">考研</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2019-09-12T11:46:24.000Z">2019-09-12</time></p><p class="title"><a href="/%E8%80%83%E7%A0%94/2019/09/12/9-9-9-15%E8%AE%A1%E5%88%92.html">9.9-9.15计划</a></p><p class="categories"><a href="/categories/%E8%80%83%E7%A0%94/">考研</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2019-08-28T12:02:57.000Z">2019-08-28</time></p><p class="title"><a href="/pat/2019/08/28/pat1139-First-Contact-%E5%89%8D%E5%AF%BC%E9%9B%B6.html">[pat1139]First Contact 前导零 </a></p><p class="categories"><a href="/categories/pat/">pat</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2019-07-23T11:07:49.000Z">2019-07-23</time></p><p class="title"><a href="/uncategorized/2019/07/23/pat1003-Emergency.html">[pat1003]Emergency</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">十一月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/12/"><span class="level-start"><span class="level-item">十二月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/09/"><span class="level-start"><span class="level-item">九月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/08/"><span class="level-start"><span class="level-item">八月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/07/"><span class="level-start"><span class="level-item">七月 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/05/"><span class="level-start"><span class="level-item">五月 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/04/"><span class="level-start"><span class="level-item">四月 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/03/"><span class="level-start"><span class="level-item">三月 2019</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/11/"><span class="level-start"><span class="level-item">十一月 2018</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/10/"><span class="level-start"><span class="level-item">十月 2018</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/09/"><span class="level-start"><span class="level-item">九月 2018</span></span><span class="level-end"><span class="level-item tag">22</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/08/"><span class="level-start"><span class="level-item">八月 2018</span></span><span class="level-end"><span class="level-item tag">22</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/AI/"><span class="tag">AI</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LCA/"><span class="tag">LCA</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/acm/"><span class="tag">acm</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ac%E8%87%AA%E5%8A%A8%E6%9C%BA/"><span class="tag">ac自动机</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ajax/"><span class="tag">ajax</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cf/"><span class="tag">cf</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css/"><span class="tag">css</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dfs/"><span class="tag">dfs</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dp/"><span class="tag">dp</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dptree/"><span class="tag">dptree</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/echarts/"><span class="tag">echarts</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/graph/"><span class="tag">graph</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/greedy/"><span class="tag">greedy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hash/"><span class="tag">hash</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hdoj/"><span class="tag">hdoj</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/html/"><span class="tag">html</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/js/"><span class="tag">js</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jsp/"><span class="tag">jsp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/lca/"><span class="tag">lca</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linux/"><span class="tag">linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/math/"><span class="tag">math</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/matrix/"><span class="tag">matrix</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nlp/"><span class="tag">nlp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pat/"><span class="tag">pat</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/struts2/"><span class="tag">struts2</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web/"><span class="tag">web</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%B8%93%E9%A2%98/"><span class="tag">专题</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%8C%E5%88%86/"><span class="tag">二分</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%BA%E7%94%9F/"><span class="tag">人生</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BF%9D%E7%A0%94/"><span class="tag">保研</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%85%AB%E6%95%B0%E7%A0%81/"><span class="tag">八数码</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9B%BE%E8%AE%BA/"><span class="tag">图论</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/"><span class="tag">字符串</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2hash/"><span class="tag">字符串hash</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span class="tag">学习笔记</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/"><span class="tag">学习计划</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BC%80%E5%8F%91/"><span class="tag">开发</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E5%AD%A6/"><span class="tag">数学</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"><span class="tag">数据结构</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%80%E5%A4%A7%E5%AD%90%E6%AE%B5%E5%92%8C/"><span class="tag">最大子段和</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9E%84%E9%80%A0/"><span class="tag">构造</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A0%91%E5%BD%A2dp/"><span class="tag">树形dp</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/"><span class="tag">树状数组</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%EF%BC%8Chdoj/"><span class="tag">树状数组，hdoj</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86/"><span class="tag">树链剖分</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A6%82%E7%8E%87dp/"><span class="tag">概率dp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A8%A1%E6%8B%9F/"><span class="tag">模拟</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A8%A1%E6%9D%BF/"><span class="tag">模板</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%88%86%E6%90%9C/"><span class="tag">爆搜</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%89%9B%E5%AE%A2%E7%BD%91/"><span class="tag">牛客网</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%8A%B6%E5%8E%8Bdp/"><span class="tag">状压dp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"><span class="tag">线段树</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/"><span class="tag">组合数学</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BB%86%E8%8A%82/"><span class="tag">细节</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BC%A9%E7%82%B9/"><span class="tag">缩点</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BD%91%E7%BB%9C/"><span class="tag">网络</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BD%91%E7%BB%9C%E8%B5%9B/"><span class="tag">网络赛</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%80%83%E7%A0%94/"><span class="tag">考研</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%8C%83%E5%9B%B4/"><span class="tag">范围</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%93%9D%E6%A1%A5%E6%9D%AF/"><span class="tag">蓝桥杯</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%A1%A5%E9%A2%98/"><span class="tag">补题</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%A7%84%E5%BE%8B/"><span class="tag">规律</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%A1%E5%88%92/"><span class="tag">计划</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95/"><span class="tag">计算几何</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%B4%AA%E5%BF%83/"><span class="tag">贪心</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%80%92%E5%BD%92/"><span class="tag">递归</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%85%8D%E7%BD%AE/"><span class="tag">配置</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%A2%84%E5%A4%84%E7%90%86/"><span class="tag">预处理</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/1.gif" alt="CheaSim Blog" height="28"></a><p class="is-size-7"><span>&copy; 2020 CheaSim</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>