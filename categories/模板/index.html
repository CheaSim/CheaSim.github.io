<!doctype html>
<html lang="zh"><canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;"></canvas><script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script><script type="text/javascript" src="/js/fireworks.js"></script><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>分类: 模板 - CheaSim Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="cheasim&#039;s blog"><meta name="msapplication-TileImage" content="/img/1.gif"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="cheasim&#039;s blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description="ACM chicken"><meta property="og:type" content="blog"><meta property="og:title" content="CheaSim Blog"><meta property="og:url" content="https://www.cheasim.com/"><meta property="og:site_name" content="CheaSim Blog"><meta property="og:description" content="ACM chicken"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.cheasim.com/img/og_image.png"><meta property="article:author" content="CheaSim"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.cheasim.com"},"headline":"CheaSim Blog","image":["https://www.cheasim.com/img/og_image.png"],"author":{"@type":"Person","name":"CheaSim"},"description":"ACM chicken"}</script><link rel="icon" href="/img/1.gif"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-R7VVCLV2ZB" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-R7VVCLV2ZB');</script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.2.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/1.gif" alt="CheaSim Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-9-desktop is-9-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/categories">分类</a></li><li class="is-active"><a href="#" aria-current="page">模板</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-09-30T05:59:52.000Z" title="2018-09-30T05:59:52.000Z">2018-09-30</time>发表</span><span class="level-item"><time dateTime="2019-05-11T12:31:11.550Z" title="2019-05-11T12:31:11.550Z">2019-05-11</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%A8%A1%E6%9D%BF/">模板</a></span><span class="level-item">16 分钟读完 (大约2398个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/%E6%A8%A1%E6%9D%BF/2018/09/30/%E6%A8%A1%E6%9D%BF.html">模板</a></h1><div class="content"><h1 id="Java大数模板"><a href="#Java大数模板" class="headerlink" title="Java大数模板"></a>Java大数模板</h1><p>二、Java之输入输出处理<br>由于ACM竞赛题目的输入数据和输出数据一般有多组（不定），并且格式多种多样，所以，如何处理题目的输入输出是对大家的一项最基本的要求。这也是困扰初学者的一大问题。</p>
<ol>
<li>输入：</li>
</ol>
<p>格式1：Scanner sc = new Scanner (new BufferedInputStream(System.in));</p>
<p>格式2：Scanner sc = new Scanner (System.in);</p>
<p>在读入数据量大的情况下，格式1的速度会快些。</p>
<p>读一个整数： int n = sc.nextInt(); 相当于 scanf(“%d”, &amp;n); 或 cin &gt;&gt; n; </p>
<p>读一个字符串：String s = sc.next(); 相当于 scanf(“%s”, s); 或 cin &gt;&gt; s; </p>
<p>读一个浮点数：double t = sc.nextDouble(); 相当于 scanf(“%lf”, &amp;t); 或 cin &gt;&gt; t; </p>
<p>读一整行： String s = sc.nextLine(); 相当于 gets(s); 或 cin.getline(…); </p>
<p>判断是否有下一个输入可以用sc.hasNext()或sc.hasNextInt()或sc.hasNextDouble()或sc.hasNextLine()</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">import</span> java.math.*;</span><br><span class="line">Scanner cin = <span class="keyword">new</span> Scanner (<span class="keyword">new</span> BufferedInputStream(System.in));</span><br><span class="line"><span class="keyword">while</span>(cin.haxNextInt)&#123;</span><br><span class="line">  <span class="comment">//操作</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="大数使用例子"><a href="#大数使用例子" class="headerlink" title="大数使用例子"></a>大数使用例子</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.math.*;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> Scanner in = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> a = in.nextInt();</span><br><span class="line">        BigInteger b = in.nextBigInteger();</span><br><span class="line">        BigDecimal c = in.nextBigDecimal();</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        BigDecimal：</span></span><br><span class="line"><span class="comment">            构造方法:</span></span><br><span class="line"><span class="comment">                BigDecimal(BigInteger val)</span></span><br><span class="line"><span class="comment">                BigDecimal(BigInteger unscaledVal, int scale)</span></span><br><span class="line"><span class="comment">                BigDecimal(BigInteger unscaledVal, int scale, MathContext mc)</span></span><br><span class="line"><span class="comment">                BigDecimal(BigInteger val, MathContext mc)</span></span><br><span class="line"><span class="comment">                BigDecimal(char[] in)</span></span><br><span class="line"><span class="comment">                BigDecimal(char[] in, int offset, int len)</span></span><br><span class="line"><span class="comment">                BigDecimal(char[] in, int offset, int len, MathContext mc)</span></span><br><span class="line"><span class="comment">                BigDecimal(char[] in, MathContext mc)</span></span><br><span class="line"><span class="comment">                BigDecimal(double val)</span></span><br><span class="line"><span class="comment">                BigDecimal(double val, MathContext mc)</span></span><br><span class="line"><span class="comment">                BigDecimal(int val)</span></span><br><span class="line"><span class="comment">                BigDecimal(int val, MathContext mc)</span></span><br><span class="line"><span class="comment">                BigDecimal(long val)</span></span><br><span class="line"><span class="comment">                BigDecimal(long val, MathContext mc)</span></span><br><span class="line"><span class="comment">                BigDecimal(String val)</span></span><br><span class="line"><span class="comment">                BigDecimal(String val, MathContext mc)</span></span><br><span class="line"><span class="comment">            成员方法:</span></span><br><span class="line"><span class="comment">                BigDecimal 	abs()</span></span><br><span class="line"><span class="comment">                BigDecimal 	abs(MathContext mc)</span></span><br><span class="line"><span class="comment">                BigDecimal 	add(BigDecimal augend)</span></span><br><span class="line"><span class="comment">                BigDecimal 	add(BigDecimal augend, MathContext mc)</span></span><br><span class="line"><span class="comment">                byte 	byteValueExact()</span></span><br><span class="line"><span class="comment">                int 	compareTo(BigDecimal val)</span></span><br><span class="line"><span class="comment">                BigDecimal 	divide(BigDecimal divisor)</span></span><br><span class="line"><span class="comment">                BigDecimal 	divide(BigDecimal divisor, int roundingMode)</span></span><br><span class="line"><span class="comment">                BigDecimal 	divide(BigDecimal divisor, int scale, int roundingMode)</span></span><br><span class="line"><span class="comment">                BigDecimal 	divide(BigDecimal divisor, int scale, RoundingMode roundingMode)</span></span><br><span class="line"><span class="comment">                BigDecimal 	divide(BigDecimal divisor, MathContext mc)</span></span><br><span class="line"><span class="comment">                BigDecimal 	divide(BigDecimal divisor, RoundingMode roundingMode)</span></span><br><span class="line"><span class="comment">                BigDecimal[] 	divideAndRemainder(BigDecimal divisor)</span></span><br><span class="line"><span class="comment">                BigDecimal[] 	divideAndRemainder(BigDecimal divisor, MathContext mc)</span></span><br><span class="line"><span class="comment">                BigDecimal 	divideToIntegralValue(BigDecimal divisor)</span></span><br><span class="line"><span class="comment">                BigDecimal 	divideToIntegralValue(BigDecimal divisor, MathContext mc)</span></span><br><span class="line"><span class="comment">                double 	doubleValue()</span></span><br><span class="line"><span class="comment">                boolean 	equals(Object x)</span></span><br><span class="line"><span class="comment">                float 	floatValue()</span></span><br><span class="line"><span class="comment">                int 	hashCode()</span></span><br><span class="line"><span class="comment">                int 	intValue()</span></span><br><span class="line"><span class="comment">                int 	intValueExact()</span></span><br><span class="line"><span class="comment">                long 	longValue()</span></span><br><span class="line"><span class="comment">                long 	longValueExact()</span></span><br><span class="line"><span class="comment">                BigDecimal 	max(BigDecimal val)</span></span><br><span class="line"><span class="comment">                BigDecimal 	min(BigDecimal val)</span></span><br><span class="line"><span class="comment">                BigDecimal 	movePointLeft(int n)</span></span><br><span class="line"><span class="comment">                BigDecimal 	movePointRight(int n)</span></span><br><span class="line"><span class="comment">                BigDecimal 	multiply(BigDecimal multiplicand)</span></span><br><span class="line"><span class="comment">                BigDecimal 	multiply(BigDecimal multiplicand, MathContext mc)</span></span><br><span class="line"><span class="comment">                BigDecimal 	negate()</span></span><br><span class="line"><span class="comment">                BigDecimal 	negate(MathContext mc)</span></span><br><span class="line"><span class="comment">                BigDecimal 	plus()</span></span><br><span class="line"><span class="comment">                BigDecimal 	plus(MathContext mc)</span></span><br><span class="line"><span class="comment">                BigDecimal 	pow(int n)</span></span><br><span class="line"><span class="comment">                BigDecimal 	pow(int n, MathContext mc)</span></span><br><span class="line"><span class="comment">                int 	precision()</span></span><br><span class="line"><span class="comment">                BigDecimal 	remainder(BigDecimal divisor)</span></span><br><span class="line"><span class="comment">                BigDecimal 	remainder(BigDecimal divisor, MathContext mc)</span></span><br><span class="line"><span class="comment">                BigDecimal 	round(MathContext mc)</span></span><br><span class="line"><span class="comment">                int 	scale()</span></span><br><span class="line"><span class="comment">                BigDecimal 	scaleByPowerOfTen(int n)</span></span><br><span class="line"><span class="comment">                BigDecimal 	setScale(int newScale)</span></span><br><span class="line"><span class="comment">                    Returns a BigDecimal whose scale is the specified value, and whose value is numerically equal to this BigDecimal&#x27;s.</span></span><br><span class="line"><span class="comment">                BigDecimal 	setScale(int newScale, int roundingMode)</span></span><br><span class="line"><span class="comment">                BigDecimal 	setScale(int newScale, RoundingMode roundingMode)</span></span><br><span class="line"><span class="comment">                    Returns a BigDecimal whose scale is the specified value, and whose unscaled value is determined by multiplying or dividing this BigDecimal&#x27;s unscaled value by the appropriate power of ten to maintain its overall value.</span></span><br><span class="line"><span class="comment">                short 	shortValueExact()</span></span><br><span class="line"><span class="comment">                int 	signum()</span></span><br><span class="line"><span class="comment">                Returns the signum function of this BigDecimal. (1,0,-1)</span></span><br><span class="line"><span class="comment">                BigDecimal 	stripTrailingZeros()</span></span><br><span class="line"><span class="comment">                    Returns a BigDecimal which is numerically equal to this one but with any trailing zeros removed from the representation.</span></span><br><span class="line"><span class="comment">                BigDecimal 	subtract(BigDecimal subtrahend)</span></span><br><span class="line"><span class="comment">                BigDecimal 	subtract(BigDecimal subtrahend, MathContext mc)</span></span><br><span class="line"><span class="comment">                BigInteger 	toBigInteger()</span></span><br><span class="line"><span class="comment">                BigInteger 	toBigIntegerExact()</span></span><br><span class="line"><span class="comment">                String 	toEngineeringString()</span></span><br><span class="line"><span class="comment">                String 	toPlainString()</span></span><br><span class="line"><span class="comment">                String 	toString()</span></span><br><span class="line"><span class="comment">                BigDecimal 	ulp()</span></span><br><span class="line"><span class="comment">                    Returns the size of an ulp, a unit in the last place, of this BigDecimal.</span></span><br><span class="line"><span class="comment">                BigInteger 	unscaledValue()</span></span><br><span class="line"><span class="comment">                static BigDecimal 	valueOf(double val)</span></span><br><span class="line"><span class="comment">                static BigDecimal 	valueOf(long val)</span></span><br><span class="line"><span class="comment">                static BigDecimal 	valueOf(long unscaledVal, int scale)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        BigDecimal test = <span class="keyword">new</span> BigDecimal(<span class="string">&quot;1.234567&quot;</span>);</span><br><span class="line">        test = test.setScale(<span class="number">3</span>, RoundingMode.HALF_UP);</span><br><span class="line">        System.out.println(test);</span><br><span class="line">        test = test.setScale(<span class="number">7</span>, RoundingMode.HALF_EVEN);</span><br><span class="line">        System.out.println(test);</span><br><span class="line">        test = test.divide(<span class="keyword">new</span> BigDecimal(<span class="string">&quot;3&quot;</span>), MathContext.UNLIMITED); <span class="comment">// 默认也是UNLIMITED精度，无限小数会报错</span></span><br><span class="line">        System.out.println(test);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        BigInteger:</span></span><br><span class="line"><span class="comment">            构造方法:</span></span><br><span class="line"><span class="comment">                BigInteger(byte[] val)</span></span><br><span class="line"><span class="comment">                BigInteger(int signum, byte[] magnitude)</span></span><br><span class="line"><span class="comment">                BigInteger(int bitLength, int certainty, Random rnd)</span></span><br><span class="line"><span class="comment">                    Constructs a randomly generated positive BigInteger that is probably prime, with the specified bitLength.</span></span><br><span class="line"><span class="comment">                BigInteger(int numBits, Random rnd)</span></span><br><span class="line"><span class="comment">                    Constructs a randomly generated BigInteger, uniformly distributed over the range 0 to (2numBits - 1), inclusive.</span></span><br><span class="line"><span class="comment">                BigInteger(String val)</span></span><br><span class="line"><span class="comment">                BigInteger(String val, int radix)</span></span><br><span class="line"><span class="comment">            成员方法:</span></span><br><span class="line"><span class="comment">                BigInteger 	abs()</span></span><br><span class="line"><span class="comment">                BigInteger 	add(BigInteger val)</span></span><br><span class="line"><span class="comment">                BigInteger 	and(BigInteger val)</span></span><br><span class="line"><span class="comment">                BigInteger 	andNot(BigInteger val)</span></span><br><span class="line"><span class="comment">                    Returns a BigInteger whose value is (this &amp; ~val).</span></span><br><span class="line"><span class="comment">                int 	bitCount()</span></span><br><span class="line"><span class="comment">                    Returns the number of bits in the two&#x27;s complement representation of this BigInteger that differ from its sign bit.</span></span><br><span class="line"><span class="comment">                int 	bitLength()</span></span><br><span class="line"><span class="comment">                    Returns the number of bits in the minimal two&#x27;s-complement representation of this BigInteger, excluding a sign bit.</span></span><br><span class="line"><span class="comment">                BigInteger 	clearBit(int n)</span></span><br><span class="line"><span class="comment">                    Returns a BigInteger whose value is equivalent to this BigInteger with the designated bit cleared.</span></span><br><span class="line"><span class="comment">                int 	compareTo(BigInteger val)</span></span><br><span class="line"><span class="comment">                BigInteger 	divide(BigInteger val)</span></span><br><span class="line"><span class="comment">                BigInteger[] 	divideAndRemainder(BigInteger val)</span></span><br><span class="line"><span class="comment">                double 	doubleValue()</span></span><br><span class="line"><span class="comment">                boolean 	equals(Object x)</span></span><br><span class="line"><span class="comment">                BigInteger 	flipBit(int n)</span></span><br><span class="line"><span class="comment">                    Returns a BigInteger whose value is equivalent to this BigInteger with the designated bit flipped.</span></span><br><span class="line"><span class="comment">                float 	floatValue()</span></span><br><span class="line"><span class="comment">                BigInteger 	gcd(BigInteger val)</span></span><br><span class="line"><span class="comment">                    Returns a BigInteger whose value is the greatest common divisor of abs(this) and abs(val).</span></span><br><span class="line"><span class="comment">                int 	getLowestSetBit()</span></span><br><span class="line"><span class="comment">                    Returns the index of the rightmost (lowest-order) one bit in this BigInteger (the number of zero bits to the right of the rightmost one bit).</span></span><br><span class="line"><span class="comment">                int 	hashCode()</span></span><br><span class="line"><span class="comment">                int 	intValue()</span></span><br><span class="line"><span class="comment">                boolean 	isProbablePrime(int certainty)</span></span><br><span class="line"><span class="comment">                    Returns true if this BigInteger is probably prime, false if it&#x27;s definitely composite.</span></span><br><span class="line"><span class="comment">                long 	longValue()</span></span><br><span class="line"><span class="comment">                BigInteger 	max(BigInteger val)</span></span><br><span class="line"><span class="comment">                BigInteger 	min(BigInteger val)</span></span><br><span class="line"><span class="comment">                BigInteger 	mod(BigInteger m)</span></span><br><span class="line"><span class="comment">                BigInteger 	modInverse(BigInteger m)</span></span><br><span class="line"><span class="comment">                    Returns a BigInteger whose value is (this^-1 mod m).</span></span><br><span class="line"><span class="comment">                BigInteger 	modPow(BigInteger exponent, BigInteger m)</span></span><br><span class="line"><span class="comment">                BigInteger 	multiply(BigInteger val)</span></span><br><span class="line"><span class="comment">                BigInteger 	negate()</span></span><br><span class="line"><span class="comment">                BigInteger 	nextProbablePrime()</span></span><br><span class="line"><span class="comment">                    Returns the first integer greater than this BigInteger that is probably prime.</span></span><br><span class="line"><span class="comment">                BigInteger 	not()</span></span><br><span class="line"><span class="comment">                BigInteger 	or(BigInteger val)</span></span><br><span class="line"><span class="comment">                BigInteger 	pow(int exponent)</span></span><br><span class="line"><span class="comment">                static BigInteger 	probablePrime(int bitLength, Random rnd)</span></span><br><span class="line"><span class="comment">                    Returns a positive BigInteger that is probably prime, with the specified bitLength.</span></span><br><span class="line"><span class="comment">                BigInteger 	remainder(BigInteger val)</span></span><br><span class="line"><span class="comment">                    Returns a BigInteger whose value is (this % val).</span></span><br><span class="line"><span class="comment">                BigInteger 	setBit(int n)</span></span><br><span class="line"><span class="comment">                    Returns a BigInteger whose value is equivalent to this BigInteger with the designated bit set.</span></span><br><span class="line"><span class="comment">                BigInteger 	shiftLeft(int n)</span></span><br><span class="line"><span class="comment">                    Returns a BigInteger whose value is (this &lt;&lt; n).</span></span><br><span class="line"><span class="comment">                BigInteger 	shiftRight(int n)</span></span><br><span class="line"><span class="comment">                    Returns a BigInteger whose value is (this &gt;&gt; n).</span></span><br><span class="line"><span class="comment">                int 	signum()</span></span><br><span class="line"><span class="comment">                BigInteger 	subtract(BigInteger val)</span></span><br><span class="line"><span class="comment">                boolean 	testBit(int n)</span></span><br><span class="line"><span class="comment">                    Returns true if and only if the designated bit is set.</span></span><br><span class="line"><span class="comment">                byte[] 	toByteArray()</span></span><br><span class="line"><span class="comment">                String 	toString()</span></span><br><span class="line"><span class="comment">                String 	toString(int radix)</span></span><br><span class="line"><span class="comment">                static BigInteger 	valueOf(long val)</span></span><br><span class="line"><span class="comment">                BigInteger 	xor(BigInteger val)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line"></span><br><span class="line">        MyPair[] pairs = <span class="keyword">new</span> MyPair[<span class="number">1000</span>];</span><br><span class="line">        Arrays.sort(pairs);</span><br><span class="line">        Arrays.binarySearch(pairs, <span class="number">1</span>, <span class="number">4</span>, <span class="keyword">new</span> MyPair());</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        二分查找</span></span><br><span class="line"><span class="comment">        如果元素在数组中，则值为0~n-1，否则值为-1~-(n+1)，表示第一个比它大的值的位置，下标从1开始</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        List&lt;MyPair&gt; pairList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        pairList.add(<span class="keyword">new</span> MyPair());</span><br><span class="line">        <span class="comment">//pairList.sort();</span></span><br><span class="line">        pairList.sort(<span class="keyword">new</span> Cmp());</span><br><span class="line">        Collections.shuffle(pairList);</span><br><span class="line">        Collections.swap(pairList, <span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line">        Collections.sort(pairList);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyPair</span> <span class="keyword">implements</span> <span class="title">Comparable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        MyPair b = (MyPair)o;</span><br><span class="line">        <span class="keyword">if</span>(x!=b.x) <span class="keyword">return</span> x&lt;b.x?-<span class="number">1</span>:<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(y!=b.y) <span class="keyword">return</span> y&lt;b.y?-<span class="number">1</span>:<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cmp</span> <span class="keyword">implements</span> <span class="title">Comparator</span>&lt;<span class="title">MyPair</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(MyPair o1, MyPair o2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(o1.x!=o2.x) <span class="keyword">return</span> o1.x&lt;o2.x?-<span class="number">1</span>:<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(o1.y!=o2.y) <span class="keyword">return</span> o1.y&lt;o2.y?-<span class="number">1</span>:<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="关于树的"><a href="#关于树的" class="headerlink" title="关于树的"></a>关于树的</h1><h2 id="树链剖分"><a href="#树链剖分" class="headerlink" title="树链剖分"></a>树链剖分</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,mid,rt&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson mid+1,r,rt&lt;&lt;1|1</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> &amp;a,<span class="keyword">int</span> &amp;b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> temp = a;</span><br><span class="line">    a = b;</span><br><span class="line">    b = temp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e4</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> size[maxn],dep[maxn],top[maxn],fa[maxn],id[maxn],son[maxn];</span><br><span class="line"><span class="keyword">int</span> head[maxn],w[maxn];</span><br><span class="line"><span class="keyword">int</span> n,cnt,totw,m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> next,to;</span><br><span class="line">&#125;G[maxn&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> x==fa[x]?x:find(fa[x]);&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    G[cnt].next = head[u];</span><br><span class="line">    G[cnt].to = v;</span><br><span class="line">    head[u] = cnt++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">    size[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[u];~i;i=G[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> v = G[i].to;</span><br><span class="line">        <span class="keyword">if</span>(v==f) <span class="keyword">continue</span>;</span><br><span class="line">        dep[v] = dep[u]+<span class="number">1</span>;</span><br><span class="line">        fa[v] = u;</span><br><span class="line">        dfs1(v,u);</span><br><span class="line">        <span class="keyword">if</span>(size[v] &gt; size[son[u]]) son[u] = v;</span><br><span class="line">        size[u]+=size[v];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> topu)</span></span>&#123;</span><br><span class="line">    top[u] = topu;</span><br><span class="line">    id[u] = ++totw;</span><br><span class="line">    <span class="keyword">if</span>(son[u]) dfs2(son[u],top[u]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[u];~i;i=G[i].next)&#123;</span><br><span class="line">        <span class="keyword">int</span> v = G[i].to;</span><br><span class="line">        <span class="keyword">if</span>(v==fa[u] || v==son[u]) <span class="keyword">continue</span>;</span><br><span class="line">        dfs2(v,v);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> data[maxn&lt;&lt;<span class="number">2</span>],lazy[maxn&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(lazy[rt]!=<span class="number">0</span>)&#123;</span><br><span class="line">        data[rt&lt;&lt;<span class="number">1</span>] += lazy[rt];</span><br><span class="line">        data[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += lazy[rt];</span><br><span class="line">        lazy[rt&lt;&lt;<span class="number">1</span>] += lazy[rt];</span><br><span class="line">        lazy[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += lazy[rt];</span><br><span class="line">        lazy[rt] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    lazy[rt] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        data[rt] = w[l];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    build(lson); build(rson);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> pos,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r &amp;&amp; l==pos) <span class="keyword">return</span> data[rt];</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    pushdown(rt);</span><br><span class="line">    <span class="keyword">if</span>(pos&lt;=mid) <span class="keyword">return</span> query(pos,lson);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> query(pos,rson);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> val,<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=l &amp;&amp; r&lt;=R)&#123;</span><br><span class="line">        lazy[rt] += val;</span><br><span class="line">        data[rt] += val;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    pushdown(rt);</span><br><span class="line">    <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=mid) update(val,L,R,lson);</span><br><span class="line">    <span class="keyword">if</span>(mid&lt;R) update(val,L,R,rson);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> val)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> t1=top[u],t2=top[v];</span><br><span class="line">    <span class="keyword">while</span>(t1!=t2)&#123;</span><br><span class="line">        <span class="keyword">if</span>(dep[t1]&lt;dep[t2])&#123;</span><br><span class="line">            swap(t1,t2);</span><br><span class="line">            swap(u,v);</span><br><span class="line">        &#125;</span><br><span class="line">        update(val,id[t1],id[u],<span class="number">1</span>,totw,<span class="number">1</span>);</span><br><span class="line">        u = fa[t1];</span><br><span class="line">        t1 = top[u];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dep[u]&gt;dep[v]) swap(u,v);</span><br><span class="line">    update(val,id[u],id[v],<span class="number">1</span>,totw,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> val[maxn];</span><br><span class="line"><span class="keyword">int</span> p;</span><br><span class="line"><span class="keyword">char</span> op[<span class="number">20</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cnt = totw = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line">    dep[<span class="number">1</span>] = fa[<span class="number">1</span>] = size[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(son,<span class="number">0</span>,<span class="keyword">sizeof</span>(son));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;4.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;n,&amp;m,&amp;p))&#123;</span><br><span class="line">        init();</span><br><span class="line">        rep(i,<span class="number">1</span>,n+<span class="number">1</span>) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,val+i);</span><br><span class="line">        rep(i,<span class="number">0</span>,m)&#123;</span><br><span class="line">            <span class="keyword">int</span> u,v;<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;u,&amp;v);</span><br><span class="line">            addedge(u,v); addedge(v,u);</span><br><span class="line">        &#125;</span><br><span class="line">        dfs1(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">        dfs2(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">        rep(i,<span class="number">1</span>,n+<span class="number">1</span>) w[id[i]] = val[i];</span><br><span class="line">        build(<span class="number">1</span>,totw,<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">while</span>(p--)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,op);</span><br><span class="line">            <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;Q&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> x;<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,query(id[x],<span class="number">1</span>,totw,<span class="number">1</span>));</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">int</span> u,v,val;<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;u,&amp;v,&amp;val);</span><br><span class="line">                <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;D&#x27;</span>) val = -val;</span><br><span class="line">                change(u,v,val);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="线段树"><a href="#线段树" class="headerlink" title="线段树"></a>线段树</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,mid,rt&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson mid+1,r,rt&lt;&lt;1|1</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head ----------------------------------------</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span>+<span class="number">20</span>;</span><br><span class="line"><span class="keyword">int</span> T,n,m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sgt</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> maxlen[maxn&lt;&lt;<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">int</span> ll[maxn&lt;&lt;<span class="number">2</span>],rr[maxn&lt;&lt;<span class="number">2</span>],mm[maxn&lt;&lt;<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">int</span> lazy[maxn&lt;&lt;<span class="number">2</span>];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">        lazy[rt] = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">            ll[rt] = rr[rt] = <span class="number">0</span>;</span><br><span class="line">            mm[rt] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        build(lson); build(rson);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        lazy[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(lazy[rt]&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            maxlen[rt] = ll[rt] = rr[rt] = mm[rt] = (lazy[rt]?(r-l+<span class="number">1</span>):<span class="number">0</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> lc = rt&lt;&lt;<span class="number">1</span>,rc = rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">            ll[rt] = ll[lc];</span><br><span class="line">            <span class="keyword">if</span>(ll[lc]==(mid-l+<span class="number">1</span>)) ll[rt] += ll[rc];</span><br><span class="line">            mm[rt] = rr[lc] + ll[rc];</span><br><span class="line">            rr[rt] = rr[rc];</span><br><span class="line">            <span class="keyword">if</span>(rr[rc] == r-mid) rr[rt] += rr[lc];</span><br><span class="line">            maxlen[rt] = max(maxlen[lc],max(maxlen[rc],mm[rt]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(lazy[rt]&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> lc=rt&lt;&lt;<span class="number">1</span>,rc=rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>;</span><br><span class="line">            lazy[lc] = lazy[rc] = lazy[rt];</span><br><span class="line">            lazy[rt] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> val,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">        pushup(l,r,rt);</span><br><span class="line">        <span class="comment">//cout&lt;&lt;l&lt;&lt;&#x27; &#x27;&lt;&lt;r&lt;&lt;&#x27; &#x27;&lt;&lt;&quot;         &quot;;</span></span><br><span class="line">        <span class="keyword">int</span> lc = rt&lt;&lt;<span class="number">1</span>,rc = rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(val&gt;maxlen[rt]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(ll[rt] &gt;= val) <span class="keyword">return</span> l;</span><br><span class="line">        pushdown(rt);</span><br><span class="line">        pushup(rson);</span><br><span class="line">        <span class="keyword">int</span> temp = query(val,lson);</span><br><span class="line">        <span class="keyword">if</span>(temp) <span class="keyword">return</span> temp;</span><br><span class="line">        <span class="keyword">if</span>(mm[rt] &gt;= val) <span class="keyword">return</span> mid-rr[lc]+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> query(val,rson);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> val,<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(L&lt;=l &amp;&amp; r&lt;=R)&#123;</span><br><span class="line">            lazy[rt] = val;</span><br><span class="line">            pushup(l,r,rt);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        pushdown(rt);</span><br><span class="line">        <span class="keyword">int</span> mid = l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(L&lt;=mid) update(val,L,R,lson);</span><br><span class="line">        <span class="keyword">else</span> pushup(lson);</span><br><span class="line">        <span class="keyword">if</span>(mid&lt;R) update(val,L,R,rson);</span><br><span class="line">        <span class="keyword">else</span> pushup(rson);</span><br><span class="line">        pushup(l,r,rt);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;all,ns;</span><br><span class="line"><span class="keyword">char</span> op[<span class="number">20</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;1.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line">    rep(test_case,<span class="number">1</span>,T+<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case %d:\n&quot;</span>,test_case);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">        <span class="comment">//all.build(1,n,1); ns.build(1,n,1);</span></span><br><span class="line">        all.init(); ns.init();</span><br><span class="line">        <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,op);</span><br><span class="line">            <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;D&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> x;<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">                <span class="keyword">int</span> ans = all.query(x,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span>(ans)&#123;</span><br><span class="line">                    all.update(<span class="number">0</span>,ans,ans+x<span class="number">-1</span>,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%d,let&#x27;s fly\n&quot;</span>,ans);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="built_in">puts</span>(<span class="string">&quot;fly with yourself&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;N&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> x;<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">                <span class="keyword">int</span> ans = all.query(x,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span>(!ans) ans = ns.query(x,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span>(ans)&#123;</span><br><span class="line">                    all.update(<span class="number">0</span>,ans,ans+x<span class="number">-1</span>,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">                    ns.update(<span class="number">0</span>,ans,ans+x<span class="number">-1</span>,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%d,don&#x27;t put my gezi\n&quot;</span>,ans);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="built_in">puts</span>(<span class="string">&quot;wait for me&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">int</span> x,y;<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;x,&amp;y);</span><br><span class="line">                all.update(<span class="number">1</span>,x,y,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">                ns.update(<span class="number">1</span>,x,y,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;I am the hope of chinese chengxuyuan!!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="LCA-最近公共父节点-用来求两点之间距离的"><a href="#LCA-最近公共父节点-用来求两点之间距离的" class="headerlink" title="LCA 最近公共父节点 用来求两点之间距离的"></a>LCA 最近公共父节点 用来求两点之间距离的</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for(int i=(a);i&lt;(n);i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i,a,n) for(int i=(n-1);i&gt;=(a);i--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span> &lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pII;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="comment">//head</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> cnt,n,m;</span><br><span class="line"><span class="keyword">int</span> head[maxn];</span><br><span class="line"><span class="keyword">int</span> fa[maxn];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> next,to;</span><br><span class="line">&#125;G[maxn&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    G[cnt].to = v;</span><br><span class="line">    G[cnt].next = head[u];</span><br><span class="line">    head[u] = cnt++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ST</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> tot;</span><br><span class="line">    <span class="keyword">int</span> first[maxn&lt;&lt;<span class="number">1</span>],R[maxn&lt;&lt;<span class="number">1</span>],order[maxn&lt;&lt;<span class="number">1</span>],dp[maxn&lt;&lt;<span class="number">1</span>][<span class="number">20</span>],dis[maxn];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> root)</span></span>&#123;</span><br><span class="line">        tot = <span class="number">0</span>;</span><br><span class="line">        dfs(root,<span class="number">0</span>,<span class="number">-1</span>);</span><br><span class="line">        ST_init(tot);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ST_init</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">        rep(i,<span class="number">1</span>,n+<span class="number">1</span>) dp[i][<span class="number">0</span>] = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;(<span class="number">1</span>&lt;&lt;j)&lt;=n;j++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i+(<span class="number">1</span>&lt;&lt;j)<span class="number">-1</span>&lt;=n;i++)&#123;</span><br><span class="line">                <span class="keyword">int</span> a = dp[i][j<span class="number">-1</span>],b = dp[i+(<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>))][j<span class="number">-1</span>];</span><br><span class="line">                dp[i][j] = R[a]&lt;R[b]?a:b;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">LCA</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x = first[u],y = first[v];</span><br><span class="line">        <span class="keyword">if</span>(x&gt;y) swap(x,y);</span><br><span class="line">        <span class="keyword">int</span> res = RMQ(x,y);</span><br><span class="line">        <span class="keyword">return</span> order[res];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">RMQ</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>((<span class="number">1</span>&lt;&lt;(k+<span class="number">1</span>))&lt;=r-l+<span class="number">1</span>) k++;</span><br><span class="line">        <span class="keyword">int</span> a = dp[l][k],b = dp[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k];</span><br><span class="line">        <span class="keyword">return</span> R[a]&lt;R[b]?a:b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> deep,<span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">        R[++tot] = deep;</span><br><span class="line">        dis[u] = deep;</span><br><span class="line">        order[tot] = u;</span><br><span class="line">        first[u] = tot;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=head[u];~i;i=G[i].next)&#123;</span><br><span class="line">            <span class="keyword">int</span> v = G[i].to;</span><br><span class="line">            <span class="keyword">if</span>(v==f) <span class="keyword">continue</span>;</span><br><span class="line">            dfs(v,deep+<span class="number">1</span>,u);</span><br><span class="line">            order[++tot] = u;</span><br><span class="line">            R[tot] = deep;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;st;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x==fa[x]?x:fa[x] = find(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ind[maxn];</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">60</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line">    <span class="built_in">memset</span>(ind,<span class="number">0</span>,<span class="keyword">sizeof</span>(ind));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">&quot;2.in&quot;</span>,<span class="string">&quot;r&quot;</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">int</span> T;<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">        init();</span><br><span class="line">        <span class="built_in">map</span>&lt;<span class="built_in">string</span>,<span class="keyword">int</span>&gt; mp;</span><br><span class="line">        <span class="keyword">int</span> tot = <span class="number">0</span>;</span><br><span class="line">        rep(i,<span class="number">0</span>,n<span class="number">-1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> u,v;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,s);</span><br><span class="line">            <span class="keyword">if</span>(mp[s]==<span class="number">0</span>) mp[s] = ++tot,u = tot;</span><br><span class="line">            <span class="keyword">else</span> u = mp[s];</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,s);</span><br><span class="line">            <span class="keyword">if</span>(mp[s]==<span class="number">0</span>) mp[s] = ++tot,v = tot;</span><br><span class="line">            <span class="keyword">else</span> v = mp[s];</span><br><span class="line">            addedge(v,u); ind[u]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> root = <span class="number">0</span>;</span><br><span class="line">        rep(i,<span class="number">1</span>,n+<span class="number">1</span>) <span class="keyword">if</span>(ind[i]==<span class="number">0</span>)&#123;</span><br><span class="line">            root = i;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        st.init(root);</span><br><span class="line">        rep(i,<span class="number">0</span>,m)&#123;</span><br><span class="line">            <span class="keyword">int</span> u,v,ans;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,s); u = mp[s];</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,s); v = mp[s];</span><br><span class="line">            <span class="keyword">int</span> rt = st.LCA(u,v);</span><br><span class="line">            <span class="keyword">int</span> x = st.dis[u] - st.dis[rt];</span><br><span class="line">            <span class="keyword">int</span> y = st.dis[v] - st.dis[rt];</span><br><span class="line">            <span class="keyword">if</span>(rt==u) ans = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(rt == v) ans = x;</span><br><span class="line">            <span class="keyword">else</span> ans = x+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(u==v) ans = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-09-05T11:26:39.000Z" title="2018-09-05T11:26:39.000Z">2018-09-05</time>发表</span><span class="level-item"><time dateTime="2018-09-05T11:27:57.328Z" title="2018-09-05T11:27:57.328Z">2018-09-05</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%A8%A1%E6%9D%BF/">模板</a></span><span class="level-item">40 分钟读完 (大约6074个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/%E6%A8%A1%E6%9D%BF/2018/09/05/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95%E6%A8%A1%E6%9D%BF.html">计算几何模板</a></h1><div class="content"><h2 id="J-Distance-to-work"><a href="#J-Distance-to-work" class="headerlink" title="J .Distance to work"></a>J .<a target="_blank" rel="noopener" href="https://www.nowcoder.com/acm/contest/141/J">Distance to work</a></h2><h3 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h3><p>懒得看了</p>
<h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><p>计算几何。</p>
<p>扒一扒dls的板子</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">const</span> db EPS = <span class="number">1e-9</span>;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">sign</span><span class="params">(db a)</span> </span>&#123; <span class="keyword">return</span> a &lt; -EPS ? <span class="number">-1</span> : a &gt; EPS; &#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">cmp</span><span class="params">(db a, db b)</span></span>&#123; <span class="keyword">return</span> sign(a-b); &#125;</span><br><span class="line">   </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">P</span> &#123;</span></span><br><span class="line">    db x, y;</span><br><span class="line">    P() &#123;&#125;</span><br><span class="line">    P(db _x, db _y) : x(_x), y(_y) &#123;&#125;</span><br><span class="line">    P <span class="keyword">operator</span>+(P p) &#123; <span class="keyword">return</span> &#123;x + p.x, y + p.y&#125;; &#125;</span><br><span class="line">    P <span class="keyword">operator</span>-(P p) &#123; <span class="keyword">return</span> &#123;x - p.x, y - p.y&#125;; &#125;</span><br><span class="line">    P <span class="keyword">operator</span>*(db d) &#123; <span class="keyword">return</span> &#123;x * d, y * d&#125;; &#125;</span><br><span class="line">    P <span class="keyword">operator</span>/(db d) &#123; <span class="keyword">return</span> &#123;x / d, y / d&#125;; &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(P p) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> c = cmp(x, p.x);</span><br><span class="line">        <span class="keyword">if</span> (c) <span class="keyword">return</span> c == <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">return</span> cmp(y, p.y) == <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>==(P o) <span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> cmp(x,o.x) == <span class="number">0</span> &amp;&amp; cmp(y,o.y) == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function">db <span class="title">dot</span><span class="params">(P p)</span> </span>&#123; <span class="keyword">return</span> x * p.x + y * p.y; &#125;</span><br><span class="line">    <span class="function">db <span class="title">det</span><span class="params">(P p)</span> </span>&#123; <span class="keyword">return</span> x * p.y - y * p.x; &#125;</span><br><span class="line">      </span><br><span class="line">    <span class="function">db <span class="title">distTo</span><span class="params">(P p)</span> </span>&#123; <span class="keyword">return</span> (*<span class="keyword">this</span>-p).<span class="built_in">abs</span>(); &#125;</span><br><span class="line">    <span class="function">db <span class="title">alpha</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">atan2</span>(y, x); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123; <span class="built_in">cin</span>&gt;&gt;x&gt;&gt;y; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">write</span><span class="params">()</span> </span>&#123;<span class="built_in">cout</span>&lt;&lt;<span class="string">&quot;(&quot;</span>&lt;&lt;x&lt;&lt;<span class="string">&quot;,&quot;</span>&lt;&lt;y&lt;&lt;<span class="string">&quot;)&quot;</span>&lt;&lt;<span class="built_in">endl</span>;&#125;</span><br><span class="line">    <span class="function">db <span class="title">abs</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">sqrt</span>(abs2());&#125;</span><br><span class="line">    <span class="function">db <span class="title">abs2</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> x * x + y * y; &#125;</span><br><span class="line">    <span class="function">P <span class="title">rot90</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> P(-y,x);&#125;</span><br><span class="line">    <span class="function">P <span class="title">unit</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> *<span class="keyword">this</span>/<span class="built_in">abs</span>(); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">quad</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> sign(y) == <span class="number">1</span> || (sign(y) == <span class="number">0</span> &amp;&amp; sign(x) &gt;= <span class="number">0</span>); &#125;</span><br><span class="line">    <span class="function">P <span class="title">rot</span><span class="params">(db an)</span></span>&#123; <span class="keyword">return</span> &#123;x*<span class="built_in">cos</span>(an)-y*<span class="built_in">sin</span>(an),x*<span class="built_in">sin</span>(an) + y*<span class="built_in">cos</span>(an)&#125;; &#125;</span><br><span class="line">&#125;;</span><br><span class="line">   </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">L</span>&#123;</span> <span class="comment">//ps[0] -&gt; ps[1]</span></span><br><span class="line">    P ps[<span class="number">2</span>];</span><br><span class="line">    L() &#123;&#125;</span><br><span class="line">    L(P p1,P p2) &#123; ps[<span class="number">0</span>]=p1; ps[<span class="number">1</span>]=p2; &#125;</span><br><span class="line">    P&amp; <span class="keyword">operator</span>[](<span class="keyword">int</span> i) &#123; <span class="keyword">return</span> ps[i]; &#125;</span><br><span class="line">    <span class="function">P <span class="title">dir</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> ps[<span class="number">1</span>] - ps[<span class="number">0</span>]; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">include</span><span class="params">(P p)</span> </span>&#123; <span class="keyword">return</span> sign((ps[<span class="number">1</span>] - ps[<span class="number">0</span>]).det(p - ps[<span class="number">0</span>])) &gt; <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="function">L <span class="title">push</span><span class="params">()</span></span>&#123; <span class="comment">// push eps outward</span></span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line">        P delta = (ps[<span class="number">1</span>] - ps[<span class="number">0</span>]).rot90().unit() * eps;</span><br><span class="line">        <span class="keyword">return</span> L(ps[<span class="number">0</span>] - delta, ps[<span class="number">1</span>] - delta);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> cross(p1,p2,p3) ((p2.x-p1.x)*(p3.y-p1.y)-(p3.x-p1.x)*(p2.y-p1.y))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> crossOp(p1,p2,p3) sign(cross(p1,p2,p3))</span></span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chkLL</span><span class="params">(P p1, P p2, P q1, P q2)</span> </span>&#123;</span><br><span class="line">    db a1 = cross(q1, q2, p1), a2 = -cross(q1, q2, p2);</span><br><span class="line">    <span class="keyword">return</span> sign(a1+a2) != <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="function">P <span class="title">isLL</span><span class="params">(P p1, P p2, P q1, P q2)</span> </span>&#123;</span><br><span class="line">    db a1 = cross(q1, q2, p1), a2 = -cross(q1, q2, p2);</span><br><span class="line">    <span class="keyword">return</span> (p1 * a2 + p2 * a1) / (a1 + a2);</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function">P <span class="title">isLL</span><span class="params">(L l1,L l2)</span></span>&#123; <span class="keyword">return</span> isLL(l1[<span class="number">0</span>],l1[<span class="number">1</span>],l2[<span class="number">0</span>],l2[<span class="number">1</span>]); &#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">intersect</span><span class="params">(db l1,db r1,db l2,db r2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l1&gt;r1) swap(l1,r1); <span class="keyword">if</span>(l2&gt;r2) swap(l2,r2);</span><br><span class="line">    <span class="keyword">return</span> !( cmp(r1,l2) == <span class="number">-1</span> || cmp(r2,l1) == <span class="number">-1</span> );</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isSS</span><span class="params">(P p1, P p2, P q1, P q2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> intersect(p1.x,p2.x,q1.x,q2.x) &amp;&amp; intersect(p1.y,p2.y,q1.y,q2.y) &amp;&amp;</span><br><span class="line">    crossOp(p1,p2,q1) * crossOp(p1,p2,q2) &lt;= <span class="number">0</span> &amp;&amp; crossOp(q1,q2,p1)</span><br><span class="line">            * crossOp(q1,q2,p2) &lt;= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isSS_strict</span><span class="params">(P p1, P p2, P q1, P q2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> crossOp(p1,p2,q1) * crossOp(p1,p2,q2) &lt; <span class="number">0</span> &amp;&amp; crossOp(q1,q2,p1)</span><br><span class="line">            * crossOp(q1,q2,p2) &lt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isMiddle</span><span class="params">(db a, db m, db b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sign(a - m) == <span class="number">0</span> || sign(b - m) == <span class="number">0</span> || (a &lt; m != b &lt; m);</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isMiddle</span><span class="params">(P a, P m, P b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> isMiddle(a.x, m.x, b.x) &amp;&amp; isMiddle(a.y, m.y, b.y);</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">onSeg</span><span class="params">(P p1, P p2, P q)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> crossOp(p1,p2,q) == <span class="number">0</span> &amp;&amp; isMiddle(p1, q, p2);</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">onSeg_strict</span><span class="params">(P p1, P p2, P q)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> crossOp(p1,p2,q) == <span class="number">0</span> &amp;&amp; sign((q-p1).dot(p1-p2)) * sign((q-p2).dot(p1-p2)) &lt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function">P <span class="title">proj</span><span class="params">(P p1, P p2, P q)</span> </span>&#123;</span><br><span class="line">    P dir = p2 - p1;</span><br><span class="line">    <span class="keyword">return</span> p1 + dir * (dir.dot(q - p1) / dir.abs2());</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function">P <span class="title">reflect</span><span class="params">(P p1, P p2, P q)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> proj(p1,p2,q) * <span class="number">2</span> - q;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function">db <span class="title">nearest</span><span class="params">(P p1,P p2,P q)</span></span>&#123;</span><br><span class="line">    P h = proj(p1,p2,q);</span><br><span class="line">    <span class="keyword">if</span>(isMiddle(p1,h,p2))</span><br><span class="line">        <span class="keyword">return</span> q.distTo(h);</span><br><span class="line">    <span class="keyword">return</span> min(p1.distTo(q),p2.distTo(q));</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function">db <span class="title">disSS</span><span class="params">(P p1, P p2, P q1, P q2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(isSS(p1,p2,q1,q2)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> min(min(nearest(p1,p2,q1),nearest(p1,p2,q2)), min(nearest(q1,q2,p1),nearest(q1,q2,p2)));</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function">db <span class="title">rad</span><span class="params">(P p1,P p2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> atan2l(p1.det(p2),p1.dot(p2));</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function">db <span class="title">incircle</span><span class="params">(P p1, P p2, P p3)</span></span>&#123;</span><br><span class="line">    db A = p1.distTo(p2);</span><br><span class="line">    db B = p2.distTo(p3);</span><br><span class="line">    db C = p3.distTo(p1);</span><br><span class="line">    <span class="keyword">return</span> sqrtl(A*B*C/(A+B+C));</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="comment">//polygon</span></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">db <span class="title">area</span><span class="params">(<span class="built_in">vector</span>&lt;P&gt; ps)</span></span>&#123;</span><br><span class="line">    db ret = <span class="number">0</span>; rep(i,<span class="number">0</span>,ps.size()) ret += ps[i].det(ps[(i+<span class="number">1</span>)%ps.size()]);</span><br><span class="line">    <span class="keyword">return</span> ret/<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">contain</span><span class="params">(<span class="built_in">vector</span>&lt;P&gt; ps, P p)</span></span>&#123; <span class="comment">//2:inside,1:on_seg,0:outside</span></span><br><span class="line">    <span class="keyword">int</span> n = ps.size(), ret = <span class="number">0</span>;</span><br><span class="line">    rep(i,<span class="number">0</span>,n)&#123;</span><br><span class="line">        P u=ps[i],v=ps[(i+<span class="number">1</span>)%n];</span><br><span class="line">        <span class="keyword">if</span>(onSeg(u,v,p)) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(cmp(u.y,v.y)&lt;=<span class="number">0</span>) swap(u,v);</span><br><span class="line">        <span class="keyword">if</span>(cmp(p.y,u.y) &gt;<span class="number">0</span> || cmp(p.y,v.y) &lt;= <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">        ret ^= crossOp(p,u,v) &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret*<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;P&gt; <span class="title">convexHull</span><span class="params">(<span class="built_in">vector</span>&lt;P&gt; ps)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = ps.size(); <span class="keyword">if</span>(n &lt;= <span class="number">1</span>) <span class="keyword">return</span> ps;</span><br><span class="line">    sort(ps.begin(), ps.end());</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;P&gt; <span class="title">qs</span><span class="params">(n * <span class="number">2</span>)</span></span>; <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; qs[k++] = ps[i++])</span><br><span class="line">        <span class="keyword">while</span> (k &gt; <span class="number">1</span> &amp;&amp; crossOp(qs[k - <span class="number">2</span>], qs[k - <span class="number">1</span>], ps[i]) &lt;= <span class="number">0</span>) --k;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">2</span>, t = k; i &gt;= <span class="number">0</span>; qs[k++] = ps[i--])</span><br><span class="line">        <span class="keyword">while</span> (k &gt; t &amp;&amp; crossOp(qs[k - <span class="number">2</span>], qs[k - <span class="number">1</span>], ps[i]) &lt;= <span class="number">0</span>) --k;</span><br><span class="line">    qs.resize(k - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> qs;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;P&gt; <span class="title">convexHullNonStrict</span><span class="params">(<span class="built_in">vector</span>&lt;P&gt; ps)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//caution: need to unique the Ps first</span></span><br><span class="line">    <span class="keyword">int</span> n = ps.size(); <span class="keyword">if</span>(n &lt;= <span class="number">1</span>) <span class="keyword">return</span> ps;</span><br><span class="line">    sort(ps.begin(), ps.end());</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;P&gt; <span class="title">qs</span><span class="params">(n * <span class="number">2</span>)</span></span>; <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; qs[k++] = ps[i++])</span><br><span class="line">        <span class="keyword">while</span> (k &gt; <span class="number">1</span> &amp;&amp; crossOp(qs[k - <span class="number">2</span>], qs[k - <span class="number">1</span>], ps[i]) &lt; <span class="number">0</span>) --k;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">2</span>, t = k; i &gt;= <span class="number">0</span>; qs[k++] = ps[i--])</span><br><span class="line">        <span class="keyword">while</span> (k &gt; t &amp;&amp; crossOp(qs[k - <span class="number">2</span>], qs[k - <span class="number">1</span>], ps[i]) &lt; <span class="number">0</span>) --k;</span><br><span class="line">    qs.resize(k - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> qs;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function">db <span class="title">convexDiameter</span><span class="params">(<span class="built_in">vector</span>&lt;P&gt; ps)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = ps.size(); <span class="keyword">if</span>(n &lt;= <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> is = <span class="number">0</span>, js = <span class="number">0</span>; rep(k,<span class="number">1</span>,n) is = ps[k]&lt;ps[is]?k:is, js = ps[js] &lt; ps[k]?k:js;</span><br><span class="line">    <span class="keyword">int</span> i = is, j = js;</span><br><span class="line">    db ret = ps[i].distTo(ps[j]);</span><br><span class="line">    <span class="keyword">do</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>((ps[(i+<span class="number">1</span>)%n]-ps[i]).det(ps[(j+<span class="number">1</span>)%n]-ps[j]) &gt;= <span class="number">0</span>)</span><br><span class="line">            (++j)%=n;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            (++i)%=n;</span><br><span class="line">        ret = max(ret,ps[i].distTo(ps[j]));</span><br><span class="line">    &#125;<span class="keyword">while</span>(i!=is || j!=js);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;P&gt; <span class="title">convexCut</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;P&gt;&amp;ps, P q1, P q2)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;P&gt; qs;</span><br><span class="line">    <span class="keyword">int</span> n = ps.size();</span><br><span class="line">    rep(i,<span class="number">0</span>,n)&#123;</span><br><span class="line">        P p1 = ps[i], p2 = ps[(i+<span class="number">1</span>)%n];</span><br><span class="line">        <span class="keyword">int</span> d1 = crossOp(q1,q2,p1), d2 = crossOp(q1,q2,p2);</span><br><span class="line">        <span class="keyword">if</span>(d1 &gt;= <span class="number">0</span>) qs.pb(p1);</span><br><span class="line">        <span class="keyword">if</span>(d1 * d2 &lt; <span class="number">0</span>) qs.pb(isLL(p1,p2,q1,q2));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> qs;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="comment">//min_dist</span></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">db <span class="title">min_dist</span><span class="params">(<span class="built_in">vector</span>&lt;P&gt;&amp;ps,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(r-l&lt;=<span class="number">5</span>)&#123;</span><br><span class="line">        db ret = <span class="number">1e100</span>;</span><br><span class="line">        rep(i,l,r) rep(j,l,i) ret = min(ret,ps[i].distTo(ps[j]));</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> m = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    db ret = min(min_dist(ps,l,m),min_dist(ps,m,r));</span><br><span class="line">    <span class="built_in">vector</span>&lt;P&gt; qs; rep(i,l,r) <span class="keyword">if</span>(<span class="built_in">abs</span>(ps[i].x-ps[m].x)&lt;= ret) qs.pb(ps[i]);</span><br><span class="line">    sort(qs.begin(), qs.end(),[](P a,P b) -&gt; <span class="keyword">bool</span> &#123;<span class="keyword">return</span> a.y&lt;b.y; &#125;);</span><br><span class="line">    rep(i,<span class="number">1</span>,qs.size()) <span class="keyword">for</span>(<span class="keyword">int</span> j=i<span class="number">-1</span>;j&gt;=<span class="number">0</span>&amp;&amp;qs[j].y&gt;=qs[i].y-ret;--j)</span><br><span class="line">        ret = min(ret,qs[i].distTo(qs[j]));</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">type</span><span class="params">(P o1,db r1,P o2,db r2)</span></span>&#123;</span><br><span class="line">    db d = o1.distTo(o2);</span><br><span class="line">    <span class="keyword">if</span>(cmp(d,r1+r2) == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">if</span>(cmp(d,r1+r2) == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">if</span>(cmp(d,<span class="built_in">abs</span>(r1-r2)) == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(cmp(d,<span class="built_in">abs</span>(r1-r2)) == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;P&gt; <span class="title">isCL</span><span class="params">(P o,db r,P p1,P p2)</span></span>&#123;</span><br><span class="line">    db x = (p1-o).dot(p2-p1), y = (p2-p1).abs2(), d = x * x - y * ((p1-o).abs2() - r*r);</span><br><span class="line">    <span class="keyword">if</span>(sign(d) &lt; <span class="number">0</span>) <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    d = max(d,<span class="number">0.0</span>); P m = p1 - (p2-p1)*(x/y), dr = (p2-p1)*(<span class="built_in">sqrt</span>(d)/y);</span><br><span class="line">    <span class="keyword">return</span> &#123;m-dr,m+dr&#125;; <span class="comment">//along dir: p1-&gt;p2</span></span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;P&gt; <span class="title">isCC</span><span class="params">(P o1, db r1, P o2, db r2)</span> </span>&#123; <span class="comment">//need to check whether two circles are the same</span></span><br><span class="line">    db d = o1.distTo(o2);</span><br><span class="line">    <span class="keyword">if</span> (cmp(d, r1 + r2) == <span class="number">1</span>) <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    <span class="keyword">if</span> (cmp(d,<span class="built_in">abs</span>(r1-r2))==<span class="number">-1</span>) <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    d = min(d, r1 + r2);</span><br><span class="line">    db y = (r1 * r1 + d * d - r2 * r2) / (<span class="number">2</span> * d), x = <span class="built_in">sqrt</span>(r1 * r1 - y * y);</span><br><span class="line">    P dr = (o2 - o1).unit();</span><br><span class="line">    P q1 = o1 + dr * y, q2 = dr.rot90() * x;</span><br><span class="line">    <span class="keyword">return</span> &#123;q1-q2,q1+q2&#125;;<span class="comment">//along circle 1</span></span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;P&gt; <span class="title">tanCP</span><span class="params">(P o, db r, P p)</span> </span>&#123;</span><br><span class="line">    db x = (p - o).abs2(), d = x - r * r;</span><br><span class="line">    <span class="keyword">if</span> (sign(d) &lt;= <span class="number">0</span>) <span class="keyword">return</span> &#123;&#125;; <span class="comment">// on circle =&gt; no tangent</span></span><br><span class="line">    P q1 = o + (p - o) * (r * r / x);</span><br><span class="line">    P q2 = (p - o).rot90() * (r * <span class="built_in">sqrt</span>(d) / x);</span><br><span class="line">    <span class="keyword">return</span> &#123;q1-q2,q1+q2&#125;; <span class="comment">//counter clock-wise</span></span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;L&gt; <span class="title">extanCC</span><span class="params">(P o1, db r1, P o2, db r2)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;L&gt; ret;</span><br><span class="line">    <span class="keyword">if</span> (cmp(r1, r2) == <span class="number">0</span>) &#123;</span><br><span class="line">        P dr = (o2 - o1).unit().rot90() * r1;</span><br><span class="line">        ret.pb(L(o1 + dr, o2 + dr)), ret.pb(L(o1 - dr, o2 - dr));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        P p = (o2 * r1 - o1 * r2) / (r1 - r2);</span><br><span class="line">        <span class="built_in">vector</span>&lt;P&gt; ps = tanCP(o1, r1, p), qs = tanCP(o2, r2, p);</span><br><span class="line">        rep(i,<span class="number">0</span>,min(ps.size(),qs.size())) ret.pb(L(ps[i], qs[i])); <span class="comment">//c1 counter-clock wise</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;L&gt; <span class="title">intanCC</span><span class="params">(P o1, db r1, P o2, db r2)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;L&gt; ret;</span><br><span class="line">    P p = (o1 * r2 + o2 * r1) / (r1 + r2);</span><br><span class="line">    <span class="built_in">vector</span>&lt;P&gt; ps = tanCP(o1,r1,p), qs = tanCP(o2,r2,p);</span><br><span class="line">    rep(i,<span class="number">0</span>,min(ps.size(),qs.size())) ret.pb(L(ps[i], qs[i])); <span class="comment">//c1 counter-clock wise</span></span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function">db <span class="title">areaCT</span><span class="params">(db r, P p1, P p2)</span></span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;P&gt; is = isCL(P(<span class="number">0</span>,<span class="number">0</span>),r,p1,p2);</span><br><span class="line">    <span class="keyword">if</span>(is.empty()) <span class="keyword">return</span> r*r*rad(p1,p2)/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">bool</span> b1 = cmp(p1.abs2(),r*r) == <span class="number">1</span>, b2 = cmp(p2.abs2(), r*r) == <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(b1 &amp;&amp; b2)&#123;</span><br><span class="line">        <span class="keyword">if</span>(sign((p1-is[<span class="number">0</span>]).dot(p2-is[<span class="number">0</span>])) &lt;= <span class="number">0</span> &amp;&amp;</span><br><span class="line">            sign((p1-is[<span class="number">0</span>]).dot(p2-is[<span class="number">0</span>])) &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> r*r*(rad(p1,is[<span class="number">0</span>]) + rad(is[<span class="number">1</span>],p2))/<span class="number">2</span> + is[<span class="number">0</span>].det(is[<span class="number">1</span>])/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> r*r*rad(p1,p2)/<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(b1) <span class="keyword">return</span> (r*r*rad(p1,is[<span class="number">0</span>]) + is[<span class="number">0</span>].det(p2))/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(b2) <span class="keyword">return</span> (p1.det(is[<span class="number">1</span>]) + r*r*rad(is[<span class="number">1</span>],p2))/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">return</span> p1.det(p2)/<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">parallel</span><span class="params">(L l0, L l1)</span> </span>&#123; <span class="keyword">return</span> sign( l0.dir().det( l1.dir() ) ) == <span class="number">0</span>; &#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">sameDir</span><span class="params">(L l0, L l1)</span> </span>&#123; <span class="keyword">return</span> parallel(l0, l1) &amp;&amp; sign(l0.dir().dot(l1.dir()) ) == <span class="number">1</span>; &#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span> <span class="params">(P a,  P b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a.quad() != b.quad()) &#123;</span><br><span class="line">        <span class="keyword">return</span> a.quad() &lt; b.quad();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sign( a.det(b) ) &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (L l0, L l1) &#123;</span><br><span class="line">    <span class="keyword">if</span> (sameDir(l0, l1)) &#123;</span><br><span class="line">        <span class="keyword">return</span> l1.include(l0[<span class="number">0</span>]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> cmp( l0.dir(), l1.dir() );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(L u, L v, L w)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> w.include(isLL(u,v));</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;P&gt; <span class="title">halfPlaneIS</span><span class="params">(<span class="built_in">vector</span>&lt;L&gt; &amp;l)</span> </span>&#123;</span><br><span class="line">    sort(l.begin(), l.end());</span><br><span class="line">    <span class="built_in">deque</span>&lt;L&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)l.size(); ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &amp;&amp; sameDir(l[i], l[i - <span class="number">1</span>])) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">while</span> (q.size() &gt; <span class="number">1</span> &amp;&amp; !check(q[q.size() - <span class="number">2</span>], q[q.size() - <span class="number">1</span>], l[i])) q.pop_back();</span><br><span class="line">        <span class="keyword">while</span> (q.size() &gt; <span class="number">1</span> &amp;&amp; !check(q[<span class="number">1</span>], q[<span class="number">0</span>], l[i])) q.pop_front();</span><br><span class="line">        q.push_back(l[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (q.size() &gt; <span class="number">2</span> &amp;&amp; !check(q[q.size() - <span class="number">2</span>], q[q.size() - <span class="number">1</span>], q[<span class="number">0</span>])) q.pop_back();</span><br><span class="line">    <span class="keyword">while</span> (q.size() &gt; <span class="number">2</span> &amp;&amp; !check(q[<span class="number">1</span>], q[<span class="number">0</span>], q[q.size() - <span class="number">1</span>])) q.pop_front();</span><br><span class="line">    <span class="built_in">vector</span>&lt;P&gt; ret;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)q.size(); ++i) ret.push_back(isLL(q[i], q[(i + <span class="number">1</span>) % q.size()]));</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="function">P <span class="title">inCenter</span><span class="params">(P A, P B, P C)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> a = (B - C).<span class="built_in">abs</span>(), b = (C - A).<span class="built_in">abs</span>(), c = (A - B).<span class="built_in">abs</span>();</span><br><span class="line">    <span class="keyword">return</span> (A * a + B * b + C * c) / (a + b + c);</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="function">P <span class="title">circumCenter</span><span class="params">(P a, P b, P c)</span> </span>&#123;</span><br><span class="line">    P bb = b - a, cc = c - a;</span><br><span class="line">    <span class="keyword">double</span> db = bb.abs2(), dc = cc.abs2(), d = <span class="number">2</span> * bb.det(cc);</span><br><span class="line">    <span class="keyword">return</span> a - P(bb.y * dc - cc.y * db, cc.x * db - bb.x * dc) / d;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="function">P <span class="title">othroCenter</span><span class="params">(P a, P b, P c)</span> </span>&#123;</span><br><span class="line">    P ba = b - a, ca = c - a, bc = b - c;</span><br><span class="line">    <span class="keyword">double</span> Y = ba.y * ca.y * bc.y,</span><br><span class="line">    A = ca.x * ba.y - ba.x * ca.y,</span><br><span class="line">    x0 = (Y + ca.x * ba.y * b.x - ba.x * ca.y * c.x) / A,</span><br><span class="line">    y0 = -ba.x * (x0 - c.x) / ba.y + ca.y;</span><br><span class="line">    <span class="keyword">return</span> &#123;x0, y0&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="AC代码（别人家的模板。）"><a href="#AC代码（别人家的模板。）" class="headerlink" title="AC代码（别人家的模板。）"></a>AC代码（别人家的模板。）</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>; <span class="comment">// 计算几何模板</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, x, n) for (int i = x; i &lt; n; ++i)</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> inf = <span class="number">1e20</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxp = <span class="number">1010</span>;</span><br><span class="line"><span class="comment">// Compares a double to zero</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sgn</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(x) &lt; eps) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// square of a double</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">sqr</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x * x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">15 * Point</span></span><br><span class="line"><span class="comment">16 * Point() - Empty constructor</span></span><br><span class="line"><span class="comment">17 * Point(double _x,double _y) - constructor</span></span><br><span class="line"><span class="comment">18 * input() - double input</span></span><br><span class="line"><span class="comment">19 * output() - %.2f output</span></span><br><span class="line"><span class="comment">20 * operator == - compares x and y</span></span><br><span class="line"><span class="comment">21 * operator &lt; - compares first by x, then by y</span></span><br><span class="line"><span class="comment">22 * operator - - return new Point after subtracting</span></span><br><span class="line"><span class="comment">curresponging x and y</span></span><br><span class="line"><span class="comment">23 * operator ^ - cross product of 2d points</span></span><br><span class="line"><span class="comment">24 * operator * - dot product</span></span><br><span class="line"><span class="comment">25 * len() - gives length from origin</span></span><br><span class="line"><span class="comment">26 * len2() - gives square of length from origin</span></span><br><span class="line"><span class="comment">27 * distance(Point p) - gives distance from p</span></span><br><span class="line"><span class="comment">28 * operator + Point b - returns new Point after adding</span></span><br><span class="line"><span class="comment">curresponging x and y</span></span><br><span class="line"><span class="comment">29 * operator * double k - returns new Point after multiplieing x and</span></span><br><span class="line"><span class="comment">y by k</span></span><br><span class="line"><span class="comment">30 * operator / double k - returns new Point after divideing x and y</span></span><br><span class="line"><span class="comment">by k</span></span><br><span class="line"><span class="comment">31 * rad(Point a,Point b) - returns the angle of Point a and Point b</span></span><br><span class="line"><span class="comment">from this Point</span></span><br><span class="line"><span class="comment">32 * trunc(double r) - return Point that if truncated the</span></span><br><span class="line"><span class="comment">distance from center to r</span></span><br><span class="line"><span class="comment">33 * rotleft() - returns 90 degree ccw rotated point</span></span><br><span class="line"><span class="comment">34 * rotright() - returns 90 degree cw rotated point</span></span><br><span class="line"><span class="comment">35 * rotate(Point p,double angle) - returns Point after rotateing the</span></span><br><span class="line"><span class="comment">Point centering at p by angle radian ccw</span></span><br><span class="line"><span class="comment">36 */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line">    Point() &#123;&#125;</span><br><span class="line">    Point(<span class="keyword">double</span> _x, <span class="keyword">double</span> _y) &#123;</span><br><span class="line">        x = _x;</span><br><span class="line">        y = _y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lf%lf&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.2f␣%.2f\n&quot;</span>, x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>==(Point b) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sgn(x - b.x) == <span class="number">0</span> &amp;&amp; sgn(y - b.y) == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(Point b) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sgn(x - b.x) == <span class="number">0</span> ? sgn(y - b.y) &lt; <span class="number">0</span> : x &lt; b.x;</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span>-(<span class="keyword">const</span> Point &amp;b) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Point(x - b.x, y - b.y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//叉积</span></span><br><span class="line">    <span class="keyword">double</span> <span class="keyword">operator</span>^(<span class="keyword">const</span> Point &amp;b) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x * b.y - y * b.x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//点积</span></span><br><span class="line">    <span class="keyword">double</span> <span class="keyword">operator</span>*(<span class="keyword">const</span> Point &amp;b) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x * b.x + y * b.y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回长度</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">len</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hypot(x, y); <span class="comment">//库函数</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回长度的平方</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">len2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x * x + y * y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回两点的距离</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">distance</span><span class="params">(Point p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hypot(x - p.x, y - p.y);</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span>+(<span class="keyword">const</span> Point &amp;b) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Point(x + b.x, y + b.y);</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span>*(<span class="keyword">const</span> <span class="keyword">double</span> &amp;k) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Point(x * k, y * k);</span><br><span class="line">    &#125;</span><br><span class="line">    Point <span class="keyword">operator</span>/(<span class="keyword">const</span> <span class="keyword">double</span> &amp;k) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Point(x / k, y / k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//计算 pa 和 pb 的夹角</span></span><br><span class="line">    <span class="comment">//就是求这个点看 a,b 所成的夹角</span></span><br><span class="line">    <span class="comment">//测试 LightOJ1203</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">rad</span><span class="params">(Point a, Point b)</span> </span>&#123;</span><br><span class="line">        Point p = *<span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">fabs</span>(<span class="built_in">atan2</span>(<span class="built_in">fabs</span>((a - p) ^ (b - p)), (a - p) * (b - p)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//化为长度为 r 的向量</span></span><br><span class="line">    <span class="function">Point <span class="title">trunc</span><span class="params">(<span class="keyword">double</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> l = len();</span><br><span class="line">        <span class="keyword">if</span> (!sgn(l)) <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">        r /= l;</span><br><span class="line">        <span class="keyword">return</span> Point(x * r, y * r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//逆时针旋转 90 度</span></span><br><span class="line">    <span class="function">Point <span class="title">rotleft</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Point(-y, x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//顺时针旋转 90 度</span></span><br><span class="line">    <span class="function">Point <span class="title">rotright</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Point(y, -x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//绕着 p 点逆时针旋转 angle</span></span><br><span class="line">    <span class="function">Point <span class="title">rotate</span><span class="params">(Point p, <span class="keyword">double</span> angle)</span> </span>&#123;</span><br><span class="line">        Point v = (*<span class="keyword">this</span>) - p;</span><br><span class="line">        <span class="keyword">double</span> c = <span class="built_in">cos</span>(angle), s = <span class="built_in">sin</span>(angle);</span><br><span class="line">        <span class="keyword">return</span> Point(p.x + v.x * c - v.y * s, p.y + v.x * s + v.y * c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Stores two points</span></span><br><span class="line"><span class="comment"> * Line() - Empty constructor</span></span><br><span class="line"><span class="comment"> * Line(Point _s,Point _e) - Line through _s and _e</span></span><br><span class="line"><span class="comment"> * operator == - checks if two points are same</span></span><br><span class="line"><span class="comment"> * Line(Point p,double angle) - one end p , another end at angle degree</span></span><br><span class="line"><span class="comment"> * Line(double a,double b,double c) - Line of equation ax + by + c = 0</span></span><br><span class="line"><span class="comment"> * input() - inputs s and e</span></span><br><span class="line"><span class="comment"> * adjust() - orders in such a way that s &lt; e</span></span><br><span class="line"><span class="comment"> * length() - distance of se</span></span><br><span class="line"><span class="comment"> * angle() - return 0 &lt;= angle &lt; pi</span></span><br><span class="line"><span class="comment"> * relation(Point p) - 3 if point is on line</span></span><br><span class="line"><span class="comment"> * 1 if point on the left of line</span></span><br><span class="line"><span class="comment"> * 2 if point on the right of line</span></span><br><span class="line"><span class="comment"> * pointonseg(double p) - return true if point on segment</span></span><br><span class="line"><span class="comment"> * parallel(Line v) - return true if they are parallel</span></span><br><span class="line"><span class="comment"> * segcrossseg(Line v) - returns 0 if does not intersect</span></span><br><span class="line"><span class="comment"> * returns 1 if non - standard intersection</span></span><br><span class="line"><span class="comment"> * returns 2 if intersects</span></span><br><span class="line"><span class="comment"> * linecrossseg(Line v) - line and seg</span></span><br><span class="line"><span class="comment"> * linecrossline(Line v) - 0 if parallel</span></span><br><span class="line"><span class="comment"> * 1 if coincides</span></span><br><span class="line"><span class="comment"> * 2 if intersects</span></span><br><span class="line"><span class="comment"> * crosspoint(Line v) - returns intersection point</span></span><br><span class="line"><span class="comment"> * dispointtoline(Point p) - distance from point p to the line</span></span><br><span class="line"><span class="comment"> * dispointtoseg(Point p) - distance from p to the segment</span></span><br><span class="line"><span class="comment"> * dissegtoseg(Line v) - distance of two segment</span></span><br><span class="line"><span class="comment"> * lineprog(Point p) - returns projected point p on se line</span></span><br><span class="line"><span class="comment"> * symmetrypoint(Point p) - returns reflection point of p over se</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Line</span> &#123;</span></span><br><span class="line">    Point s, e;</span><br><span class="line">    Line() &#123;&#125;</span><br><span class="line">    Line(Point _s, Point _e) &#123;</span><br><span class="line">        s = _s;</span><br><span class="line">        e = _e;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>==(Line v) &#123;</span><br><span class="line">        <span class="keyword">return</span> (s == v.s) &amp;&amp; (e == v.e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//根据一个点和倾斜角 angle 确定直线,0&lt;=angle&lt;pi</span></span><br><span class="line">    Line(Point p, <span class="keyword">double</span> angle) &#123;</span><br><span class="line">        s = p;</span><br><span class="line">        <span class="keyword">if</span> (sgn(angle - pi / <span class="number">2</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">            e = (s + Point(<span class="number">0</span>, <span class="number">1</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            e = (s + Point(<span class="number">1</span>, <span class="built_in">tan</span>(angle)));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ax+by+c=0</span></span><br><span class="line">    Line(<span class="keyword">double</span> a, <span class="keyword">double</span> b, <span class="keyword">double</span> c) &#123;</span><br><span class="line">        <span class="keyword">if</span> (sgn(a) == <span class="number">0</span>) &#123;</span><br><span class="line">            s = Point(<span class="number">0</span>, -c / b);</span><br><span class="line">            e = Point(<span class="number">1</span>, -c / b);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sgn(b) == <span class="number">0</span>) &#123;</span><br><span class="line">            s = Point(-c / a, <span class="number">0</span>);</span><br><span class="line">            e = Point(-c / a, <span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            s = Point(<span class="number">0</span>, -c / b);</span><br><span class="line">            e = Point(<span class="number">1</span>, (-c - a) / b);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        s.input();</span><br><span class="line">        e.input();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">adjust</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (e &lt; s) swap(s, e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//求线段长度</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">length</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> s.distance(e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回直线倾斜角 0&lt;=angle&lt;pi</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">angle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> k = <span class="built_in">atan2</span>(e.y - s.y, e.x - s.x);</span><br><span class="line">        <span class="keyword">if</span> (sgn(k) &lt; <span class="number">0</span>) k += pi;</span><br><span class="line">        <span class="keyword">if</span> (sgn(k - pi) == <span class="number">0</span>) k -= pi;</span><br><span class="line">        <span class="keyword">return</span> k;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//点和直线关系</span></span><br><span class="line">    <span class="comment">// 1 在左侧</span></span><br><span class="line">    <span class="comment">// 2 在右侧</span></span><br><span class="line">    <span class="comment">// 3 在直线上</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">relation</span><span class="params">(Point p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> c = sgn((p - s) ^ (e - s));</span><br><span class="line">        <span class="keyword">if</span> (c &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (c &gt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 点在线段上的判断</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">pointonseg</span><span class="params">(Point p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sgn((p - s) ^ (e - s)) == <span class="number">0</span> &amp;&amp; sgn((p - s) * (p - e)) &lt;= <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//两向量平行 (对应直线平行或重合)</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">parallel</span><span class="params">(Line v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sgn((e - s) ^ (v.e - v.s)) == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//两线段相交判断</span></span><br><span class="line">    <span class="comment">// 2 规范相交</span></span><br><span class="line">    <span class="comment">// 1 非规范相交</span></span><br><span class="line">    <span class="comment">// 0 不相交</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">segcrossseg</span><span class="params">(Line v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> d1 = sgn((e - s) ^ (v.s - s));</span><br><span class="line">        <span class="keyword">int</span> d2 = sgn((e - s) ^ (v.e - s));</span><br><span class="line">        <span class="keyword">int</span> d3 = sgn((v.e - v.s) ^ (s - v.s));</span><br><span class="line">        <span class="keyword">int</span> d4 = sgn((v.e - v.s) ^ (e - v.s));</span><br><span class="line">        <span class="keyword">if</span> ((d1 ^ d2) == <span class="number">-2</span> &amp;&amp; (d3 ^ d4) == <span class="number">-2</span>) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">return</span> (d1 == <span class="number">0</span> &amp;&amp; sgn((v.s - s) * (v.s - e)) &lt;= <span class="number">0</span>) || (d2 == <span class="number">0</span> &amp;&amp; sgn((v.e - s) * (v.e - e)) &lt;= <span class="number">0</span>) || (d3 == <span class="number">0</span> &amp;&amp; sgn((s - v.s) * (s - v.e)) &lt;= <span class="number">0</span>) || (d4 == <span class="number">0</span> &amp;&amp; sgn((e - v.s) * (e - v.e)) &lt;= <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//直线和线段相交判断</span></span><br><span class="line">    <span class="comment">//-*this line -v seg</span></span><br><span class="line">    <span class="comment">// 2 规范相交</span></span><br><span class="line">    <span class="comment">// 1 非规范相交</span></span><br><span class="line">    <span class="comment">// 0 不相交</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">linecrossseg</span><span class="params">(Line v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> d1 = sgn((e - s) ^ (v.s - s));</span><br><span class="line">        <span class="keyword">int</span> d2 = sgn((e - s) ^ (v.e - s));</span><br><span class="line">        <span class="keyword">if</span> ((d1 ^ d2) == <span class="number">-2</span>) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">return</span> (d1 == <span class="number">0</span> || d2 == <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//两直线关系</span></span><br><span class="line">    <span class="comment">// 0 平行</span></span><br><span class="line">    <span class="comment">// 1 重合</span></span><br><span class="line">    <span class="comment">// 2 相交</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">linecrossline</span><span class="params">(Line v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ((*<span class="keyword">this</span>).parallel(v)) <span class="keyword">return</span> v.relation(s) == <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//求两直线的交点</span></span><br><span class="line">    <span class="comment">//要保证两直线不平行或重合</span></span><br><span class="line">    <span class="function">Point <span class="title">crosspoint</span><span class="params">(Line v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> a1 = (v.e - v.s) ^ (s - v.s);</span><br><span class="line">        <span class="keyword">double</span> a2 = (v.e - v.s) ^ (e - v.s);</span><br><span class="line">        <span class="keyword">return</span> Point((s.x * a2 - e.x * a1) / (a2 - a1), (s.y * a2 - e.y * a1) / (a2 - a1));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//点到直线的距离</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">dispointtoline</span><span class="params">(Point p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">fabs</span>((p - s) ^ (e - s)) / length();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//点到线段的距离</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">dispointtoseg</span><span class="params">(Point p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (sgn((p - s) * (e - s)) &lt; <span class="number">0</span> || sgn((p - e) * (s - e)) &lt; <span class="number">0</span>) <span class="keyword">return</span> min(p.distance(s), p.distance(e));</span><br><span class="line">        <span class="keyword">return</span> dispointtoline(p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回线段到线段的距离</span></span><br><span class="line">    <span class="comment">//前提是两线段不相交，相交距离就是 0 了</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">dissegtoseg</span><span class="params">(Line v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> min(min(dispointtoseg(v.s), dispointtoseg(v.e)), min(v.dispointtoseg(s), v.dispointtoseg(e)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回点 p 在直线上的投影</span></span><br><span class="line">    <span class="function">Point <span class="title">lineprog</span><span class="params">(Point p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> s + (((e - s) * ((e - s) * (p - s))) / ((e - s).len2()));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回点 p 关于直线的对称点</span></span><br><span class="line">    <span class="function">Point <span class="title">symmetrypoint</span><span class="params">(Point p)</span> </span>&#123;</span><br><span class="line">        Point q = lineprog(p);</span><br><span class="line">        <span class="keyword">return</span> Point(<span class="number">2</span> * q.x - p.x, <span class="number">2</span> * q.y - p.y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">circle</span> &#123;</span></span><br><span class="line">    Point p;  <span class="comment">//圆心</span></span><br><span class="line">    <span class="keyword">double</span> r; <span class="comment">//半径</span></span><br><span class="line">    circle() &#123;&#125;</span><br><span class="line">    circle(Point _p, <span class="keyword">double</span> _r) &#123;</span><br><span class="line">        p = _p;</span><br><span class="line">        r = _r;</span><br><span class="line">    &#125;</span><br><span class="line">    circle(<span class="keyword">double</span> x, <span class="keyword">double</span> y, <span class="keyword">double</span> _r) &#123;</span><br><span class="line">        p = Point(x, y);</span><br><span class="line">        r = _r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//三角形的外接圆</span></span><br><span class="line">    <span class="comment">//需要 Point 的 + / rotate() 以及 Line 的 crosspoint()</span></span><br><span class="line">    <span class="comment">//利用两条边的中垂线得到圆心</span></span><br><span class="line">    <span class="comment">//测试：UVA12304</span></span><br><span class="line">    circle(Point a, Point b, Point c) &#123;</span><br><span class="line">        Line u = Line((a + b) / <span class="number">2</span>, ((a + b) / <span class="number">2</span>) + ((b - a).rotleft()));</span><br><span class="line">        Line v = Line((b + c) / <span class="number">2</span>, ((b + c) / <span class="number">2</span>) + ((c - b).rotleft()));</span><br><span class="line">        p = u.crosspoint(v);</span><br><span class="line">        r = p.distance(a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//三角形的内切圆</span></span><br><span class="line">    <span class="comment">//参数 bool t 没有作用，只是为了和上面外接圆函数区别</span></span><br><span class="line">    <span class="comment">//测试：UVA12304</span></span><br><span class="line">    circle(Point a, Point b, Point c, <span class="keyword">bool</span> t) &#123;</span><br><span class="line">        Line u, v;</span><br><span class="line">        <span class="keyword">double</span> m = <span class="built_in">atan2</span>(b.y - a.y, b.x - a.x), n = <span class="built_in">atan2</span>(c.y - a.y, c.x - a.x);</span><br><span class="line">        u.s = a;</span><br><span class="line">        u.e = u.s + Point(<span class="built_in">cos</span>((n + m) / <span class="number">2</span>), <span class="built_in">sin</span>((n + m) / <span class="number">2</span>));</span><br><span class="line">        v.s = b;</span><br><span class="line">        m = <span class="built_in">atan2</span>(a.y - b.y, a.x - b.x), n = <span class="built_in">atan2</span>(c.y - b.y, c.x - b.x);</span><br><span class="line">        v.e = v.s + Point(<span class="built_in">cos</span>((n + m) / <span class="number">2</span>), <span class="built_in">sin</span>((n + m) / <span class="number">2</span>));</span><br><span class="line">        p = u.crosspoint(v);</span><br><span class="line">        r = Line(a, b).dispointtoseg(p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//输入</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        p.input();</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//输出</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.2lf␣%.2lf␣%.2lf\n&quot;</span>, p.x, p.y, r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>==(circle v) &#123;</span><br><span class="line">        <span class="keyword">return</span> (p == v.p) &amp;&amp; sgn(r - v.r) == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(circle v) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ((p &lt; v.p) || ((p == v.p) &amp;&amp; sgn(r - v.r) &lt; <span class="number">0</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//面积</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">area</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> pi * r * r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//周长</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">circumference</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span> * pi * r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//点和圆的关系</span></span><br><span class="line">    <span class="comment">// 0 圆外</span></span><br><span class="line">    <span class="comment">// 1 圆上</span></span><br><span class="line">    <span class="comment">// 2 圆内</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">relation</span><span class="params">(Point b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> dst = b.distance(p);</span><br><span class="line">        <span class="keyword">if</span> (sgn(dst - r) &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (sgn(dst - r) == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//线段和圆的关系</span></span><br><span class="line">    <span class="comment">//比较的是圆心到线段的距离和半径的关系</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">relationseg</span><span class="params">(Line v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> dst = v.dispointtoseg(p);</span><br><span class="line">        <span class="keyword">if</span> (sgn(dst - r) &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (sgn(dst - r) == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//直线和圆的关系</span></span><br><span class="line">    <span class="comment">//比较的是圆心到直线的距离和半径的关系</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">relationline</span><span class="params">(Line v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> dst = v.dispointtoline(p);</span><br><span class="line">        <span class="keyword">if</span> (sgn(dst - r) &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (sgn(dst - r) == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//两圆的关系</span></span><br><span class="line">    <span class="comment">// 5 相离</span></span><br><span class="line">    <span class="comment">// 4 外切</span></span><br><span class="line">    <span class="comment">// 3 相交</span></span><br><span class="line">    <span class="comment">// 2 内切</span></span><br><span class="line">    <span class="comment">// 1 内含</span></span><br><span class="line">    <span class="comment">//需要 Point 的 distance</span></span><br><span class="line">    <span class="comment">//测试：UVA12304</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">relationcircle</span><span class="params">(circle v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> d = p.distance(v.p);</span><br><span class="line">        <span class="keyword">if</span> (sgn(d - r - v.r) &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">if</span> (sgn(d - r - v.r) == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">double</span> l = <span class="built_in">fabs</span>(r - v.r);</span><br><span class="line">        <span class="keyword">if</span> (sgn(d - r - v.r) &lt; <span class="number">0</span> &amp;&amp; sgn(d - l) &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">if</span> (sgn(d - l) == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (sgn(d - l) &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//求两个圆的交点，返回 0 表示没有交点，返回 1 是一个交点，2 是两个交点</span></span><br><span class="line">    <span class="comment">//需要 relationcircle</span></span><br><span class="line">    <span class="comment">//测试：UVA12304</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">pointcrosscircle</span><span class="params">(circle v, Point &amp;p1, Point &amp;p2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rel = relationcircle(v);</span><br><span class="line">        <span class="keyword">if</span> (rel == <span class="number">1</span> || rel == <span class="number">5</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">double</span> d = p.distance(v.p);</span><br><span class="line">        <span class="keyword">double</span> l = (d * d + r * r - v.r * v.r) / (<span class="number">2</span> * d);</span><br><span class="line">        <span class="keyword">double</span> h = <span class="built_in">sqrt</span>(r * r - l * l);</span><br><span class="line">        Point tmp = p + (v.p - p).trunc(l);</span><br><span class="line">        p1 = tmp + ((v.p - p).rotleft().trunc(h));</span><br><span class="line">        p2 = tmp + ((v.p - p).rotright().trunc(h));</span><br><span class="line">        <span class="keyword">if</span> (rel == <span class="number">2</span> || rel == <span class="number">4</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//求直线和圆的交点，返回交点个数</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">pointcrossline</span><span class="params">(Line v, Point &amp;p1, Point &amp;p2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!(*<span class="keyword">this</span>).relationline(v)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        Point a = v.lineprog(p);</span><br><span class="line">        <span class="keyword">double</span> d = v.dispointtoline(p);</span><br><span class="line">        d = <span class="built_in">sqrt</span>(r * r - d * d);</span><br><span class="line">        <span class="keyword">if</span> (sgn(d) == <span class="number">0</span>) &#123;</span><br><span class="line">            p1 = a;</span><br><span class="line">            p2 = a;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        p1 = a + (v.e - v.s).trunc(d);</span><br><span class="line">        p2 = a - (v.e - v.s).trunc(d);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//得到过 a,b 两点，半径为 r1 的两个圆</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">gercircle</span><span class="params">(Point a, Point b, <span class="keyword">double</span> r1, circle &amp;c1, circle &amp;c2)</span> </span>&#123;</span><br><span class="line">        circle x(a, r1), y(b, r1);</span><br><span class="line">        <span class="keyword">int</span> t = x.pointcrosscircle(y, c1.p, c2.p);</span><br><span class="line">        <span class="keyword">if</span> (!t) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        c1.r = c2.r = r;</span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//得到与直线 u 相切，过点 q, 半径为 r1 的圆</span></span><br><span class="line">    <span class="comment">//测试：UVA12304</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getcircle</span><span class="params">(Line u, Point q, <span class="keyword">double</span> r1, circle &amp;c1, circle &amp;c2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> dis = u.dispointtoline(q);</span><br><span class="line">        <span class="keyword">if</span> (sgn(dis - r1 * <span class="number">2</span>) &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (sgn(dis) == <span class="number">0</span>) &#123;</span><br><span class="line">            c1.p = q + ((u.e - u.s).rotleft().trunc(r1));</span><br><span class="line">            c2.p = q + ((u.e - u.s).rotright().trunc(r1));</span><br><span class="line">            c1.r = c2.r = r1;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Line u1 = Line((u.s + (u.e - u.s).rotleft().trunc(r1)), (u.e + (u.e - u.s).rotleft().trunc(r1)));</span><br><span class="line">        Line u2 = Line((u.s + (u.e - u.s).rotright().trunc(r1)), (u.e + (u.e - u.s).rotright().trunc(r1)));</span><br><span class="line">        circle cc = circle(q, r1);</span><br><span class="line">        Point p1, p2;</span><br><span class="line">        <span class="keyword">if</span> (!cc.pointcrossline(u1, p1, p2)) cc.pointcrossline(u2, p1, p2);</span><br><span class="line">        c1 = circle(p1, r1);</span><br><span class="line">        <span class="keyword">if</span> (p1 == p2) &#123;</span><br><span class="line">            c2 = c1;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        c2 = circle(p2, r1);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//同时与直线 u,v 相切，半径为 r1 的圆</span></span><br><span class="line">    <span class="comment">//测试：UVA12304</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getcircle</span><span class="params">(Line u, Line v, <span class="keyword">double</span> r1, circle &amp;c1, circle &amp;c2, circle &amp;c3, circle &amp;c4)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (u.parallel(v)) <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">//两直线平行</span></span><br><span class="line">        Line u1 = Line(u.s + (u.e - u.s).rotleft().trunc(r1), u.e + (u.e - u.s).rotleft().trunc(r1));</span><br><span class="line">        Line u2 = Line(u.s + (u.e - u.s).rotright().trunc(r1), u.e + (u.e - u.s).rotright().trunc(r1));</span><br><span class="line">        Line v1 = Line(v.s + (v.e - v.s).rotleft().trunc(r1), v.e + (v.e - v.s).rotleft().trunc(r1));</span><br><span class="line">        Line v2 = Line(v.s + (v.e - v.s).rotright().trunc(r1), v.e + (v.e - v.s).rotright().trunc(r1));</span><br><span class="line">        c1.r = c2.r = c3.r = c4.r = r1;</span><br><span class="line">        c1.p = u1.crosspoint(v1);</span><br><span class="line">        c2.p = u1.crosspoint(v2);</span><br><span class="line">        c3.p = u2.crosspoint(v1);</span><br><span class="line">        c4.p = u2.crosspoint(v2);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//同时与不相交圆 cx,cy 相切，半径为 r1 的圆</span></span><br><span class="line">    <span class="comment">//测试：UVA12304</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getcircle</span><span class="params">(circle cx, circle cy, <span class="keyword">double</span> r1, circle &amp;c1, circle &amp;c2)</span> </span>&#123;</span><br><span class="line">        circle x(cx.p, r1 + cx.r), y(cy.p, r1 + cy.r);</span><br><span class="line">        <span class="keyword">int</span> t = x.pointcrosscircle(y, c1.p, c2.p);</span><br><span class="line">        <span class="keyword">if</span> (!t) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        c1.r = c2.r = r1;</span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">//过一点作圆的切线 (先判断点和圆的关系)</span></span><br><span class="line">    <span class="comment">//测试：UVA12304</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">tangentline</span><span class="params">(Point q, Line &amp;u, Line &amp;v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x = relation(q);</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="number">2</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="number">1</span>) &#123;</span><br><span class="line">            u = Line(q, q + (q - p).rotleft());</span><br><span class="line">            v = u;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">double</span> d = p.distance(q);</span><br><span class="line">        <span class="keyword">double</span> l = r * r / d;</span><br><span class="line">        <span class="keyword">double</span> h = <span class="built_in">sqrt</span>(r * r - l * l);</span><br><span class="line">        u = Line(q, p + ((q - p).trunc(l) + (q - p).rotleft().trunc(h)));</span><br><span class="line">        v = Line(q, p + ((q - p).trunc(l) + (q - p).rotright().trunc(h)));</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//求两圆相交的面积</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">areacircle</span><span class="params">(circle v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> rel = relationcircle(v);</span><br><span class="line">        <span class="keyword">if</span> (rel &gt;= <span class="number">4</span>) <span class="keyword">return</span> <span class="number">0.0</span>;</span><br><span class="line">        <span class="keyword">if</span> (rel &lt;= <span class="number">2</span>) <span class="keyword">return</span> min(area(), v.area());</span><br><span class="line">        <span class="keyword">double</span> d = p.distance(v.p);</span><br><span class="line">        <span class="keyword">double</span> hf = (r + v.r + d) / <span class="number">2.0</span>;</span><br><span class="line">        <span class="keyword">double</span> ss = <span class="number">2</span> * <span class="built_in">sqrt</span>(hf * (hf - r) * (hf - v.r) * (hf - d));</span><br><span class="line">        <span class="keyword">double</span> a1 = <span class="built_in">acos</span>((r * r + d * d - v.r * v.r) / (<span class="number">2.0</span> * r * d));</span><br><span class="line">        a1 = a1 * r * r;</span><br><span class="line">        <span class="keyword">double</span> a2 = <span class="built_in">acos</span>((v.r * v.r + d * d - r * r) / (<span class="number">2.0</span> * v.r * d));</span><br><span class="line">        a2 = a2 * v.r * v.r;</span><br><span class="line">        <span class="keyword">return</span> a1 + a2 - ss;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//求圆和三角形 pab 的相交面积</span></span><br><span class="line">    <span class="comment">//测试：POJ3675 HDU3982 HDU2892</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">areatriangle</span><span class="params">(Point a, Point b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (sgn((p - a) ^ (p - b)) == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0.0</span>;</span><br><span class="line">        Point q[<span class="number">5</span>];</span><br><span class="line">        <span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">        q[len++] = a;</span><br><span class="line">        <span class="function">Line <span class="title">l</span><span class="params">(a, b)</span></span>;</span><br><span class="line">        Point p1, p2;</span><br><span class="line">        <span class="keyword">if</span> (pointcrossline(l, q[<span class="number">1</span>], q[<span class="number">2</span>]) == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (sgn((a - q[<span class="number">1</span>]) * (b - q[<span class="number">1</span>])) &lt; <span class="number">0</span>) q[len++] = q[<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span> (sgn((a - q[<span class="number">2</span>]) * (b - q[<span class="number">2</span>])) &lt; <span class="number">0</span>) q[len++] = q[<span class="number">2</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        q[len++] = b;</span><br><span class="line">        <span class="keyword">if</span> (len == <span class="number">4</span> &amp;&amp; sgn((q[<span class="number">0</span>] - q[<span class="number">1</span>]) * (q[<span class="number">2</span>] - q[<span class="number">1</span>])) &gt; <span class="number">0</span>) swap(q[<span class="number">1</span>], q[<span class="number">2</span>]);</span><br><span class="line">        <span class="keyword">double</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (relation(q[i]) == <span class="number">0</span> || relation(q[i + <span class="number">1</span>]) == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">double</span> arg = p.rad(q[i], q[i + <span class="number">1</span>]);</span><br><span class="line">                res += r * r * arg / <span class="number">2.0</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                res += <span class="built_in">fabs</span>((q[i] - p) ^ (q[i + <span class="number">1</span>] - p)) / <span class="number">2.0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">  </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * n,p Line l for each side</span></span><br><span class="line"><span class="comment"> * input(int _n) - inputs _n size polygon</span></span><br><span class="line"><span class="comment"> * add(Point q) - adds a point at end of the list</span></span><br><span class="line"><span class="comment"> * getline() - populates line array</span></span><br><span class="line"><span class="comment"> * cmp - comparision in convex_hull order</span></span><br><span class="line"><span class="comment"> * norm() - sorting in convex_hull order</span></span><br><span class="line"><span class="comment"> * getconvex(polygon &amp;convex) - returns convex hull in convex</span></span><br><span class="line"><span class="comment"> * Graham(polygon &amp;convex) - returns convex hull in convex</span></span><br><span class="line"><span class="comment"> * isconvex() - checks if convex</span></span><br><span class="line"><span class="comment"> * relationpoint(Point q) - returns 3 if q is a vertex</span></span><br><span class="line"><span class="comment"> * 2 if on a side</span></span><br><span class="line"><span class="comment"> * 1 if inside</span></span><br><span class="line"><span class="comment"> * 0 if outside</span></span><br><span class="line"><span class="comment"> * convexcut(Line u,polygon &amp;po) - left side of u in po</span></span><br><span class="line"><span class="comment"> * gercircumference() - returns side length</span></span><br><span class="line"><span class="comment"> * getarea() - returns area</span></span><br><span class="line"><span class="comment"> * getdir() - returns 0 for cw, 1 for ccw</span></span><br><span class="line"><span class="comment"> * getbarycentre() - returns barycenter</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">  </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">polygon</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    Point p[maxp];</span><br><span class="line">    Line l[maxp];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">input</span><span class="params">(<span class="keyword">int</span> _n)</span> </span>&#123;</span><br><span class="line">        n = _n;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) p[i].input();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(Point q)</span> </span>&#123;</span><br><span class="line">        p[n++] = q;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getline</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            l[i] = Line(p[i], p[(i + <span class="number">1</span>) % n]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">cmp</span> &#123;</span></span><br><span class="line">        Point p;</span><br><span class="line">        cmp(<span class="keyword">const</span> Point &amp;p0) &#123;</span><br><span class="line">            p = p0;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">const</span> Point &amp;aa, <span class="keyword">const</span> Point &amp;bb)</span> </span>&#123;</span><br><span class="line">            Point a = aa, b = bb;</span><br><span class="line">            <span class="keyword">int</span> d = sgn((a - p) ^ (b - p));</span><br><span class="line">            <span class="keyword">if</span> (d == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> sgn(a.distance(p) - b.distance(p)) &lt; <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> d &gt; <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//进行极角排序</span></span><br><span class="line">    <span class="comment">//首先需要找到最左下角的点</span></span><br><span class="line">    <span class="comment">//需要重载号好 Point 的 &lt; 操作符 (min 函数要用)</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">norm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Point mi = p[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) mi = min(mi, p[i]);</span><br><span class="line">        sort(p, p + n, cmp(mi));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//得到凸包</span></span><br><span class="line">    <span class="comment">//得到的凸包里面的点编号是 0 ∼ n-1 的</span></span><br><span class="line">    <span class="comment">//两种凸包的方法</span></span><br><span class="line">    <span class="comment">//注意如果有影响，要特判下所有点共点，或者共线的特殊情况</span></span><br><span class="line">    <span class="comment">//测试 LightOJ1203 LightOJ1239</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getconvex</span><span class="params">(polygon &amp;convex)</span> </span>&#123;</span><br><span class="line">        sort(p, p + n);</span><br><span class="line">        convex.n = n;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; min(n, <span class="number">2</span>); i++) &#123;</span><br><span class="line">            convex.p[i] = p[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (convex.n == <span class="number">2</span> &amp;&amp; (convex.p[<span class="number">0</span>] == convex.p[<span class="number">1</span>])) convex.n--; <span class="comment">//特判</span></span><br><span class="line">        <span class="keyword">if</span> (n &lt;= <span class="number">2</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">int</span> &amp;top = convex.n;</span><br><span class="line">        top = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">while</span> (top &amp;&amp; sgn((convex.p[top] - p[i]) ^ (convex.p[top - <span class="number">1</span>] - p[i])) &lt;= <span class="number">0</span>) top--;</span><br><span class="line">            convex.p[++top] = p[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> temp = top;</span><br><span class="line">        convex.p[++top] = p[n - <span class="number">2</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">3</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="keyword">while</span> (top != temp &amp;&amp; sgn((convex.p[top] - p[i]) ^ (convex.p[top - <span class="number">1</span>] - p[i])) &lt;= <span class="number">0</span>) top--;</span><br><span class="line">            convex.p[++top] = p[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (convex.n == <span class="number">2</span> &amp;&amp; (convex.p[<span class="number">0</span>] == convex.p[<span class="number">1</span>])) convex.n--; <span class="comment">//特判</span></span><br><span class="line">        convex.norm(); <span class="comment">//原来得到的是顺时针的点，排序后逆时针</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//得到凸包的另外一种方法</span></span><br><span class="line">    <span class="comment">//测试 LightOJ1203 LightOJ1239</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Graham</span><span class="params">(polygon &amp;convex)</span> </span>&#123;</span><br><span class="line">        norm();</span><br><span class="line">        <span class="keyword">int</span> &amp;top = convex.n;</span><br><span class="line">        top = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">            top = <span class="number">1</span>;</span><br><span class="line">            convex.p[<span class="number">0</span>] = p[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">2</span>) &#123;</span><br><span class="line">            top = <span class="number">2</span>;</span><br><span class="line">            convex.p[<span class="number">0</span>] = p[<span class="number">0</span>];</span><br><span class="line">            convex.p[<span class="number">1</span>] = p[<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span> (convex.p[<span class="number">0</span>] == convex.p[<span class="number">1</span>]) top--;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        convex.p[<span class="number">0</span>] = p[<span class="number">0</span>];</span><br><span class="line">        convex.p[<span class="number">1</span>] = p[<span class="number">1</span>];</span><br><span class="line">        top = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">while</span> (top &gt; <span class="number">1</span> &amp;&amp; sgn((convex.p[top - <span class="number">1</span>] - convex.p[top - <span class="number">2</span>]) ^ (p[i] - convex.p[top - <span class="number">2</span>])) &lt;= <span class="number">0</span>) top--;</span><br><span class="line">            convex.p[top++] = p[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (convex.n == <span class="number">2</span> &amp;&amp; (convex.p[<span class="number">0</span>] == convex.p[<span class="number">1</span>])) convex.n--; <span class="comment">//特判</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//判断是不是凸的</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isconvex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">bool</span> s[<span class="number">2</span>];</span><br><span class="line">        <span class="built_in">memset</span>(s, <span class="literal">false</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> j = (i + <span class="number">1</span>) % n;</span><br><span class="line">            <span class="keyword">int</span> k = (j + <span class="number">1</span>) % n;</span><br><span class="line">            s[sgn((p[j] - p[i]) ^ (p[k] - p[i])) + <span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (s[<span class="number">0</span>] &amp;&amp; s[<span class="number">2</span>]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//判断点和任意多边形的关系</span></span><br><span class="line">    <span class="comment">// 3 点上</span></span><br><span class="line">    <span class="comment">// 2 边上</span></span><br><span class="line">    <span class="comment">// 1 内部</span></span><br><span class="line">    <span class="comment">// 0 外部</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">relationpoint</span><span class="params">(Point q)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (p[i] == q) <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        getline();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (l[i].pointonseg(q)) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> j = (i + <span class="number">1</span>) % n;</span><br><span class="line">            <span class="keyword">int</span> k = sgn((q - p[j]) ^ (p[i] - p[j]));</span><br><span class="line">            <span class="keyword">int</span> u = sgn(p[i].y - q.y);</span><br><span class="line">            <span class="keyword">int</span> v = sgn(p[j].y - q.y);</span><br><span class="line">            <span class="keyword">if</span> (k &gt; <span class="number">0</span> &amp;&amp; u &lt; <span class="number">0</span> &amp;&amp; v &gt;= <span class="number">0</span>) cnt++;</span><br><span class="line">            <span class="keyword">if</span> (k &lt; <span class="number">0</span> &amp;&amp; v &lt; <span class="number">0</span> &amp;&amp; u &gt;= <span class="number">0</span>) cnt--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cnt != <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//直线 u 切割凸多边形左侧</span></span><br><span class="line">    <span class="comment">//注意直线方向</span></span><br><span class="line">    <span class="comment">//测试：HDU3982</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">convexcut</span><span class="params">(Line u, polygon &amp;po)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> &amp;top = po.n; <span class="comment">//注意引用</span></span><br><span class="line">        top = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> d1 = sgn((u.e - u.s) ^ (p[i] - u.s));</span><br><span class="line">            <span class="keyword">int</span> d2 = sgn((u.e - u.s) ^ (p[(i + <span class="number">1</span>) % n] - u.s));</span><br><span class="line">            <span class="keyword">if</span> (d1 &gt;= <span class="number">0</span>) po.p[top++] = p[i];</span><br><span class="line">            <span class="keyword">if</span> (d1 * d2 &lt; <span class="number">0</span>) po.p[top++] = u.crosspoint(Line(p[i], p[(i + <span class="number">1</span>) % n]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//得到周长</span></span><br><span class="line">    <span class="comment">//测试 LightOJ1239</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getcircumference</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            sum += p[i].distance(p[(i + <span class="number">1</span>) % n]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//得到面积面积</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getarea</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            sum += (p[i] ^ p[(i + <span class="number">1</span>) % n]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">fabs</span>(sum) / <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//得到方向</span></span><br><span class="line">    <span class="comment">// 1 表示逆时针，0 表示顺时针</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">getdir</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) sum += (p[i] ^ p[(i + <span class="number">1</span>) % n]);</span><br><span class="line">        <span class="keyword">if</span> (sgn(sum) &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//得到重心</span></span><br><span class="line">    <span class="function">Point <span class="title">getbarycentre</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="function">Point <span class="title">ret</span><span class="params">(<span class="number">0</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">double</span> area = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">double</span> tmp = (p[i] - p[<span class="number">0</span>]) ^ (p[i + <span class="number">1</span>] - p[<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">if</span> (sgn(tmp) == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">            area += tmp;</span><br><span class="line">            ret.x += (p[<span class="number">0</span>].x + p[i].x + p[i + <span class="number">1</span>].x) / <span class="number">3</span> * tmp;</span><br><span class="line">            ret.y += (p[<span class="number">0</span>].y + p[i].y + p[i + <span class="number">1</span>].y) / <span class="number">3</span> * tmp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (sgn(area)) ret = ret / area;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//多边形和圆交的面积</span></span><br><span class="line">    <span class="comment">//测试：POJ3675 HDU3982 HDU2892</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">areacircle</span><span class="params">(circle c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> j = (i + <span class="number">1</span>) % n;</span><br><span class="line">            <span class="keyword">if</span> (sgn((p[j] - c.p) ^ (p[i] - c.p)) &gt;= <span class="number">0</span>)</span><br><span class="line">                ans += c.areatriangle(p[i], p[j]);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                ans -= c.areatriangle(p[i], p[j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">fabs</span>(ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//多边形和圆关系</span></span><br><span class="line">    <span class="comment">// 2 圆完全在多边形内</span></span><br><span class="line">    <span class="comment">// 1 圆在多边形里面，碰到了多边形边界</span></span><br><span class="line">    <span class="comment">// 0 其它</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">relationcircle</span><span class="params">(circle c)</span> </span>&#123;</span><br><span class="line">        getline();</span><br><span class="line">        <span class="keyword">int</span> x = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (relationpoint(c.p) != <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">//圆心不在内部</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (c.relationseg(l[i]) == <span class="number">2</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (c.relationseg(l[i]) == <span class="number">1</span>) x = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// AB X AC</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">cross</span><span class="params">(Point A, Point B, Point C)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (B - A) ^ (C - A);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// AB*AC</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">dot</span><span class="params">(Point A, Point B, Point C)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (B - A) * (C - A);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//最小矩形面积覆盖</span></span><br><span class="line"><span class="comment">// A 必须是凸包 (而且是逆时针顺序)</span></span><br><span class="line"><span class="comment">// 测试 UVA 10173</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">minRectangleCover</span><span class="params">(polygon A)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//要特判 A.n &lt; 3 的情况</span></span><br><span class="line">    <span class="keyword">if</span> (A.n &lt; <span class="number">3</span>) <span class="keyword">return</span> <span class="number">0.0</span>;</span><br><span class="line">    A.p[A.n] = A.p[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">double</span> ans = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">int</span> r = <span class="number">1</span>, p = <span class="number">1</span>, q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; A.n; i++) &#123;</span><br><span class="line">        <span class="comment">//卡出离边 A.p[i] - A.p[i+1] 最远的点</span></span><br><span class="line">        <span class="keyword">while</span> (sgn(cross(A.p[i], A.p[i + <span class="number">1</span>], A.p[r + <span class="number">1</span>]) - cross(A.p[i], A.p[i + <span class="number">1</span>], A.p[r])) &gt;= <span class="number">0</span>) r = (r + <span class="number">1</span>) % A.n;</span><br><span class="line">        <span class="comment">//卡出 A.p[i] - A.p[i+1] 方向上正向 n 最远的点</span></span><br><span class="line">        <span class="keyword">while</span> (sgn(dot(A.p[i], A.p[i + <span class="number">1</span>], A.p[p + <span class="number">1</span>]) - dot(A.p[i], A.p[i + <span class="number">1</span>], A.p[p])) &gt;= <span class="number">0</span>) p = (p + <span class="number">1</span>) % A.n;</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">0</span>) q = p;</span><br><span class="line">        <span class="comment">//卡出 A.p[i] - A.p[i+1] 方向上负向最远的点</span></span><br><span class="line">        <span class="keyword">while</span> (sgn(dot(A.p[i], A.p[i + <span class="number">1</span>], A.p[q + <span class="number">1</span>]) - dot(A.p[i], A.p[i + <span class="number">1</span>], A.p[q])) &lt;= <span class="number">0</span>) q = (q + <span class="number">1</span>) % A.n;</span><br><span class="line">        <span class="keyword">double</span> d = (A.p[i] - A.p[i + <span class="number">1</span>]).len2();</span><br><span class="line">        <span class="keyword">double</span> tmp = cross(A.p[i], A.p[i + <span class="number">1</span>], A.p[r]) * (dot(A.p[i], A.p[i + <span class="number">1</span>], A.p[p]) - dot(A.p[i], A.p[i + <span class="number">1</span>], A.p[q])) / d;</span><br><span class="line">        <span class="keyword">if</span> (ans &lt; <span class="number">0</span> || ans &gt; tmp) ans = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="comment">//直线切凸多边形</span></span><br><span class="line"><span class="comment">//多边形是逆时针的，在 q1q2 的左侧</span></span><br><span class="line"><span class="comment">//测试:HDU3982</span></span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;Point&gt; <span class="title">convexCut</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;Point&gt; &amp;ps, Point q1, Point q2)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;Point&gt; qs;</span><br><span class="line">    <span class="keyword">int</span> n = ps.size();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        Point p1 = ps[i], p2 = ps[(i + <span class="number">1</span>) % n];</span><br><span class="line">        <span class="keyword">int</span> d1 = sgn((q2 - q1) ^ (p1 - q1)), d2 = sgn((q2 - q1) ^ (p2 - q1));</span><br><span class="line">        <span class="keyword">if</span> (d1 &gt;= <span class="number">0</span>) qs.push_back(p1);</span><br><span class="line">        <span class="keyword">if</span> (d1 * d2 &lt; <span class="number">0</span>) qs.push_back(Line(p1, p2).crosspoint(Line(q1, q2)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> qs;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">double</span> l = <span class="number">0.00001</span>, r = <span class="number">3000</span>;</span><br><span class="line"><span class="keyword">double</span> cx, cy;</span><br><span class="line">polygon P, P2;</span><br><span class="line"><span class="keyword">double</span> p, q;</span><br><span class="line"><span class="keyword">double</span> area;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">slove</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lf%lf&quot;</span>, &amp;cx, &amp;cy);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lf%lf&quot;</span>, &amp;p, &amp;q);</span><br><span class="line">    <span class="keyword">double</span> a = area * (q - p) / q;</span><br><span class="line">    <span class="comment">// cout &lt;&lt; &quot;a==&quot; &lt;&lt; a &lt;&lt; endl;</span></span><br><span class="line">  </span><br><span class="line">    l = <span class="number">0.00001</span>, r = <span class="number">3000</span>;</span><br><span class="line">    <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">        <span class="keyword">double</span> mid = (l + r) / <span class="number">2.0</span>;</span><br><span class="line">        <span class="function">circle <span class="title">c</span><span class="params">(cx, cy, mid)</span></span>;</span><br><span class="line">        <span class="keyword">double</span> res = P.areacircle(c);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">fabs</span>(res - a) &lt; eps) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%.8f\n&quot;</span>, mid);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (res &lt; a) &#123;</span><br><span class="line">            l = mid;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            r = mid;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e8</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">32767</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    P.input(n);</span><br><span class="line">    area = P.getarea();</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</span><br><span class="line">    <span class="comment">// cout &lt;&lt; &quot;area==&quot; &lt;&lt; area &lt;&lt; endl;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i) &#123;</span><br><span class="line">        slove();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2018-09-03T12:00:44.000Z" title="2018-09-03T12:00:44.000Z">2018-09-03</time>发表</span><span class="level-item"><time dateTime="2018-09-03T12:18:47.629Z" title="2018-09-03T12:18:47.629Z">2018-09-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%A8%A1%E6%9D%BF/">模板</a></span><span class="level-item">3 分钟读完 (大约465个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/%E6%A8%A1%E6%9D%BF/2018/09/03/%E5%9B%9E%E6%96%87%E6%A0%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html">回文树学习笔记</a></h1><div class="content"><h1 id="回文树学习笔记"><a href="#回文树学习笔记" class="headerlink" title="回文树学习笔记"></a>回文树学习笔记</h1><h2 id="神奇的数据结构-Palindromic-Tree-回文树"><a href="#神奇的数据结构-Palindromic-Tree-回文树" class="headerlink" title="神奇的数据结构 Palindromic Tree 回文树"></a>神奇的数据结构 Palindromic Tree 回文树</h2><h3 id="功能简介"><a href="#功能简介" class="headerlink" title="功能简介"></a>功能简介</h3><ol>
<li>求一个串$S$中$[0,i]$中本质不同回文串的个数</li>
<li>求串$S$中每一个本质不同回文串出现的次数</li>
<li>求指定下标$i$结尾的回文串的个数</li>
</ol>
<h3 id="变量简介"><a href="#变量简介" class="headerlink" title="变量简介"></a>变量简介</h3><ol>
<li>$len[i]$表示编号为$i$节点所表示的回文串的$len$。</li>
<li>$next[i][c]$表示编号为$i$的节点表示的回文串在两边添加字符$c$之后会变成的回文串的编号。</li>
<li>$fail[i]$表示节点$i$失配以后跳转后不等于自己的节点$i$所表示的回稳产的最长长度。</li>
<li>$cnt[i]$表示节点$i$表示的本质不同的串的个数。</li>
<li>$num[i]$表示以节点$i$表示的最长回文串的最右端点为回文串结尾的回文串个数。</li>
<li>$last$指向新添加一个字母后所形成的最长回文串表示的节点。</li>
<li>$S[i]$表示第$i$次添加的字符(初始化S[0]=不存在的字符)。</li>
<li>$p$表示添加的节点个数。</li>
<li>$n$表示添加的字符个数。</li>
</ol>
<h3 id="模板-抄的"><a href="#模板-抄的" class="headerlink" title="模板(抄的)"></a>模板(抄的)</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">26</span>; <span class="comment">// attention 用模板的时候要改变</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Ptree</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> next[maxn][N];</span><br><span class="line">    <span class="keyword">int</span> fail[maxn];</span><br><span class="line">    <span class="keyword">int</span> cnt[maxn];</span><br><span class="line">    <span class="keyword">int</span> num[maxn];</span><br><span class="line">    <span class="keyword">int</span> len[maxn];</span><br><span class="line">    <span class="keyword">int</span> S[maxn];</span><br><span class="line">    <span class="keyword">int</span> last,n,p;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">newNode</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        rep(i,<span class="number">0</span>,N) next[p][i] = <span class="number">0</span>;</span><br><span class="line">        cnt[p] = <span class="number">0</span>;num[p] = <span class="number">0</span>;len[p] = x;</span><br><span class="line">        <span class="keyword">return</span> p++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        p = <span class="number">0</span>;</span><br><span class="line">        newNode(<span class="number">0</span>);newNode(<span class="number">-1</span>);</span><br><span class="line">        last = <span class="number">0</span>; n = <span class="number">0</span>;S[n] = <span class="number">-1</span>;fail[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get_fail</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(S[n-len[x]<span class="number">-1</span>] != S[n]) x = fail[x];</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">        c -= <span class="string">&#x27;a&#x27;</span>; <span class="comment">// attention 用模板的时候要改变</span></span><br><span class="line">        S[++n] = c;</span><br><span class="line">        <span class="keyword">int</span> cur = get_fail(last);</span><br><span class="line">        <span class="keyword">if</span>(!next[cur][c])&#123;</span><br><span class="line">            <span class="keyword">int</span> now = newNode(len[cur]+<span class="number">2</span>);</span><br><span class="line">            fail[now] = next[get_fail(fail[cur])][c];</span><br><span class="line">            next[cur][c] = now;</span><br><span class="line">            num[now] = num[fail[now]] + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        last = next[cur][c];</span><br><span class="line">        cnt[last]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">count</span><span class="params">()</span></span>&#123;</span><br><span class="line">        per(i,<span class="number">0</span>,p) cnt[fail[i]] += cnt[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

















<blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u013368721/article/details/42100363">https://blog.csdn.net/u013368721/article/details/42100363</a></p>
</blockquote>
</div></article></div></div><!--!--><div class="column column-right is-4-tablet is-3-desktop is-3-widescreen  order-3"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/1.gif" alt="Chea Sim"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Chea Sim</p><p class="is-size-6 is-block">Student from Z</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Ning Bo</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">99</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">26</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">83</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/CheaSim" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/CheaSim"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/www.cheasim.com"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/1600/"><span class="level-start"><span class="level-item">1600</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/acm/"><span class="level-start"><span class="level-item">acm</span></span><span class="level-end"><span class="level-item tag">37</span></span></a></li><li><a class="level is-mobile" href="/categories/acm%E6%A8%A1%E6%9D%BF/"><span class="level-start"><span class="level-item">acm模板</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/ac%E8%87%AA%E5%8A%A8%E6%9C%BA/"><span class="level-start"><span class="level-item">ac自动机</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/cf/"><span class="level-start"><span class="level-item">cf</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/cf1500/"><span class="level-start"><span class="level-item">cf1500</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/dfs/"><span class="level-start"><span class="level-item">dfs</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/dp/"><span class="level-start"><span class="level-item">dp</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/hash/"><span class="level-start"><span class="level-item">hash</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/html/"><span class="level-start"><span class="level-item">html</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/pat/"><span class="level-start"><span class="level-item">pat</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E4%B8%93%E9%A1%B9%E7%BB%83%E4%B9%A0/"><span class="level-start"><span class="level-item">专项练习</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E4%BF%9D%E7%A0%94/"><span class="level-start"><span class="level-item">保研</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%89%8D%E7%AB%AF/"><span class="level-start"><span class="level-item">前端</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span class="level-start"><span class="level-item">学习笔记</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/"><span class="level-start"><span class="level-item">学习计划</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%BC%80%E5%8F%91/"><span class="level-start"><span class="level-item">开发</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%90%AC%E7%A0%96/"><span class="level-start"><span class="level-item">搬砖</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%A6%82%E7%8E%87dp/"><span class="level-start"><span class="level-item">概率dp</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%A8%A1%E6%9D%BF/"><span class="level-start"><span class="level-item">模板</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%BA%BF%E6%AE%B5%E6%A0%91/"><span class="level-start"><span class="level-item">线段树</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%80%83%E7%A0%94/"><span class="level-start"><span class="level-item">考研</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%80%83%E7%A0%94%E8%B7%AF%E6%BC%AB%E6%BC%AB/"><span class="level-start"><span class="level-item">考研路漫漫</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%93%9D%E6%A1%A5%E6%9D%AF/"><span class="level-start"><span class="level-item">蓝桥杯</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AE%BA%E8%A7%A3/"><span class="level-start"><span class="level-item">论解</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-01-20T07:26:03.000Z">2021-01-20</time></p><p class="title"><a href="/uncategorized/2021/01/20/UNIFIEDQA-Crossing-Format-Boundaries-with-a-Single-QA-System-%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0.html">UNIFIEDQA Crossing Format Boundaries with a Single QA System 读书笔记</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-01-14T06:15:14.000Z">2021-01-14</time></p><p class="title"><a href="/uncategorized/2021/01/14/%E5%9F%BA%E4%BA%8EBERT%E7%9A%84%E7%9F%A5%E8%AF%86%E5%BA%93%E9%97%AE%E7%AD%94%E7%B3%BB%E7%BB%9F.html">基于BERT的知识库问答系统</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-01-12T13:55:19.000Z">2021-01-12</time></p><p class="title"><a href="/uncategorized/2021/01/12/NLP%E5%9F%BA%E7%A1%80.html">NLP基础</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-01-07T09:40:38.000Z">2021-01-07</time></p><p class="title"><a href="/uncategorized/2021/01/07/%E5%A6%82%E4%BD%95%E5%9C%A8colab%E7%94%A8pytorch-lightning%E7%99%BD%E5%AB%96TPU.html">如何在colab用pytorch_lightning白嫖TPU</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-12-11T09:07:57.000Z">2020-12-11</time></p><p class="title"><a href="/uncategorized/2020/12/11/HuggingFace-PretrainTokenizer%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html">HuggingFace PretrainTokenizer学习笔记</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">一月 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/12/"><span class="level-start"><span class="level-item">十二月 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">十一月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/12/"><span class="level-start"><span class="level-item">十二月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/09/"><span class="level-start"><span class="level-item">九月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/08/"><span class="level-start"><span class="level-item">八月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/07/"><span class="level-start"><span class="level-item">七月 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/05/"><span class="level-start"><span class="level-item">五月 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/04/"><span class="level-start"><span class="level-item">四月 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/03/"><span class="level-start"><span class="level-item">三月 2019</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/11/"><span class="level-start"><span class="level-item">十一月 2018</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/10/"><span class="level-start"><span class="level-item">十月 2018</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/09/"><span class="level-start"><span class="level-item">九月 2018</span></span><span class="level-end"><span class="level-item tag">22</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/08/"><span class="level-start"><span class="level-item">八月 2018</span></span><span class="level-end"><span class="level-item tag">22</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/AI/"><span class="tag">AI</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LCA/"><span class="tag">LCA</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/QA/"><span class="tag">QA</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/acm/"><span class="tag">acm</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ac%E8%87%AA%E5%8A%A8%E6%9C%BA/"><span class="tag">ac自动机</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ajax/"><span class="tag">ajax</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bert/"><span class="tag">bert</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/bilstm/"><span class="tag">bilstm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cf/"><span class="tag">cf</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/colab/"><span class="tag">colab</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/crf/"><span class="tag">crf</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css/"><span class="tag">css</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dfs/"><span class="tag">dfs</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dgl/"><span class="tag">dgl</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dp/"><span class="tag">dp</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dptree/"><span class="tag">dptree</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/echarts/"><span class="tag">echarts</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gnn/"><span class="tag">gnn</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/graph/"><span class="tag">graph</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/greedy/"><span class="tag">greedy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hash/"><span class="tag">hash</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hdoj/"><span class="tag">hdoj</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/html/"><span class="tag">html</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/js/"><span class="tag">js</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jsp/"><span class="tag">jsp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/lca/"><span class="tag">lca</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linux/"><span class="tag">linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/math/"><span class="tag">math</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/matrix/"><span class="tag">matrix</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nlp/"><span class="tag">nlp</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pat/"><span class="tag">pat</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pytorch/"><span class="tag">pytorch</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/re/"><span class="tag">re</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/struts2/"><span class="tag">struts2</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tokenizer/"><span class="tag">tokenizer</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web/"><span class="tag">web</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%B8%93%E9%A2%98/"><span class="tag">专题</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%8C%E5%88%86/"><span class="tag">二分</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%BA%E7%94%9F/"><span class="tag">人生</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BF%9D%E7%A0%94/"><span class="tag">保研</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%85%AB%E6%95%B0%E7%A0%81/"><span class="tag">八数码</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9B%BE%E8%AE%BA/"><span class="tag">图论</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/"><span class="tag">字符串</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2hash/"><span class="tag">字符串hash</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span class="tag">学习笔记</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/"><span class="tag">学习计划</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B0%8F%E6%8A%80%E5%B7%A7/"><span class="tag">小技巧</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BC%80%E5%8F%91/"><span class="tag">开发</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%8A%BD%E5%8F%96/"><span class="tag">抽取</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E5%AD%A6/"><span class="tag">数学</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"><span class="tag">数据结构</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%80%E5%A4%A7%E5%AD%90%E6%AE%B5%E5%92%8C/"><span class="tag">最大子段和</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9E%84%E9%80%A0/"><span class="tag">构造</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A0%91%E5%BD%A2dp/"><span class="tag">树形dp</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/"><span class="tag">树状数组</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%EF%BC%8Chdoj/"><span class="tag">树状数组，hdoj</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86/"><span class="tag">树链剖分</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A6%82%E7%8E%87dp/"><span class="tag">概率dp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A8%A1%E6%8B%9F/"><span class="tag">模拟</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A8%A1%E6%9D%BF/"><span class="tag">模板</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%88%86%E6%90%9C/"><span class="tag">爆搜</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%89%9B%E5%AE%A2%E7%BD%91/"><span class="tag">牛客网</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%8A%B6%E5%8E%8Bdp/"><span class="tag">状压dp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"><span class="tag">线段树</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/"><span class="tag">组合数学</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BB%86%E8%8A%82/"><span class="tag">细节</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BC%A9%E7%82%B9/"><span class="tag">缩点</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BD%91%E7%BB%9C/"><span class="tag">网络</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BD%91%E7%BB%9C%E8%B5%9B/"><span class="tag">网络赛</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%80%83%E7%A0%94/"><span class="tag">考研</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%8C%83%E5%9B%B4/"><span class="tag">范围</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%93%9D%E6%A1%A5%E6%9D%AF/"><span class="tag">蓝桥杯</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%A1%A5%E9%A2%98/"><span class="tag">补题</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%A7%84%E5%BE%8B/"><span class="tag">规律</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%A1%E5%88%92/"><span class="tag">计划</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95/"><span class="tag">计算几何</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%BA%E8%A7%A3/"><span class="tag">论解</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%B4%AA%E5%BF%83/"><span class="tag">贪心</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%80%92%E5%BD%92/"><span class="tag">递归</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%85%8D%E7%BD%AE/"><span class="tag">配置</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%9A%8F%E6%80%A7/"><span class="tag">随性</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%A2%84%E5%A4%84%E7%90%86/"><span class="tag">预处理</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/1.gif" alt="CheaSim Blog" height="28"></a><p class="is-size-7"><span>&copy; 2021 CheaSim</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>